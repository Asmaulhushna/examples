<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta http-equiv="Content-Language" content="en">
<title>1 Intro Python Notebooks (2) - Databricks</title>
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Source+Code+Pro:400,700">
<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
<link rel='stylesheet' type='text/css' href='https://databricks-prod-cloudfront.cloud.databricks.com/static/201511031715010800-b38c68475dfc920d015b8b9c64a2676d63f65035/notebook.css'></style>
<style media='print'>
#context-bar,div.top-menu-buttons,div.globalComments,div.commentsPane,.tb-title-icons,#topbar,#user-menu{position:relative !important}#help-menu{position:relative !important}#topbar{display:block !important;height:auto !important}.tb-button{display:none !important}.tb-title-wrapper{text-align:left !important;margin:0;left:0;white-space:initial;position:relative}.tb-title-lang{display:none !important}#overallView{left:0 !important}#content{position:relative !important;display:block !important;top:0 !important;left:0 !important}.command-provenance{visibility:visible !important;opacity:1 !important}#context-bar,div.top-menu-buttons,div.globalComments,div.commentsPane,.tb-title-icons,#tooltip,#filebrowser-popup,#searchpanel-popup,#user-menu{display:none !important}.submit-hint,a[class*="-button"],i[class*="icon-"],select{display:none !important}.results .plot-controls{display:none !important}a[class="cancel-query-button"]{display:block !important}.tb-status,.tb-status img{display:none !important}.command-result .spinner .spinner-wrapper{display:none !important}html,body,.shellSessionView{overflow:hidden !important}textarea:empty{display:none !important}div.primaryPrompt{display:none !important}div.divider{display:none !important}.command{border:none !important}*::-webkit-input-placeholder{color:tranparent}*:-moz-placeholder{color:tranparent}*::-moz-placeholder{color:tranparent}*:-ms-input-placeholder{color:tranparent}.expandingText{min-height:initial !important}.commentFrame .comment-list li{margin:0}.commentFrame .header{display:none !important}.commentFrame .new-comment{border-bottom:none !important}div.divider:hover{display:none !important}div.divider:hover .btn-circle{display:none !important}.command:hover,.command:active{border:none !important;box-shadow:none !important}@page{margin:2cm}body{max-width:100% !important}.ui-resizable{max-height:100%;max-width:100%}.figure-results-and-comments .widget[style*="width: auto; height: auto"]{width:100% !important;min-height:300px}.widget.widget-input{min-height:initial !important}@-moz-document url-prefix(){.ui-resizable{width:auto !important;height:auto !important;max-width:100%}}img,.figure,.ui-resizeable{page-break-inside:avoid}.previousPrompt{page-break-inside:avoid}.command .command-input .command-box{page-break-before:avoid}.results-and-comments{page-break-before:avoid}.results-and-comments.figure-results-and-comments{page-break-before:auto;page-break-inside:avoid}.command .ui-resizeable{page-break-inside:avoid}.table-bordered{border:1px solid #ddd}.results .table thead,.table thead{background:#fafafa}.command-result-wrapper .results{overflow:hidden}.results-table .inner{overflow:hidden}#content{overflow-y:visible}.commentFrame{overflow:visible;margin-bottom:25px}.commentFrame .new-comment{border-bottom:none}.commentFrame .main,.commentFrame .comment-list{overflow-y:visible;max-height:initial;height:auto}.sessionPane .shell-top>div:last-child .results{padding-bottom:50px;overflow:visible}
/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInByaW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSx5R0FBeUcsNEJBQTRCLENBQUMsV0FBVyw0QkFBNEIsQ0FBQyxRQUFRLHlCQUF5QixzQkFBc0IsQ0FBQyxXQUFXLHVCQUF1QixDQUFDLGtCQUFrQiwyQkFBMkIsU0FBUyxPQUFPLG9CQUFvQixpQkFBaUIsQ0FBQyxlQUFlLHVCQUF1QixDQUFDLGFBQWEsaUJBQWlCLENBQUMsU0FBUyw2QkFBNkIseUJBQXlCLGlCQUFpQixpQkFBaUIsQ0FBQyxvQkFBb0IsOEJBQThCLG9CQUFvQixDQUFDLGdKQUFnSix1QkFBdUIsQ0FBQywwREFBMEQsdUJBQXVCLENBQUMsd0JBQXdCLHVCQUF1QixDQUFDLCtCQUErQix3QkFBd0IsQ0FBQywwQkFBMEIsdUJBQXVCLENBQUMsMENBQTBDLHVCQUF1QixDQUFDLDRCQUE0QiwwQkFBMEIsQ0FBQyxlQUFlLHVCQUF1QixDQUFDLGtCQUFrQix1QkFBdUIsQ0FBQyxZQUFZLHVCQUF1QixDQUFDLFNBQVMsc0JBQXNCLENBQUMsNkJBQTZCLGdCQUFnQixDQUFDLG1CQUFtQixnQkFBZ0IsQ0FBQyxvQkFBb0IsZ0JBQWdCLENBQUMsd0JBQXdCLGdCQUFnQixDQUFDLGVBQWUsNkJBQTZCLENBQUMsK0JBQStCLFFBQVEsQ0FBQyxzQkFBc0IsdUJBQXVCLENBQUMsMkJBQTJCLDZCQUE2QixDQUFDLGtCQUFrQix1QkFBdUIsQ0FBQyw4QkFBOEIsdUJBQXVCLENBQUMsK0JBQStCLHVCQUF1QiwwQkFBMEIsQ0FBQyxNQUFNLFVBQVUsQ0FBQyxLQUFLLHlCQUF5QixDQUFDLGNBQWMsZ0JBQWdCLGNBQWMsQ0FBQyx5RUFBeUUsc0JBQXNCLGdCQUFnQixDQUFDLHFCQUFxQiw2QkFBNkIsQ0FBQyw0QkFBNEIsY0FBYyxzQkFBc0IsdUJBQXVCLGNBQWMsQ0FBQyxDQUFDLDJCQUEyQix1QkFBdUIsQ0FBQyxnQkFBZ0IsdUJBQXVCLENBQUMscUNBQXFDLHVCQUF1QixDQUFDLHNCQUFzQix1QkFBdUIsQ0FBQyxrREFBa0QsdUJBQXVCLHVCQUF1QixDQUFDLHdCQUF3Qix1QkFBdUIsQ0FBQyxnQkFBZ0IscUJBQXFCLENBQUMsbUNBQW1DLGtCQUFrQixDQUFDLGlDQUFpQyxlQUFlLENBQUMsc0JBQXNCLGVBQWUsQ0FBQyxTQUFTLGtCQUFrQixDQUFDLGNBQWMsaUJBQWlCLGtCQUFrQixDQUFDLDJCQUEyQixrQkFBa0IsQ0FBQyxnREFBZ0QsbUJBQW1CLG1CQUFtQixXQUFXLENBQUMsZ0RBQWdELG9CQUFvQixnQkFBZ0IsQ0FBQyIsImZpbGUiOiJwcmludC5jc3MiLCJzb3VyY2VzQ29udGVudCI6WyIjY29udGV4dC1iYXIsZGl2LnRvcC1tZW51LWJ1dHRvbnMsZGl2Lmdsb2JhbENvbW1lbnRzLGRpdi5jb21tZW50c1BhbmUsLnRiLXRpdGxlLWljb25zLCN0b3BiYXIsI3VzZXItbWVudXtwb3NpdGlvbjpyZWxhdGl2ZSAhaW1wb3J0YW50fSNoZWxwLW1lbnV7cG9zaXRpb246cmVsYXRpdmUgIWltcG9ydGFudH0jdG9wYmFye2Rpc3BsYXk6YmxvY2sgIWltcG9ydGFudDtoZWlnaHQ6YXV0byAhaW1wb3J0YW50fS50Yi1idXR0b257ZGlzcGxheTpub25lICFpbXBvcnRhbnR9LnRiLXRpdGxlLXdyYXBwZXJ7dGV4dC1hbGlnbjpsZWZ0ICFpbXBvcnRhbnQ7bWFyZ2luOjA7bGVmdDowO3doaXRlLXNwYWNlOmluaXRpYWw7cG9zaXRpb246cmVsYXRpdmV9LnRiLXRpdGxlLWxhbmd7ZGlzcGxheTpub25lICFpbXBvcnRhbnR9I292ZXJhbGxWaWV3e2xlZnQ6MCAhaW1wb3J0YW50fSNjb250ZW50e3Bvc2l0aW9uOnJlbGF0aXZlICFpbXBvcnRhbnQ7ZGlzcGxheTpibG9jayAhaW1wb3J0YW50O3RvcDowICFpbXBvcnRhbnQ7bGVmdDowICFpbXBvcnRhbnR9LmNvbW1hbmQtcHJvdmVuYW5jZXt2aXNpYmlsaXR5OnZpc2libGUgIWltcG9ydGFudDtvcGFjaXR5OjEgIWltcG9ydGFudH0jY29udGV4dC1iYXIsZGl2LnRvcC1tZW51LWJ1dHRvbnMsZGl2Lmdsb2JhbENvbW1lbnRzLGRpdi5jb21tZW50c1BhbmUsLnRiLXRpdGxlLWljb25zLCN0b29sdGlwLCNmaWxlYnJvd3Nlci1wb3B1cCwjc2VhcmNocGFuZWwtcG9wdXAsI3VzZXItbWVudXtkaXNwbGF5Om5vbmUgIWltcG9ydGFudH0uc3VibWl0LWhpbnQsYVtjbGFzcyo9XCItYnV0dG9uXCJdLGlbY2xhc3MqPVwiaWNvbi1cIl0sc2VsZWN0e2Rpc3BsYXk6bm9uZSAhaW1wb3J0YW50fS5yZXN1bHRzIC5wbG90LWNvbnRyb2xze2Rpc3BsYXk6bm9uZSAhaW1wb3J0YW50fWFbY2xhc3M9XCJjYW5jZWwtcXVlcnktYnV0dG9uXCJde2Rpc3BsYXk6YmxvY2sgIWltcG9ydGFudH0udGItc3RhdHVzLC50Yi1zdGF0dXMgaW1ne2Rpc3BsYXk6bm9uZSAhaW1wb3J0YW50fS5jb21tYW5kLXJlc3VsdCAuc3Bpbm5lciAuc3Bpbm5lci13cmFwcGVye2Rpc3BsYXk6bm9uZSAhaW1wb3J0YW50fWh0bWwsYm9keSwuc2hlbGxTZXNzaW9uVmlld3tvdmVyZmxvdzpoaWRkZW4gIWltcG9ydGFudH10ZXh0YXJlYTplbXB0eXtkaXNwbGF5Om5vbmUgIWltcG9ydGFudH1kaXYucHJpbWFyeVByb21wdHtkaXNwbGF5Om5vbmUgIWltcG9ydGFudH1kaXYuZGl2aWRlcntkaXNwbGF5Om5vbmUgIWltcG9ydGFudH0uY29tbWFuZHtib3JkZXI6bm9uZSAhaW1wb3J0YW50fSo6Oi13ZWJraXQtaW5wdXQtcGxhY2Vob2xkZXJ7Y29sb3I6dHJhbnBhcmVudH0qOi1tb3otcGxhY2Vob2xkZXJ7Y29sb3I6dHJhbnBhcmVudH0qOjotbW96LXBsYWNlaG9sZGVye2NvbG9yOnRyYW5wYXJlbnR9KjotbXMtaW5wdXQtcGxhY2Vob2xkZXJ7Y29sb3I6dHJhbnBhcmVudH0uZXhwYW5kaW5nVGV4dHttaW4taGVpZ2h0OmluaXRpYWwgIWltcG9ydGFudH0uY29tbWVudEZyYW1lIC5jb21tZW50LWxpc3QgbGl7bWFyZ2luOjB9LmNvbW1lbnRGcmFtZSAuaGVhZGVye2Rpc3BsYXk6bm9uZSAhaW1wb3J0YW50fS5jb21tZW50RnJhbWUgLm5ldy1jb21tZW50e2JvcmRlci1ib3R0b206bm9uZSAhaW1wb3J0YW50fWRpdi5kaXZpZGVyOmhvdmVye2Rpc3BsYXk6bm9uZSAhaW1wb3J0YW50fWRpdi5kaXZpZGVyOmhvdmVyIC5idG4tY2lyY2xle2Rpc3BsYXk6bm9uZSAhaW1wb3J0YW50fS5jb21tYW5kOmhvdmVyLC5jb21tYW5kOmFjdGl2ZXtib3JkZXI6bm9uZSAhaW1wb3J0YW50O2JveC1zaGFkb3c6bm9uZSAhaW1wb3J0YW50fUBwYWdle21hcmdpbjoyY219Ym9keXttYXgtd2lkdGg6MTAwJSAhaW1wb3J0YW50fS51aS1yZXNpemFibGV7bWF4LWhlaWdodDoxMDAlO21heC13aWR0aDoxMDAlfS5maWd1cmUtcmVzdWx0cy1hbmQtY29tbWVudHMgLndpZGdldFtzdHlsZSo9XCJ3aWR0aDogYXV0bzsgaGVpZ2h0OiBhdXRvXCJde3dpZHRoOjEwMCUgIWltcG9ydGFudDttaW4taGVpZ2h0OjMwMHB4fS53aWRnZXQud2lkZ2V0LWlucHV0e21pbi1oZWlnaHQ6aW5pdGlhbCAhaW1wb3J0YW50fUAtbW96LWRvY3VtZW50IHVybC1wcmVmaXgoKXsudWktcmVzaXphYmxle3dpZHRoOmF1dG8gIWltcG9ydGFudDtoZWlnaHQ6YXV0byAhaW1wb3J0YW50O21heC13aWR0aDoxMDAlfX1pbWcsLmZpZ3VyZSwudWktcmVzaXplYWJsZXtwYWdlLWJyZWFrLWluc2lkZTphdm9pZH0ucHJldmlvdXNQcm9tcHR7cGFnZS1icmVhay1pbnNpZGU6YXZvaWR9LmNvbW1hbmQgLmNvbW1hbmQtaW5wdXQgLmNvbW1hbmQtYm94e3BhZ2UtYnJlYWstYmVmb3JlOmF2b2lkfS5yZXN1bHRzLWFuZC1jb21tZW50c3twYWdlLWJyZWFrLWJlZm9yZTphdm9pZH0ucmVzdWx0cy1hbmQtY29tbWVudHMuZmlndXJlLXJlc3VsdHMtYW5kLWNvbW1lbnRze3BhZ2UtYnJlYWstYmVmb3JlOmF1dG87cGFnZS1icmVhay1pbnNpZGU6YXZvaWR9LmNvbW1hbmQgLnVpLXJlc2l6ZWFibGV7cGFnZS1icmVhay1pbnNpZGU6YXZvaWR9LnRhYmxlLWJvcmRlcmVke2JvcmRlcjoxcHggc29saWQgI2RkZH0ucmVzdWx0cyAudGFibGUgdGhlYWQsLnRhYmxlIHRoZWFke2JhY2tncm91bmQ6I2ZhZmFmYX0uY29tbWFuZC1yZXN1bHQtd3JhcHBlciAucmVzdWx0c3tvdmVyZmxvdzpoaWRkZW59LnJlc3VsdHMtdGFibGUgLmlubmVye292ZXJmbG93OmhpZGRlbn0jY29udGVudHtvdmVyZmxvdy15OnZpc2libGV9LmNvbW1lbnRGcmFtZXtvdmVyZmxvdzp2aXNpYmxlO21hcmdpbi1ib3R0b206MjVweH0uY29tbWVudEZyYW1lIC5uZXctY29tbWVudHtib3JkZXItYm90dG9tOm5vbmV9LmNvbW1lbnRGcmFtZSAubWFpbiwuY29tbWVudEZyYW1lIC5jb21tZW50LWxpc3R7b3ZlcmZsb3cteTp2aXNpYmxlO21heC1oZWlnaHQ6aW5pdGlhbDtoZWlnaHQ6YXV0b30uc2Vzc2lvblBhbmUgLnNoZWxsLXRvcD5kaXY6bGFzdC1jaGlsZCAucmVzdWx0c3twYWRkaW5nLWJvdHRvbTo1MHB4O292ZXJmbG93OnZpc2libGV9Il19 */

</style>
<link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAJPUlEQVR4XuVbW2wcZxU+/9x3vXfHu+vEsQmxQ1QqFEDUcQhqKm4SSBSpLyU1L0RCqAiEgEpNQtPcaOgDUAkBAoIEVdsUiZeKSoiHKlWokpgiWokWROwkxG5sr73369x/dMaexXbWuzM7YyeG82R5/ss533/2P9/5dpbA/7mRuxX/zUPvk2Kq/CQDJs0LwWd3vf5v+W74sukAYOAJXf6FGJYeEwMsi0ErDcOQK/LzBU56fLOB2DQA6CHgylr6J2KMOyKKIt/qtBVF0ZSi+ssIv/At8jrom5ERGw4ABWBKH08/K0a5b0iSKDoJSpYVRSlqz0UvZ44RANPJnG7HbCgAhbH0KTEsPBEI8YFuHGxUtYZWkc9Fryyc6Wa+kzkbAkBxLPldISo9HQjyISdOdBrTqGtVpaQ8Fb+Sea7TWLfPfQUgvz/5tWCUOyf2BGJuHXEyXqk1inLJeCJ2NXPeyXgnY3wBID+aHA9ExB9LYWGbk029jpErSrZRlb+ZuJK94HUtTwAUxpJfFHu4nwcigbRXR7qZ3yg35uWq+tXE1ewfupmPc7oCIDea/LQg8edDvdJgtxv7Oa+ak6eNuv6V2JuZ19yu6wqA3FjygBTgng9GA7u7g86tey7GU4B6qTYl1+iXeycyV53OdARA4WN9+4Qg/2IgId1HiKMpTvf3fRylFOp5+V2tro3H31x8u9MGbaNZfGDbHiHI/i4c69lHmHs78LWBUpNCrSD/TW6oX+r7S/baekC0jKpwoH+I48jLwbi0n2G3VuBrAzUNCvVi47KuweH45blba5+vii4zmkwFBPZlKSE9yLNb7Mg75LpmmFQuKBcbin44NbGQsYc3ASgfTL8qJgKfE7j/rcDX4qLqJlXyjVcjb8x/YVUZvLUrSBODUQj1BjvdG1v6eTVbh/xMCYZu1q3Db2bAZJqn+A+xR4DeoRgEY9KWDnSt8/VCA3LTJVBqqvVoZF5rDYA9MRARoXcwBlLEUQd7z4LVKCuQmy6CXFZW+dgRAHt0MB6A3sGolRlbyfCkc7eKUC+2VtocA2AHHdoWhMTOKAiBlmLOPYON2tAgP12Caq7e1ifXAFgXBgEI9/VAYmcMONGS8+4Z0xUD8jNFqCzWgFq3WXvrCoBm7SQEoukQxAciwPJ3FwhDM6DwXhlK81VAGuzUPAFgb4IsMdofhviOCDAs43RvX8aZhgmF22UozVUA2Z5b8wWAJhAcY4EQ6w/DRvcMGCwGXZgtg6l3r5e2AgALpKcbjhNYC4hIOgR+d42Y3pjmmO6Y9h5NG5nXrLLWJEI3+qUh3TBOmQyMswCePticyEHvzqh1YXrWDShAebFmsTdd8fZVgQFgMCa8wHLcid2zjelVANiITqaF+wDM0wDkEY8ogxDkrdLZLb3GUoYlDUubZzPp7ynLnNgzp/5z5Vrr9rqT2/mPUJM8Q4B+1uvmbuk1khckMTZt9bI/BfInwtCjI7PaW63W6djsT6a5QyYh32coHPDiCM616PVQDKRwa3qNdBVpK9JXr0YB3gBCj++Z0y+1W6sjAPbka2n284TSs0DYfV6d64kHADtPm15btHW6BNiweDZqvE0IOTY8b/zRyVqOAcDFcqPJRziG+W05W+2RK95PCek1GraoXg2btkhvqGqadDw+kXnF6XqOAMiNJj8jSPyvVsrga9tLpxv6Pc66XwajgE2bbW5k8rYA5Ef7Doo9/G/ayeB4ermZImgNbyXKLTDYlFkVZjmL7phvyeSN63LNGG8nk7cWRcf6PiwI/AuOZXCrVlchP1P2XKs7AYEcAwOPOOQYSKAaefkfal17rJVMvgqA7Ed79/Jh7kK3Mvh/2VoJDK17mtoKBGy6sPnCJqwblokyeaVYf0ut64+ulMmbAJQ+kf5zKBE86IcMjny9OFeG4mzFE19HIBjsM7ZHrKbLL98qheql2KWFB3H9JgA3ByVqpVYy5J2+Lh8hNivYsRXnKoAn4MasTjMdtk7dt06TApQWqlCYKcGuabm1JshLnKUFrnu5uIlieSw2L3g/lDOde3ZMb2ymEj5rDZVszaLVmrx0WXdsh7G8YEb0JLp6u6UlTJqiW+iXF2p3PidgXWy4J150flktj2pwEdT66n6iIwC2A0hbkb4ijfXL1up22CwhM/RTb2yUZItdrkfYHANgB43fE+BHQwz5pw4rVdW6b/xUnOWqCnlUg0vt37t0DYANBH4kMCP8PC0/MgtTHFMdU96JdQ2AvfiSOhwFvDTvpuGlhmIJqsFuzDMAVg3FGzu1BMRmq8NLlaUE5QzK4O5KrKMq4AZNFEJREI3tiADLbaw6bOgmFLvkFitjapUBWCc85TOyttj2MMT6kbw4ajQd42yxy9lldml4ptl3iqJTfeIwZcyTBoHDrEcuyPIMxAeiEE2FPMvkyCAtNfi29/7CAKAshReJyZwaXlSmVlFh+yimUsL9BmOeZSh52PHxrDPQ6twGIt3Ra+wwF7DDLIGuepbBwST0FYYyx0fm1XdXuru+KJri95sEnmEAHvIKhFt6bWkM08UmbfWyPwV4DSgc35PRJlqt0/GDej3FfRJFUQAY9eIIzrXo9WAUUBNsZVjD8cT9UIMBYIIAPTo8r19s53dHAHAyBSDXtwsPG6Z+lgH2g16BWEuvrZcYbhXXpa3u9jP+DpR7aiSjOtIFHQFgO4A/fpjqFw4DNU4CMLvdOXbnaPs1nPVeYnC3vnkdCPv08Jx6wc2PLFwBYDv0VwA+0s8fYSg5QYH2u3PU79F0lhJy5vacdv4hcP8zm64AsEOYGYCAonNfpwZ5Eljo9Tu0tusZkCMsPSdy+s92vgfOGoAWC3oCwF5vMgEREIRvA9DvAIAvvxJpE3wFgPzI0NUf7s1CxSvovgBgO/Gv7bCNMfmjhgGPsyz4+p6dYYDMsvBTk9F+8IFZyHoN3J7vKwBNIAYCO4imnjAJc8TrV+0AoBMKv9YN/vTebH3Wr8A3FAB7caTXwJmndQqPuqXXy7T1JWIyJ23a6nfwuN6GZMBaR28khQ/pjHmGALHez+1kSFtZk/necEZ9p9NYr883BYDmZZni91MC5wjAoVaOmwAXGQrHRjKa4198bCkAbGevpbhPkSV6/cDy/yYYSo/vzuiuf/OzJQFAp5Fe30gJ9+Pf78+o7xDrX5tv/wEbguduWrUR0wAAAABJRU5ErkJggg==">
<meta http-equiv="content-type" content="text/html; charset=UTF8">


<script>window.settings = {"sparkDocsSearchGoogleCx":"","dbcForumURL":"http://forums.databricks.com/","dbfsS3Host":"https://databricks-prod-storage-california.s3.amazonaws.com","enableThirdPartyApplicationsUI":false,"notebookRevisionVisibilityHorizon":6,"enableTableHandler":true,"isAdmin":true,"enablePresentationTimerConfig":true,"enableFullTextSearch":true,"enableElasticSparkUI":true,"clusters":true,"hideOffHeapCache":false,"applications":false,"fileStoreBase":"FileStore","configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"}],"enableReactNotebookComments":true,"enableResetPassword":true,"sparkVersions":[{"key":"1.3.x","displayName":"Spark 1.3","packageLabel":"spark-1.3-jenkins-ip-10-2-0-138-Ub38c68475d-Sb38c68475d-2015-11-04-01:34:17.300434","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.4.x","displayName":"Spark 1.4","packageLabel":"spark-1.4-jenkins-ip-10-2-0-138-Ub38c68475d-Sb38c68475d-2015-11-04-01:34:17.300434","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.5.x","displayName":"Spark 1.5","packageLabel":"spark-1.5-jenkins-ip-10-2-0-138-Ub38c68475d-Sb38c68475d-2015-11-04-01:34:17.300434","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"master","displayName":"Spark master (dev)","packageLabel":"","upgradable":true,"deprecated":false,"customerVisible":false}],"enableRestrictedClusterCreation":false,"enableFeedback":false,"serverContinuationTimeoutMillis":10000,"driverStderrFilePrefix":"stderr","driverStdoutFilePrefix":"stdout","enableSparkDocsSearch":false,"sparkHistoryServerEnabled":true,"enableIPythonImportExport":true,"enableNotebookHistoryDiffing":true,"branch":"2.6.1","local":false,"displayDefaultContainerMemoryGB":30,"useSpotForWorkers":false,"enableStaticNotebooks":true,"dbcGuideURL":"#workspace/databricks_guide/00 Welcome to Databricks","enableR":true,"orgId":0,"enableNotebookGitVersioning":true,"files":"files/","enableDriverLogsUI":true,"disableLegacyDashboards":false,"enableWorkspaceAclsConfig":false,"dropzoneMaxFileSize":4096,"enableNewDashboardViews":false,"driverLog4jFilePrefix":"log4j","enableMavenLibraries":true,"gitTimestamp":"2015-11-03 17:15:01 -0800","defaultSparkVersion":{"key":"1.5.x","displayName":"Spark 1.5","packageLabel":"spark-1.5-jenkins-ip-10-2-0-138-Ub38c68475d-Sb38c68475d-2015-11-04-01:34:17.300434","upgradable":true,"deprecated":false,"customerVisible":true},"staticNotebookCdnUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/","clusterPublisherRootId":5,"enableLatestJobRunResultPermalink":true,"enableSparkConfUI":true,"enableJdbcImport":true,"logfiles":"logfiles/","enableClusterDeltaUpdates":true,"csrfToken":"decc5c53-a2b2-48f4-b4b5-d81f682f3b7c","useFixedStaticNotebookVersionForDevelopment":false,"enableBasicReactDialogBoxes":true,"requireEmailUserName":true,"enableDashboardViews":false,"dbcFeedbackURL":"http://feedback.databricks.com/forums/263785-product-feedback","enableWorkspaceAclService":true,"enableWorkspaceAcls":false,"gitHash":"b38c68475dfc920d015b8b9c64a2676d63f65035","userFullname":"Jules Damji","enableMiniClusters":false,"enableWebSocketDeltaUpdates":true,"enableDebugUI":false,"showHiddenSparkVersions":false,"allowNonAdminUsers":false,"userId":100004,"dbcSupportURL":"","enableSparkPackages":true,"enableNotebookHistoryUI":true,"enableSparkVersionsUI":true,"notebookLoadingBackground":"#fff","enableNewJobRunDetailsPage":true,"enableDashboardExport":true,"user":"dmatrix@comcast.net","enableServerAutoComplete":true,"defaultMemoryPerContainerMB":28000,"enablePresenceUI":true,"tablesPublisherRootId":7,"accounts":true,"enableNewProgressReportUI":true,"defaultCoresPerContainer":4,"zoneInfos":[{"id":"us-west-1a","isDefault":true},{"id":"us-west-1b","isDefault":false}],"defaultZoneId":"us-west-1a"};</script>

<script>var notebookModelJson = {"clusterMemory":270,"name":"1 Intro Python Notebooks (2)","path":"/1/3593/3596","guid":"54955e56-6d9b-47e0-89f1-622ba5e973ca","jsRunAllAction":"NoAction","iPythonMetadata":null,"runStatus":"idle","clusterId":"1105-203410-lyre2","id":3596,"driver":5805418656722170000,"language":"python","deltaVersion":1446753907876,"targetClusterId":"1105-203410-lyre2","deltaEvent":"update","type":"shell","clusterReady":true,"clusterName":"JSD_DB","doNotFireCallback":true,"parentId":3593,"globalVars":{},"notebookFetchError":null,"permissionLevel":"Can Manage","presenceMarks":[]};</script>

<script>var notebookModelCommandCollection = [{"type":"command","id":3598,"parentId":3596,"deltaVersion":1446753907167,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"b9cfb99d-87d0-484d-afc6-250b4c156b26","subtype":"command","commandType":"auto","position":0.25,"command":"%md\n![Databricks Logo](http://training.databricks.com/databricks_guide/databricks_logo_400px.png)\n# **Introduction to Python Notebooks** \n\n* This introduction notebook describes how to get started running Python code in Notebooks.\n* If you have not already done so, please review the [Welcome to Databricks](/#workspace/databricks_guide/00 Welcome to Databricks) guide.\n","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1434022243971,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"denny@databricks.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"17e71c90-cd6d-4bde-b9a7-45c128b9a430","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3598","arguments":{},"parent":null,"localVersion":96,"presenceMarks":[],"comments":null,"deltaEvent":"update","clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3599,"parentId":3596,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"dcf081cc-7ff7-43a5-8a60-79a66c7d85c8","subtype":"script","commandType":"auto","position":0.25000011805555555,"command":"# **A Python Notebook**\n* ##  This notebook contains some examples and tips for Python Notebooks.","commandVersion":0,"results":{"type":"markdown","data":"# **A Python Notebook**\n* ##  This notebook contains some examples and tips for Python Notebooks.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1414515839167,"submitTime":1411771484113,"finishTime":1414515839299,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["afac5046-dc68-41aa-a580-a3f7796dbed7"],"latestUser":null,"lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"fbf3f060-59a0-4134-9d9f-5d1a56ba0940","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3599","parent":null,"localVersion":90,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3600,"parentId":3596,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"ff6f71c7-3248-4e0e-b552-8bcbef3360e7","subtype":"script","commandType":"auto","position":0.2500002541666666,"command":"## Python notebooks can contain Python, Markdown, and SQL cells.","commandVersion":0,"results":{"type":"markdown","data":"## Python notebooks can contain Python, Markdown, and SQL cells.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1414515839301,"submitTime":1411771484113,"finishTime":1414515839306,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["afac5046-dc68-41aa-a580-a3f7796dbed7"],"latestUser":null,"lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"f3702a17-c916-4022-b152-b135f84ebe36","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3600","parent":null,"localVersion":90,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3601,"parentId":3596,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"6394b349-2adb-48c8-8d21-7cc9d50056a8","subtype":"script","commandType":"auto","position":0.25000039027777776,"command":"## **Create your own Python Notebook to follow along with this notebook.**\n### See the \"Quick Start\" notebook if you have not done this before.","commandVersion":0,"results":{"type":"markdown","data":"## **Create your own Python Notebook to follow along with this notebook.**\n### See the \"Quick Start\" notebook if you have not done this before.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1414515839307,"submitTime":1413923067166,"finishTime":1414515839312,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["afac5046-dc68-41aa-a580-a3f7796dbed7"],"latestUser":null,"lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"91d281ab-df00-4864-9e79-7380e2d5bad5","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3601","parent":null,"localVersion":90,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3602,"parentId":3596,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"806d4a9d-634f-44c8-93bc-fe36bbf8b44f","subtype":"script","commandType":"auto","position":0.25000052638888887,"command":"## **Interactive Python Shell in the Browser**\n### A Python cell allows you to execute arbitrary Python commands just like in any Python shell.","commandVersion":0,"results":{"type":"markdown","data":"## **Interactive Python Shell in the Browser**\n### A Python cell allows you to execute arbitrary Python commands just like in any Python shell.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1414515839313,"submitTime":1412116410635,"finishTime":1414515839318,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["afac5046-dc68-41aa-a580-a3f7796dbed7"],"latestUser":null,"lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"4c59fa97-c935-49f1-b766-a006e02f0a37","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3602","parent":null,"localVersion":90,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3603,"parentId":3596,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"486ad7a6-a455-4716-825f-e6e688febd4f","subtype":"script","commandType":"auto","position":0.25000066249999997,"command":"print \"The sum of 1 and 1 is %s\" % (1+1) ","commandVersion":0,"results":{"type":"html","data":"<div class=\"ansiout\">The sum of 1 and 1 is 2\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1414515839319,"submitTime":1412122783156,"finishTime":1414515839396,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"html","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["afac5046-dc68-41aa-a580-a3f7796dbed7"],"latestUser":null,"lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"6ed5d3fc-78a7-4e95-b78d-48410594f620","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3603","parent":null,"localVersion":90,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3604,"parentId":3596,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"7f164e69-38a9-4cf9-9508-86d684abf8dc","subtype":"script","commandType":"auto","position":0.25000079861111113,"command":"## Standard Python libraries can be imported:\n* ### For other libraries that are not available by default, you can upload other libraries to the Workspace.\n* ### Search for the **Libraries** Notebook for more details.","commandVersion":0,"results":{"type":"markdown","data":"## Standard Python libraries can be imported:\n* ### For other libraries that are not available by default, you can upload other libraries to the Workspace.\n* ### Search for the **Libraries** Notebook for more details.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1414515839398,"submitTime":1411771484113,"finishTime":1414515839402,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["afac5046-dc68-41aa-a580-a3f7796dbed7"],"latestUser":null,"lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"73697f20-597f-47a5-b39e-3c1f5a07ee4d","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3604","parent":null,"localVersion":90,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3605,"parentId":3596,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"57e02610-0133-4e78-a13f-30ca59638061","subtype":"script","commandType":"auto","position":0.2500009347222222,"command":"import re\nm = re.search('(?<=abc)def', 'abcdef')\nm.group(0)","commandVersion":0,"results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">2</span><span class=\"ansired\">]: </span>&apos;def&apos;\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1414515839406,"submitTime":1412122787866,"finishTime":1414515839418,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"html","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["afac5046-dc68-41aa-a580-a3f7796dbed7"],"latestUser":null,"lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"78dd046e-bd38-4a00-97d6-6a1894e7b851","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3605","parent":null,"localVersion":90,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3606,"parentId":3596,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"62a1cd09-605e-475f-8e03-be4fa2900696","subtype":"script","commandType":"auto","position":0.25000107083333334,"command":"# Exercise: In your notebook, create a new cell to run some Python commands.","commandVersion":0,"results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1414515839419,"submitTime":1413923429828,"finishTime":1414515839434,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["afac5046-dc68-41aa-a580-a3f7796dbed7"],"latestUser":null,"lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"07e9241b-f7cc-4a52-b405-163dc30541ad","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3606","parent":null,"localVersion":90,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3607,"parentId":3596,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"07d0a54e-c1f2-4e31-9840-181075b6cfbb","subtype":"script","commandType":"auto","position":0.2500012069444444,"command":"## **Running Spark**\n### The variable **sc** allows you to access a Spark Context to run your Spark programs.","commandVersion":0,"results":{"type":"markdown","data":"## **Running Spark**\n### The variable **sc** allows you to access a Spark Context to run your Spark programs.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1414515839437,"submitTime":1411771484113,"finishTime":1414515839441,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["afac5046-dc68-41aa-a580-a3f7796dbed7"],"latestUser":null,"lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"ed588f6a-f3e6-4144-b154-0b6471175129","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3607","parent":null,"localVersion":90,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3608,"parentId":3596,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"66b03ea3-f86e-4913-9c61-f0c67dbb9ed5","subtype":"script","commandType":"auto","position":0.25000134305555555,"command":"# wordcount(wordcount) < 100\nwords = sc.parallelize([\"hello\", \"world\", \"goodbye\", \"hello\", \"again\"])\nwordcounts = words.map(lambda s: (s, 1)).reduceByKey(lambda a, b : a + b).collect()\nwordcounts","commandVersion":0,"results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">4</span><span class=\"ansired\">]: </span>[(&apos;hello&apos;, 2), (&apos;goodbye&apos;, 1), (&apos;world&apos;, 1), (&apos;again&apos;, 1)]\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1414515839442,"submitTime":1412122791931,"finishTime":1414515840268,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"html","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["afac5046-dc68-41aa-a580-a3f7796dbed7"],"latestUser":null,"lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"b703eb2e-aaa5-4dbb-bc99-8eac32439a5c","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3608","parent":null,"localVersion":90,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3609,"parentId":3596,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"8550621a-45cd-460d-882a-edb7f1c756b9","subtype":"script","commandType":"auto","position":0.25000147916666665,"command":"# Exercise: In your notebook, calculate the number of unique words in the \"words\" rdd here.\n# (Hint: The answer should be 4.)","commandVersion":0,"results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1414515840269,"submitTime":1413918611121,"finishTime":1414515840285,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["afac5046-dc68-41aa-a580-a3f7796dbed7"],"latestUser":null,"lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"3736d301-bddc-4cbd-bbf5-7d6a2a2a93b6","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3609","parent":null,"localVersion":90,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3610,"parentId":3596,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"d01f0ff4-0393-46e4-930b-ca562bc05c75","subtype":"script","commandType":"auto","position":0.25000161527777776,"command":"# Exercise: In your notebook, create an rdd of numbers, and use Spark to find the mean.\n# (Hint: Use reduce to sum all the numbers and divide by the count)","commandVersion":0,"results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1414515840287,"submitTime":1413918618408,"finishTime":1414515840302,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["afac5046-dc68-41aa-a580-a3f7796dbed7"],"latestUser":null,"lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"f626ad95-bed9-4e65-a801-db6d79584bd7","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3610","parent":null,"localVersion":90,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3611,"parentId":3596,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"611615be-2659-4c7d-9644-a787f30684cc","subtype":"script","commandType":"auto","position":0.2500017513888889,"command":"## **SQL within Python Notebooks**\n### Use SQL queries in Python notebooks to combine the flexibility of Python for data transformation with the ease of writing SQL for querying.","commandVersion":0,"results":{"type":"markdown","data":"## **SQL within Python Notebooks**\n### Use SQL queries in Python notebooks to combine the flexibility of Python for data transformation with the ease of writing SQL for querying.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1414515840304,"submitTime":1411771484113,"finishTime":1414515840308,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["afac5046-dc68-41aa-a580-a3f7796dbed7"],"latestUser":null,"lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"ffc41f42-815d-4e92-b915-0f412ca4c94f","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3611","parent":null,"localVersion":90,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3612,"parentId":3596,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"e2450c21-5ee7-4c08-bcac-0d1858fc7b1d","subtype":"script","commandType":"auto","position":0.25000188749999996,"command":"## SQL cells can be created in a Python notebook which can contain SQL statements.\n* ### Tip: To start or change a cell to sql type **%sql** at the start of a cell.","commandVersion":0,"results":{"type":"markdown","data":"## SQL cells can be created in a Python notebook which can contain SQL statements.\n* ### Tip: To start or change a cell to sql type **%sql** at the start of a cell.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1414515840309,"submitTime":1411771484113,"finishTime":1414515840313,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["afac5046-dc68-41aa-a580-a3f7796dbed7"],"latestUser":null,"lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"395587f9-a012-4990-b265-e3fcf37801f9","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3612","parent":null,"localVersion":90,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3613,"parentId":3596,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"94bd70c8-1617-43c7-8a96-57762a94fe78","subtype":"script","commandType":"auto","position":0.2500020236111111,"command":"show tables","commandVersion":0,"results":{"type":"table","data":[["basketball_table"],["clustering_errors"],["customer"],["customer_address"],["customer_demographics"],["customersbystate"],["dashboard_test_table"],["date_dim"],["ddd"],["diamonds"],["diamondstsv"],["errcounts"],["execution_times"],["flight_data"],["florin_events_cust"],["florin_florin_go_alg_id"],["florin_ss_cust"],["henry_users"],["histograms"],["houlysalesdemotable"],["hourlysalesdemotable"],["household_demographics"],["item"],["justerrors2"],["matei_wiki_8"],["millionsongs1"],["movie_ratings"],["movie_ratings_by_user"],["plot_diamonds"],["productsalesdemotable"],["promotion"],["pulls_with_categories"],["pythontesttable"],["running_stats_cached"],["sales"],["scalastats"],["scalatesttable"],["songs"],["sqlapacheaccesslogstable"],["sqltesttable"],["store"],["store_sales"],["stress_tests_023"],["stress_tests_024"],["stress_tests_030"],["stress_tests_100"],["stresstest1"],["stresstest2"],["tableautimestamptest"],["temp_messages_ssd"],["testingimport"],["time_dim"],["tinysongs"],["tinysongs1"],["totalcounts"],["tweetstimestampsscala"],["tweeturls"],["usererrcounts"],["usernameruntimes"],["wikipedia"]],"arguments":{},"schema":[{"type":"string","name":"result"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":null,"plotOptions":null},"errorSummary":null,"error":null,"startTime":1414515840314,"submitTime":1412122991695,"finishTime":1414515841474,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["afac5046-dc68-41aa-a580-a3f7796dbed7"],"latestUser":null,"lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"fc7c9000-8bab-423a-b0d5-4d40bb8bfa77","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3613","parent":null,"localVersion":90,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3614,"parentId":3596,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"80347902-427f-45e9-b029-9494c073f032","subtype":"script","commandType":"auto","position":0.2500021597222222,"command":"## SQL statements can also be executed within Python cells.\n* ### The **sqlContext** variable allows you to access a Spark SQL context within a Python cell.\n* ### Call **sqlContext.sql(*SQL_STATEMENT*)** to run a sql statement.","commandVersion":0,"results":{"type":"markdown","data":"## SQL statements can also be executed within Python cells.\n* ### The **sqlContext** variable allows you to access a Spark SQL context within a Python cell.\n* ### Call **sqlContext.sql(*SQL_STATEMENT*)** to run a sql statement.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1414515841476,"submitTime":1411771484113,"finishTime":1414515841480,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["afac5046-dc68-41aa-a580-a3f7796dbed7"],"latestUser":null,"lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"2cee25c6-b912-4c0c-ae73-19d983dbe2b7","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3614","parent":null,"localVersion":90,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3615,"parentId":3596,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"e4692c30-771e-477a-b2fc-2caba8bb8dc8","subtype":"script","commandType":"auto","position":0.25000229583333333,"command":"sqlContext.sql(\"show tables\").take(5)","commandVersion":0,"results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">7</span><span class=\"ansired\">]: </span>\n[Row(result=u&apos;basketball_table&apos;),\n Row(result=u&apos;clustering_errors&apos;),\n Row(result=u&apos;customer&apos;),\n Row(result=u&apos;customer_address&apos;),\n Row(result=u&apos;customer_demographics&apos;)]\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1414515841482,"submitTime":1412122996756,"finishTime":1414515842693,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["afac5046-dc68-41aa-a580-a3f7796dbed7"],"latestUser":null,"lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"f541a271-d9dd-4b38-91f1-76cd60cb3485","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3615","parent":null,"localVersion":90,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3616,"parentId":3596,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"64f8a1ba-5067-4048-ba6f-8d437ac0480a","subtype":"script","commandType":"auto","position":0.25000243194444444,"command":"## Spark SQL uses a special type of RDD called **SchemaRDD's**.\n### Python can be used to create a SchemaRDD.","commandVersion":0,"results":{"type":"markdown","data":"## Spark SQL uses a special type of RDD called **SchemaRDD's**.\n### Python can be used to create a SchemaRDD.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1414515842695,"submitTime":1411771484113,"finishTime":1414515842699,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["afac5046-dc68-41aa-a580-a3f7796dbed7"],"latestUser":null,"lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"ca9ff16c-63a7-4ffc-86c0-92ecfd1dfdbd","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3616","parent":null,"localVersion":90,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3617,"parentId":3596,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"cd58f5eb-2e7d-489a-ab2b-c86589fc3567","subtype":"script","commandType":"auto","position":0.25000256805555554,"command":"from pyspark.sql import Row\n\narray = [Row(key=\"a\", group=\"vowels\", value=1),\n         Row(key=\"b\", group=\"consonants\", value=2),\n         Row(key=\"c\", group=\"consonants\", value=3),\n         Row(key=\"d\", group=\"consonants\", value=4),\n         Row(key=\"e\", group=\"vowels\", value=5)]\nschemaRdd = sqlContext.inferSchema(sc.parallelize(array))","commandVersion":0,"results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1414515842701,"submitTime":1412123001177,"finishTime":1414515843379,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["afac5046-dc68-41aa-a580-a3f7796dbed7"],"latestUser":null,"lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"acee35d6-3313-45b1-910e-fb37be7f86b2","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3617","parent":null,"localVersion":90,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3618,"parentId":3596,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"618adfd8-3063-43b4-8d99-17e3a1323a6d","subtype":"script","commandType":"auto","position":0.2500027041666667,"command":"## Use the **display** command to view a schemaRDD in a notebook.","commandVersion":0,"results":{"type":"markdown","data":"## Use the **display** command to view a schemaRDD in a notebook.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1414515843381,"submitTime":1411771484113,"finishTime":1414515843385,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["afac5046-dc68-41aa-a580-a3f7796dbed7"],"latestUser":null,"lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"18cd55ad-e2dd-4c4d-b745-2ee3d0ef9974","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3618","parent":null,"localVersion":90,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3619,"parentId":3596,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"f99e1171-bd19-4c80-a4c9-8d0e00340106","subtype":"script","commandType":"auto","position":0.25000284027777775,"command":"display(schemaRdd)","commandVersion":0,"results":{"type":"table","data":[["vowels","a",1],["consonants","b",2],["consonants","c",3],["consonants","d",4],["vowels","e",5]],"arguments":{},"schema":[{"type":"string","name":"group"},{"type":"string","name":"key"},{"type":"int","name":"value"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":null,"plotOptions":null},"errorSummary":null,"error":null,"startTime":1414515843387,"submitTime":1412123004100,"finishTime":1414515843610,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"auto","height":"auto","xColumns":["key"],"yColumns":["value"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["afac5046-dc68-41aa-a580-a3f7796dbed7"],"latestUser":null,"lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"aaa5cfbb-d976-4e26-851f-33af9f8a2d76","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3619","parent":null,"localVersion":90,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3620,"parentId":3596,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"ff2ac5a5-f816-40c6-a9e4-f6137b9290b8","subtype":"script","commandType":"auto","position":0.2500029763888889,"command":"## The visualization above is interactive.\n* ### Click on the Chart or a Graph icon to toggle the view.\n* ### Try different types of graphs by clicking on the arrow next to a graph icon.\n* ### If you have selected a graph, you can click on \"Plot Options...\" for even more ways to customize the view.","commandVersion":0,"results":{"type":"markdown","data":"## The visualization above is interactive.\n* ### Click on the Chart or a Graph icon to toggle the view.\n* ### Try different types of graphs by clicking on the arrow next to a graph icon.\n* ### If you have selected a graph, you can click on \"Plot Options...\" for even more ways to customize the view.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1414515843612,"submitTime":1412114085222,"finishTime":1414515843616,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["afac5046-dc68-41aa-a580-a3f7796dbed7"],"latestUser":null,"lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"b0126652-c11b-4f64-87a1-823e405c8477","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3620","parent":null,"localVersion":90,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3621,"parentId":3596,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"f9a4739c-d908-4738-ac89-d42192bd3657","subtype":"script","commandType":"auto","position":0.25000311249999996,"command":"# Exercise: Copy the code above in your own notebook to create a schemaRDD and display it. \n# Can you use the \"Plot Options\" to plot the group vs. the sum of the values in that group?\n# (Hint: Vowels = 6, and consonants = 9)","commandVersion":0,"results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1414515843618,"submitTime":1413919012339,"finishTime":1414515843642,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["afac5046-dc68-41aa-a580-a3f7796dbed7"],"latestUser":null,"lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"437230d6-c5d5-4b53-81b0-edc2254542c3","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3621","parent":null,"localVersion":90,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3622,"parentId":3596,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"2d11e0a6-cb12-4622-bdc0-7d9718326fe9","subtype":"script","commandType":"auto","position":0.2500032486111111,"command":"## Call **registerTempTable** on a SchemaRDD to register this table for SQL queries.","commandVersion":0,"results":{"type":"markdown","data":"## Call **registerTempTable** on a SchemaRDD to register this table for SQL queries.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1414515843643,"submitTime":1411771484113,"finishTime":1414515843647,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["afac5046-dc68-41aa-a580-a3f7796dbed7"],"latestUser":null,"lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"9997cf36-5dac-4bb8-ad79-cfd213066a04","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3622","parent":null,"localVersion":90,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3623,"parentId":3596,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"03c684d6-0370-414e-b074-0063b045bbdf","subtype":"script","commandType":"auto","position":0.25000338472222217,"command":"schemaRdd.registerTempTable(\"PythonTempTable\")","commandVersion":0,"results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1414515843649,"submitTime":1412123074216,"finishTime":1414515843672,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["afac5046-dc68-41aa-a580-a3f7796dbed7"],"latestUser":null,"lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"2c7d9b9d-1210-4234-812c-e4f34d87cc55","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3623","parent":null,"localVersion":90,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3624,"parentId":3596,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"e690df7b-5e78-4b66-93fe-1ba53d064764","subtype":"script","commandType":"auto","position":0.2500035208333333,"command":"describe PythonTempTable","commandVersion":0,"results":{"type":"table","data":[["# Registered as a temporary table",null,null],["group","StringType",null],["key","StringType",null],["value","IntegerType",null]],"arguments":{},"schema":[{"type":"string","name":"col_name"},{"type":"string","name":"data_type"},{"type":"string","name":"comment"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":null,"plotOptions":null},"errorSummary":null,"error":null,"startTime":1414515843674,"submitTime":1412123076087,"finishTime":1414515843708,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["afac5046-dc68-41aa-a580-a3f7796dbed7"],"latestUser":null,"lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"cca527b8-d03a-4f4f-9ef9-37aa760e1ac4","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3624","parent":null,"localVersion":90,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3625,"parentId":3596,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"e65328c2-30df-43ac-b442-2454d3713dc2","subtype":"script","commandType":"auto","position":0.2500036569444445,"command":"## A visualization appears automatically for the output of a **SQL select** statement in notebooks (no need to call display).","commandVersion":0,"results":{"type":"markdown","data":"## A visualization appears automatically for the output of a **SQL select** statement in notebooks (no need to call display).","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1414515843710,"submitTime":1412123080378,"finishTime":1414515843714,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["afac5046-dc68-41aa-a580-a3f7796dbed7"],"latestUser":null,"lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"3b2f16cf-3fdc-43fe-bee4-680a6da22e06","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3625","parent":null,"localVersion":90,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3626,"parentId":3596,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"c67d0fa8-f2e1-4566-82ba-95c435766b73","subtype":"script","commandType":"auto","position":0.25000379305555553,"command":"select * from PythonTempTable","commandVersion":0,"results":{"type":"table","data":[["vowels","a",1],["consonants","b",2],["consonants","c",3],["consonants","d",4],["vowels","e",5]],"arguments":{},"schema":[{"type":"string","name":"group"},{"type":"string","name":"key"},{"type":"int","name":"value"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":null,"plotOptions":null},"errorSummary":null,"error":null,"startTime":1414515843715,"submitTime":1412123083796,"finishTime":1414515844022,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["afac5046-dc68-41aa-a580-a3f7796dbed7"],"latestUser":null,"lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"a2108bd8-dbba-4303-b162-7a8eb4d5250e","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3626","parent":null,"localVersion":90,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3627,"parentId":3596,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"de16e39f-9d03-4475-a493-137416cf6f45","subtype":"script","commandType":"auto","position":0.2500039291666667,"command":"## Look for the **Export as CSV** icon ![Export as CSV](http://training.databricks.com/databricks_guide/export_csv.png) on the bottom right side of charts/graphs to download the results.","commandVersion":0,"results":{"type":"markdown","data":"## Look for the **Export as CSV** icon ![Export as CSV](http://training.databricks.com/databricks_guide/export_csv.png) on the bottom right side of charts/graphs to download the results.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1414515844026,"submitTime":1412114096921,"finishTime":1414515844040,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["afac5046-dc68-41aa-a580-a3f7796dbed7"],"latestUser":null,"lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"a42c7433-1fd1-4496-ad6d-e34d91deac9a","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3627","parent":null,"localVersion":90,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3628,"parentId":3596,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"450d69b4-4ba3-40d8-9750-212cbe0ed47a","subtype":"script","commandType":"auto","position":0.25000406527777774,"command":"## Use **saveAsTable** to persist the table to be used in other notebooks.","commandVersion":0,"results":{"type":"markdown","data":"## Use **saveAsTable** to persist the table to be used in other notebooks.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1414515844042,"submitTime":1411771484113,"finishTime":1414515844046,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["afac5046-dc68-41aa-a580-a3f7796dbed7"],"latestUser":null,"lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"7488c934-1c6d-4082-a0f1-579a930cea71","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3628","parent":null,"localVersion":90,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3629,"parentId":3596,"deltaVersion":0,"running":false,"state":"error","shouldRun":false,"rerunning":false,"stages":[],"guid":"ec9038c4-a14a-47c8-b188-90cb243b3a4d","subtype":"script","commandType":"auto","position":0.2500042013888889,"command":"sqlContext.sql(\"DROP TABLE IF EXISTS PythonTestTable\")\nschemaRdd.saveAsTable(\"PythonTestTable\")","commandVersion":0,"results":null,"errorSummary":null,"error":"Cancelled","startTime":0,"submitTime":1412123127332,"finishTime":1414515819112,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["afac5046-dc68-41aa-a580-a3f7796dbed7"],"latestUser":null,"lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"ed1ade4c-f59b-4ebc-9c54-8e8da63efc02","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3629","parent":null,"localVersion":90,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3630,"parentId":3596,"deltaVersion":0,"running":false,"state":"error","shouldRun":false,"rerunning":false,"stages":[],"guid":"1285ba11-a38e-46e8-96ac-f77aca98bad9","subtype":"script","commandType":"auto","position":0.25000433749999995,"command":"## Use **registerFunction** on the sqlContext to register a Python function for use in SQL.","commandVersion":0,"results":null,"errorSummary":null,"error":"Command skipped","startTime":0,"submitTime":1411771484113,"finishTime":1414515819132,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["afac5046-dc68-41aa-a580-a3f7796dbed7"],"latestUser":null,"lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"3e41ff9a-3c6e-46cc-8ef0-761c5a1d6e27","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3630","parent":null,"localVersion":90,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3631,"parentId":3596,"deltaVersion":0,"running":false,"state":"error","shouldRun":false,"rerunning":false,"stages":[],"guid":"2fe88d44-b83f-440e-bf9d-efe291c553c2","subtype":"script","commandType":"auto","position":0.2500044736111111,"command":"sqlContext.registerFunction(\"repeatPython\", lambda s: s + s)","commandVersion":0,"results":null,"errorSummary":null,"error":"Command skipped","startTime":0,"submitTime":1412123137424,"finishTime":1414515819150,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["afac5046-dc68-41aa-a580-a3f7796dbed7"],"latestUser":null,"lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"393f387a-b160-4b7b-8042-51e20c6a7ea9","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3631","parent":null,"localVersion":90,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3632,"parentId":3596,"deltaVersion":0,"running":false,"state":"error","shouldRun":false,"rerunning":false,"stages":[],"guid":"2e03325d-8c03-437e-b906-116a2120edd5","subtype":"script","commandType":"auto","position":0.25000460972222227,"command":"SELECT repeatPython(key) FROM PythonTestTable;","commandVersion":0,"results":null,"errorSummary":null,"error":"Command skipped","startTime":0,"submitTime":1412123138715,"finishTime":1414515819166,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["afac5046-dc68-41aa-a580-a3f7796dbed7"],"latestUser":null,"lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"62588786-2c56-48cf-9bdf-6acc73aa3cb0","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3632","parent":null,"localVersion":90,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3633,"parentId":3596,"deltaVersion":0,"running":false,"state":"error","shouldRun":false,"rerunning":false,"stages":[],"guid":"71428419-4046-4193-88af-d6f16f2626c9","subtype":"script","commandType":"auto","position":0.2500047458333333,"command":"# Exercise: Create your function in your notebook and call it from SQL.","commandVersion":0,"results":null,"errorSummary":null,"error":"Command skipped","startTime":0,"submitTime":1413919107017,"finishTime":1414515819183,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["afac5046-dc68-41aa-a580-a3f7796dbed7"],"latestUser":null,"lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"1ccabfe4-c627-47bd-8425-c787ecb49b68","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3633","parent":null,"localVersion":90,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3634,"parentId":3596,"deltaVersion":0,"running":false,"state":"error","shouldRun":false,"rerunning":false,"stages":[],"guid":"40c4a7e2-32d5-426c-bc06-ed2bf0f1276d","subtype":"script","commandType":"auto","position":0.2500048819444445,"command":"## Next, Search for **\"A SQL Notebook\"** to find out more about SQL functionality.","commandVersion":0,"results":null,"errorSummary":null,"error":"Command skipped","startTime":0,"submitTime":1412123180907,"finishTime":1414515819202,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["afac5046-dc68-41aa-a580-a3f7796dbed7"],"latestUser":null,"lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"9a27fa1a-6951-4838-a95a-0a0e61562937","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3634","parent":null,"localVersion":90,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3635,"parentId":3596,"deltaVersion":1446753907168,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"a501127b-e3d9-4e46-934a-3d851654e8ca","subtype":"command","commandType":"auto","position":0.3125,"command":"%md\n### **Clone** this notebook\nThis is a locked notebook so you will need to clone it into your workspace to use it.  \n* Click the **Clone** button in the menu bar on the top left. \n* Navigate to the cloned notebook (e.g. click Menu > Workspace > ``Intro Python Notebooks copy``)\n\n![Menu Bar Clone Notebook](http://training.databricks.com/databricks_guide/unlock_nb_clone_menu.png) ","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1434299407248,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"matei","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"bc0840a5-2009-4ecf-ac43-208894694513","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3635","arguments":{},"parent":null,"localVersion":96,"presenceMarks":[],"comments":null,"deltaEvent":"update","clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3636,"parentId":3596,"deltaVersion":1446753907169,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"c9e2d8a3-5af2-488f-8e71-f3a1dca325ed","subtype":"command","commandType":"auto","position":0.404296875,"command":"%md\n### **Attach** the Notebook to a **cluster**\n* A **Cluster** is a group of machines which can run commands in cells.\n* Check the upper left corner of your notebook to see if it is **Attached** or **Detached**.\n* If **Detached**, select a cluster to attach it to. If you don't currently have clusters, create one as described in the [Welcome to Databricks](/#workspace/databricks_guide/00 Welcome to Databricks) guide.\n\n![Attach Notebook](http://training.databricks.com/databricks_guide/cluster_attach2.png)","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1434249024746,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"denny@databricks.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"038b7e38-9e44-4349-ad06-e649fe286214","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3636","arguments":{},"parent":null,"localVersion":96,"presenceMarks":[],"comments":null,"deltaEvent":"update","clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3637,"parentId":3596,"deltaVersion":1446753907170,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"4fb53ff3-6b15-4ea1-9507-90a3a2880354","subtype":"command","commandType":"auto","position":0.49609375,"command":"%md\n***\n#### ![Quick Note](http://training.databricks.com/databricks_guide/icon_note3_s.png) **Cells** are units that make up notebooks\n![A Cell](http://training.databricks.com/databricks_guide/cell.png)\n\nCells each have a type - either **scala**, **python**, **sql**, **R**, or **markdown**.\n* While cells default to the type of the Notebook, other cell types are supported as well.\n* For example, Python Notebooks can contain python, sql, or markdown cells but not scala cells.\n* This cell is in **markdown** and is used for documentation. [Markdown](http://en.wikipedia.org/wiki/Markdown) is a simple text formatting syntax.\n***\n","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1434023297640,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"denny@databricks.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"55412755-dfbd-4c03-9657-15ddba2807ed","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3637","arguments":{},"parent":null,"localVersion":96,"presenceMarks":[],"comments":null,"deltaEvent":"update","clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3638,"parentId":3596,"deltaVersion":1446753907171,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"245356bf-10ad-40c2-a65e-65072868936d","subtype":"command","commandType":"auto","position":0.4990234375,"command":"%md \n### ** Create** and **Run** a New Markdown Cell in this Notebook\n* When you mouse between cells, a + sign will pop up in the center that you can click on to create a new cell.\n\n ![New Cell](http://training.databricks.com/databricks_guide/create_new_cell.png)\n* Type **``%md Hello, world!``** into your new cell (**``%md``** indicates the cell is markdown).\n\n\n\n* Press **Shift+Enter** when in the cell to **run** it and proceed to the next cell.\n  * The cells contents should update.\n  \n  ![Run cell](http://training.databricks.com/databricks_guide/run_cell.png)\n  ","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1438297092716,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"dbadmin","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"acb0c5b3-ff98-4372-a9a0-9b1f69f638c7","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3638","arguments":{},"parent":null,"localVersion":96,"presenceMarks":[],"comments":null,"deltaEvent":"update","clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3669,"parentId":3596,"deltaVersion":1446753907172,"running":false,"state":"input","shouldRun":false,"rerunning":false,"stages":[],"guid":"f1e0ef94-c3d8-42f8-9e1c-7594c7bcd0c3","subtype":"command","commandType":"auto","position":0.499267578125,"command":"%md Jules, Welcome to the DB Notebook cloud","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"","lastModifiedBy":"","diffInserts":[],"diffDeletes":[],"nuid":"9b57e91c-53dc-4cc9-a0fc-9d97b2db7142","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3669","arguments":{},"parent":null,"localVersion":96,"presenceMarks":[],"comments":null,"deltaEvent":"update","clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3639,"parentId":3596,"deltaVersion":1446753907173,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"13d685bd-0206-4341-b316-522c4a295ab8","subtype":"command","commandType":"auto","position":0.49951171875,"command":"%md Hello, world!","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1434299362394,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"matei","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"c57fcfcb-edd0-4044-9a84-d90467de3069","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3639","arguments":{},"parent":null,"localVersion":96,"presenceMarks":[],"comments":null,"deltaEvent":"update","clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3640,"parentId":3596,"deltaVersion":1446753907174,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"139daa05-49bf-4e70-a477-cf45b94e01d2","subtype":"command","commandType":"auto","position":0.499755859375,"command":"%md\n***\n#### ![Quick Note](http://training.databricks.com/databricks_guide/icon_note3_s.png) **Markdown Cell Tips**\n* To change a non-markdown cell to markdown, add **%md** to very start of the cell.\n* After updating the contents of a markdown cell, the cell must be run again to update the formatted contents of a markdown cell.\n* Cells are not automatically run each time you open it.\n  * Instead, previous results from running a cell are saved and displayed.\n* Alternately, press **Ctrl+Enter** when in a cell to **run** it, but not proceed to the next cell.\n***","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1434023476879,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"denny@databricks.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"91ec7fc9-0aab-4e1e-b3d5-16c997fbf76a","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3640","arguments":{},"parent":null,"localVersion":96,"presenceMarks":[],"comments":null,"deltaEvent":"update","clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3641,"parentId":3596,"deltaVersion":1446753907175,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"7d82d9e1-8f0b-4973-aae9-ccdf3d1d5c2e","subtype":"command","commandType":"auto","position":0.4999847412109375,"command":"%md\n### Run a **Python Cell**\n* Run the following python cell.\n* Note: There is no need for any special indicator (such as %md) necessary to create a Python cell in a Python notebook.\n* Make sure the output date and time updates before moving on.","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1434299370655,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"matei","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"abf3cd4f-8024-4aa6-a721-283225fb3a34","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3641","arguments":{},"parent":null,"localVersion":96,"presenceMarks":[],"comments":null,"deltaEvent":"update","clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3642,"parentId":3596,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"5f0c6309-5cb9-4728-851a-3f51bb97576f","subtype":"command","commandType":"auto","position":0.49999237060546875,"command":"# This is a Python cell.\nimport datetime\nprint \"This was last run on: %s\" % datetime.datetime.now()\nprint \"Hello Jules, Welcome to the Databricks Cloud\"","commandVersion":0,"results":{"type":"html","data":"<div class=\"ansiout\">This was last run on: 2015-11-05 21:01:35.288666\nHello Jules, Welcome to the Databricks Cloud\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1446757295249,"submitTime":1446757295247,"finishTime":1446757295296,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"dmatrix@comcast.net","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"1f271db4-a6a8-478c-a343-afcf7a7f8d45","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3642","sparkCtxId":"3350236377910829590","clusterName":"","arguments":{},"clusterId":"","clusterMemory":0,"parent":null,"localVersion":90,"presenceMarks":[],"comments":null},{"type":"command","id":3643,"parentId":3596,"deltaVersion":1446753907176,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"f35d87e2-971c-4007-a115-a4a0b5b91791","subtype":"command","commandType":"auto","position":8,"command":"%md\n### Running **Spark**\nThe variable **sc** allows you to access a Spark Context to run your Spark programs.\n* For more information about Spark, please refer to [Spark Overview](https://spark.apache.org/docs/latest/)","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1433998811266,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"latestUser":"denny@databricks.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"9a45d6d5-0d1b-4417-be2f-7a477da2a476","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3643","arguments":{},"parent":null,"localVersion":96,"presenceMarks":[],"comments":null,"deltaEvent":"update","clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3644,"parentId":3596,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"5a042354-1f38-413d-a6b2-511a53b90f10","subtype":"command","commandType":"auto","position":9,"command":"words = sc.parallelize([\"hello\", \"world\", \"goodbye\", \"hello\", \"again\", \"cats\", \"dogs\", \"rats\", \"snakes\", \"python\", \"java\", \"python\", \"go\"])\nwordcounts = words.map(lambda s: (s, 1)).reduceByKey(lambda a, b : a + b).collect()\nprint wordcounts","commandVersion":0,"results":{"type":"html","data":"<div class=\"ansiout\">[(&apos;again&apos;, 1), (&apos;java&apos;, 1), (&apos;rats&apos;, 1), (&apos;snakes&apos;, 1), (&apos;python&apos;, 2), (&apos;cats&apos;, 1), (&apos;goodbye&apos;, 1), (&apos;go&apos;, 1), (&apos;world&apos;, 1), (&apos;hello&apos;, 2), (&apos;dogs&apos;, 1)]\n</div>","arguments":{},"plotOptions":null},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;wordcount&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-15-c0ea3b346684&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> words <span class=\"ansiyellow\">=</span> sc<span class=\"ansiyellow\">.</span>parallelize<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">[</span><span class=\"ansiblue\">&quot;hello&quot;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;world&quot;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;goodbye&quot;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;hello&quot;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;again&quot;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;cats&quot;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;dogs&quot;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;rats&quot;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;snakes&quot;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;python&quot;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;java&quot;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;python&quot;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;go&quot;</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      2</span> wordcounts <span class=\"ansiyellow\">=</span> words<span class=\"ansiyellow\">.</span>map<span class=\"ansiyellow\">(</span><span class=\"ansigreen\">lambda</span> s<span class=\"ansiyellow\">:</span> <span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>reduceByKey<span class=\"ansiyellow\">(</span><span class=\"ansigreen\">lambda</span> a<span class=\"ansiyellow\">,</span> b <span class=\"ansiyellow\">:</span> a <span class=\"ansiyellow\">+</span> b<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>collect<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 3</span><span class=\"ansiyellow\"> </span><span class=\"ansigreen\">print</span> wordcount<span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;wordcount&apos; is not defined\n</div>","startTime":1446759152377,"submitTime":1446759152420,"finishTime":1446759152759,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"html","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"latestUser":"dmatrix@comcast.net","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"f104e6fa-dac0-454e-94d5-4c53bb33e989","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3644","sparkCtxId":"3350236377910829590","clusterName":"","arguments":{},"clusterId":"","clusterMemory":0,"parent":null,"localVersion":90,"presenceMarks":[],"comments":null},{"type":"command","id":3645,"parentId":3596,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"2c8d7103-ab90-498a-8013-20a52862594f","subtype":"command","commandType":"auto","position":9.15625,"command":"# Exercise: Calculate the number of unique words in the \"words\" RDD here.\n# (Hint: The answer should be 4.)\nunique = words.distinct().collect()\nprint unique\nprint len(unique)","commandVersion":0,"results":{"type":"html","data":"<div class=\"ansiout\">[&apos;again&apos;, &apos;java&apos;, &apos;rats&apos;, &apos;snakes&apos;, &apos;python&apos;, &apos;cats&apos;, &apos;goodbye&apos;, &apos;go&apos;, &apos;world&apos;, &apos;hello&apos;, &apos;dogs&apos;]\n11\n</div>","arguments":{},"plotOptions":null},"errorSummary":"<span class=\"ansired\">AttributeError</span>: &apos;list&apos; object has no attribute &apos;len&apos;","error":"<div class=\"ansiout\">[&apos;again&apos;, &apos;java&apos;, &apos;rats&apos;, &apos;snakes&apos;, &apos;python&apos;, &apos;cats&apos;, &apos;goodbye&apos;, &apos;go&apos;, &apos;world&apos;, &apos;hello&apos;, &apos;dogs&apos;]\n<span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AttributeError</span>                            Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-24-c8b4205cda6c&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      3</span> unique <span class=\"ansiyellow\">=</span> words<span class=\"ansiyellow\">.</span>distinct<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>collect<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      4</span> <span class=\"ansigreen\">print</span> unique<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 5</span><span class=\"ansiyellow\"> </span><span class=\"ansigreen\">print</span> unique<span class=\"ansiyellow\">.</span>len<span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AttributeError</span>: &apos;list&apos; object has no attribute &apos;len&apos;\n</div>","startTime":1446760602750,"submitTime":1446760602836,"finishTime":1446760603029,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"latestUser":"dmatrix@comcast.net","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"5fe7bd9b-b8ba-4b39-9ea6-9c6900088725","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3645","sparkCtxId":"3350236377910829590","clusterName":"","arguments":{},"clusterId":"","clusterMemory":0,"parent":null,"localVersion":90,"presenceMarks":[],"comments":null},{"type":"command","id":3646,"parentId":3596,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"aa64a5a4-24cf-43da-b7c8-3519c85e1893","subtype":"command","commandType":"auto","position":9.1875,"command":"# Exercise: Create an RDD of numbers, and use Spark to find the mean.\nfrom operator import add\nnumbersRDD = sc.parallelize([1, 2, 3, 4, 5, 6, 7, 8, 9, 10])\n#not the most efficient way since we're invoking two actions: reduce, and count\n#must be an efficient way to do it.\nsum = numbersRDD.sum()\ncount = numbersRDD.count()\nprint sum, count, float (sum / count)","commandVersion":0,"results":{"type":"html","data":"<div class=\"ansiout\">55 10 5.0\n</div>","arguments":{},"plotOptions":null},"errorSummary":"org.apache.spark.SparkException: Job aborted due to stage failure: Task 9 in stage 35.0 failed 4 times, most recent failure: Lost task 9.3 in stage 35.0 (TID 1238, 10.182.243.84): org.apache.spark.api.python.PythonException: Traceback (most recent call last):","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">Py4JJavaError</span>                             Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-39-a5e6d6c1cfbb&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      2</span> numbersRDD <span class=\"ansiyellow\">=</span> sc<span class=\"ansiyellow\">.</span>parallelize<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">2</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">3</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">4</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">5</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">6</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">7</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">8</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">9</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">10</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      3</span> mean <span class=\"ansiyellow\">=</span> numbersRDD<span class=\"ansiyellow\">.</span>map<span class=\"ansiyellow\">(</span><span class=\"ansigreen\">lambda</span> n<span class=\"ansiyellow\">:</span> sum<span class=\"ansiyellow\">(</span>n<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 4</span><span class=\"ansiyellow\"> </span><span class=\"ansigreen\">print</span> mean<span class=\"ansiyellow\">.</span>count<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/home/ubuntu/databricks/spark/python/pyspark/rdd.py</span> in <span class=\"ansicyan\">count</span><span class=\"ansiblue\">(self)</span>\n<span class=\"ansigreen\">   1004</span>         <span class=\"ansicyan\">3</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1005</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">-&gt; 1006</span><span class=\"ansiyellow\">         </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>mapPartitions<span class=\"ansiyellow\">(</span><span class=\"ansigreen\">lambda</span> i<span class=\"ansiyellow\">:</span> <span class=\"ansiyellow\">[</span>sum<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">1</span> <span class=\"ansigreen\">for</span> _ <span class=\"ansigreen\">in</span> i<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>sum<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1007</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1008</span>     <span class=\"ansigreen\">def</span> stats<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/home/ubuntu/databricks/spark/python/pyspark/rdd.py</span> in <span class=\"ansicyan\">sum</span><span class=\"ansiblue\">(self)</span>\n<span class=\"ansigreen\">    995</span>         <span class=\"ansicyan\">6.0</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    996</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">--&gt; 997</span><span class=\"ansiyellow\">         </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>mapPartitions<span class=\"ansiyellow\">(</span><span class=\"ansigreen\">lambda</span> x<span class=\"ansiyellow\">:</span> <span class=\"ansiyellow\">[</span>sum<span class=\"ansiyellow\">(</span>x<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>fold<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">,</span> operator<span class=\"ansiyellow\">.</span>add<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    998</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    999</span>     <span class=\"ansigreen\">def</span> count<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/home/ubuntu/databricks/spark/python/pyspark/rdd.py</span> in <span class=\"ansicyan\">fold</span><span class=\"ansiblue\">(self, zeroValue, op)</span>\n<span class=\"ansigreen\">    869</span>         <span class=\"ansired\"># zeroValue provided to each partition is unique from the one provided</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    870</span>         <span class=\"ansired\"># to the final reduce call</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 871</span><span class=\"ansiyellow\">         </span>vals <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>mapPartitions<span class=\"ansiyellow\">(</span>func<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>collect<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    872</span>         <span class=\"ansigreen\">return</span> reduce<span class=\"ansiyellow\">(</span>op<span class=\"ansiyellow\">,</span> vals<span class=\"ansiyellow\">,</span> zeroValue<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    873</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/home/ubuntu/databricks/spark/python/pyspark/rdd.py</span> in <span class=\"ansicyan\">collect</span><span class=\"ansiblue\">(self)</span>\n<span class=\"ansigreen\">    771</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">    772</span>         <span class=\"ansigreen\">with</span> SCCallSiteSync<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>context<span class=\"ansiyellow\">)</span> <span class=\"ansigreen\">as</span> css<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 773</span><span class=\"ansiyellow\">             </span>port <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>ctx<span class=\"ansiyellow\">.</span>_jvm<span class=\"ansiyellow\">.</span>PythonRDD<span class=\"ansiyellow\">.</span>collectAndServe<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_jrdd<span class=\"ansiyellow\">.</span>rdd<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    774</span>         <span class=\"ansigreen\">return</span> list<span class=\"ansiyellow\">(</span>_load_from_socket<span class=\"ansiyellow\">(</span>port<span class=\"ansiyellow\">,</span> self<span class=\"ansiyellow\">.</span>_jrdd_deserializer<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    775</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/home/ubuntu/databricks/spark/python/lib/py4j-0.8.2.1-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">    536</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    537</span>         return_value = get_return_value(answer, self.gateway_client,\n<span class=\"ansigreen\">--&gt; 538</span><span class=\"ansiyellow\">                 self.target_id, self.name)\n</span><span class=\"ansigreen\">    539</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    540</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/home/ubuntu/databricks/spark/python/pyspark/sql/utils.py</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     34</span>     <span class=\"ansigreen\">def</span> deco<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     35</span>         <span class=\"ansigreen\">try</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 36</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> f<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     37</span>         <span class=\"ansigreen\">except</span> py4j<span class=\"ansiyellow\">.</span>protocol<span class=\"ansiyellow\">.</span>Py4JJavaError <span class=\"ansigreen\">as</span> e<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     38</span>             s <span class=\"ansiyellow\">=</span> e<span class=\"ansiyellow\">.</span>java_exception<span class=\"ansiyellow\">.</span>toString<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/home/ubuntu/databricks/spark/python/lib/py4j-0.8.2.1-src.zip/py4j/protocol.py</span> in <span class=\"ansicyan\">get_return_value</span><span class=\"ansiblue\">(answer, gateway_client, target_id, name)</span>\n<span class=\"ansigreen\">    298</span>                 raise Py4JJavaError(\n<span class=\"ansigreen\">    299</span>                     <span class=\"ansiblue\">&apos;An error occurred while calling {0}{1}{2}.\\n&apos;</span><span class=\"ansiyellow\">.</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 300</span><span class=\"ansiyellow\">                     format(target_id, &apos;.&apos;, name), value)\n</span><span class=\"ansigreen\">    301</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    302</span>                 raise Py4JError(\n\n<span class=\"ansired\">Py4JJavaError</span>: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.collectAndServe.\n: org.apache.spark.SparkException: Job aborted due to stage failure: Task 9 in stage 35.0 failed 4 times, most recent failure: Lost task 9.3 in stage 35.0 (TID 1238, 10.182.243.84): org.apache.spark.api.python.PythonException: Traceback (most recent call last):\n  File &quot;/home/ubuntu/databricks/spark/python/pyspark/worker.py&quot;, line 111, in main\n    process()\n  File &quot;/home/ubuntu/databricks/spark/python/pyspark/worker.py&quot;, line 106, in process\n    serializer.dump_stream(func(split_index, iterator), outfile)\n  File &quot;/home/ubuntu/databricks/spark/python/pyspark/rdd.py&quot;, line 2355, in pipeline_func\n    return func(split, prev_func(split, iterator))\n  File &quot;/home/ubuntu/databricks/spark/python/pyspark/rdd.py&quot;, line 2355, in pipeline_func\n    return func(split, prev_func(split, iterator))\n  File &quot;/home/ubuntu/databricks/spark/python/pyspark/rdd.py&quot;, line 2355, in pipeline_func\n    return func(split, prev_func(split, iterator))\n  File &quot;/home/ubuntu/databricks/spark/python/pyspark/rdd.py&quot;, line 317, in func\n    return f(iterator)\n  File &quot;/home/ubuntu/databricks/spark/python/pyspark/rdd.py&quot;, line 1006, in &lt;lambda&gt;\n    return self.mapPartitions(lambda i: [sum(1 for _ in i)]).sum()\n  File &quot;/home/ubuntu/databricks/spark/python/pyspark/rdd.py&quot;, line 1006, in &lt;genexpr&gt;\n    return self.mapPartitions(lambda i: [sum(1 for _ in i)]).sum()\n  File &quot;&lt;ipython-input-39-a5e6d6c1cfbb&gt;&quot;, line 3, in &lt;lambda&gt;\nTypeError: &apos;int&apos; object is not iterable\n\n\tat org.apache.spark.api.python.PythonRunner$$anon$1.read(PythonRDD.scala:166)\n\tat org.apache.spark.api.python.PythonRunner$$anon$1.&lt;init&gt;(PythonRDD.scala:207)\n\tat org.apache.spark.api.python.PythonRunner.compute(PythonRDD.scala:125)\n\tat org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:70)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:297)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:264)\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:66)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:88)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:214)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:745)\n\nDriver stacktrace:\n\tat org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1283)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1271)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1270)\n\tat scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:47)\n\tat org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:1270)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:697)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:697)\n\tat scala.Option.foreach(Option.scala:236)\n\tat org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:697)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1496)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1458)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1447)\n\tat org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:567)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1825)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1838)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1851)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1922)\n\tat org.apache.spark.rdd.RDD$$anonfun$collect$1.apply(RDD.scala:905)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:147)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:108)\n\tat org.apache.spark.rdd.RDD.withScope(RDD.scala:306)\n\tat org.apache.spark.rdd.RDD.collect(RDD.scala:904)\n\tat org.apache.spark.api.python.PythonRDD$.collectAndServe(PythonRDD.scala:405)\n\tat org.apache.spark.api.python.PythonRDD.collectAndServe(PythonRDD.scala)\n\tat sun.reflect.GeneratedMethodAccessor93.invoke(Unknown Source)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:497)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:231)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:379)\n\tat py4j.Gateway.invoke(Gateway.java:259)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:133)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:207)\n\tat java.lang.Thread.run(Thread.java:745)\nCaused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):\n  File &quot;/home/ubuntu/databricks/spark/python/pyspark/worker.py&quot;, line 111, in main\n    process()\n  File &quot;/home/ubuntu/databricks/spark/python/pyspark/worker.py&quot;, line 106, in process\n    serializer.dump_stream(func(split_index, iterator), outfile)\n  File &quot;/home/ubuntu/databricks/spark/python/pyspark/rdd.py&quot;, line 2355, in pipeline_func\n    return func(split, prev_func(split, iterator))\n  File &quot;/home/ubuntu/databricks/spark/python/pyspark/rdd.py&quot;, line 2355, in pipeline_func\n    return func(split, prev_func(split, iterator))\n  File &quot;/home/ubuntu/databricks/spark/python/pyspark/rdd.py&quot;, line 2355, in pipeline_func\n    return func(split, prev_func(split, iterator))\n  File &quot;/home/ubuntu/databricks/spark/python/pyspark/rdd.py&quot;, line 317, in func\n    return f(iterator)\n  File &quot;/home/ubuntu/databricks/spark/python/pyspark/rdd.py&quot;, line 1006, in &lt;lambda&gt;\n    return self.mapPartitions(lambda i: [sum(1 for _ in i)]).sum()\n  File &quot;/home/ubuntu/databricks/spark/python/pyspark/rdd.py&quot;, line 1006, in &lt;genexpr&gt;\n    return self.mapPartitions(lambda i: [sum(1 for _ in i)]).sum()\n  File &quot;&lt;ipython-input-39-a5e6d6c1cfbb&gt;&quot;, line 3, in &lt;lambda&gt;\nTypeError: &apos;int&apos; object is not iterable\n\n\tat org.apache.spark.api.python.PythonRunner$$anon$1.read(PythonRDD.scala:166)\n\tat org.apache.spark.api.python.PythonRunner$$anon$1.&lt;init&gt;(PythonRDD.scala:207)\n\tat org.apache.spark.api.python.PythonRunner.compute(PythonRDD.scala:125)\n\tat org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:70)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:297)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:264)\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:66)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:88)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:214)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\t... 1 more\n\n</div>","startTime":1446762453060,"submitTime":1446762453180,"finishTime":1446762453340,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"latestUser":"dmatrix@comcast.net","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"f0c9516a-80b9-47d7-8c02-f7a7bf04e948","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3646","sparkCtxId":"3350236377910829590","clusterName":"","arguments":{},"clusterId":"","clusterMemory":0,"parent":null,"localVersion":90,"presenceMarks":[],"comments":null},{"type":"command","id":3647,"parentId":3596,"deltaVersion":1446753907177,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"9fa00341-47b1-4d84-af9d-b4947825555a","subtype":"command","commandType":"auto","position":10.6015625,"command":"%md\n&nbsp;\n\n### Working with **DataFrames**\n* Python can be used to create Spark [DataFrames](http://spark.apache.org/docs/latest/sql-programming-guide.html) - a distributed collection of data organized into named columns.\n* DataFrames are created by calling ``createDataFrame`` on an RDD of pyspark.sql.Row objects.","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1434299386308,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"latestUser":"matei","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"d56a1790-5553-4749-970f-de17d465967d","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3647","arguments":{},"parent":null,"localVersion":96,"presenceMarks":[],"comments":null,"deltaEvent":"update","clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3648,"parentId":3596,"deltaVersion":1446753907705,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"a2add78f-3919-4d15-9bda-f1da314591c6","subtype":"command","commandType":"auto","position":10.625,"command":"# Reference pyspark.sql.Row object\nfrom pyspark.sql import Row\n\n# Build the array of Row objects\narray = [Row(key=\"a\", group=\"vowels\", value=105),\n         Row(key=\"b\", group=\"consonants\", value=25),\n         Row(key=\"c\", group=\"consonants\", value=30),\n         Row(key=\"d\", group=\"consonants\", value=45),\n         Row(key=\"e\", group=\"vowels\", value=55)]\n# build the array of Row of people objects\npeople = [Row(key=1, age=32, name=\"Jules Damji\", city=\"San Francisco\", occupation=\"advocate\"),\n          Row(key=2,  age=42, name=\"Arther Dent\", city=\"London\", occupation=\"Hitch-hiker\"),\n          Row(key=3,  age=2009, name=\"Zaphod Beeblebrox\", city=\"Milkyway\", occupation=\"Wiseman\"),\n          Row(key=4,  age=55, name=\"Ford Prefect\", city=\"Essex\", occupation=\"Realtor\"),\n          Row(key=5, age=2005, name=\"Trillian\", city=\"Andromeda\", occupation=\"Space Traveler\"),\n          Row(key=6, age=1000, name=\"Slartibarfast\", city=\"M33\", occupation=\"Creator\"),\n          Row(key=7, age=4500, name=\"Random Dent\", city=\"X33\", occupation=\"Invisble Hand\")\n]\n\n# Create RDD using sc.parallelize and then transforms it into a DataFrame\ndf = sqlContext.createDataFrame(sc.parallelize(array))\ndfp = sqlContext.createDataFrame(sc.parallelize(people))","commandVersion":0,"results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"plotOptions":null},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;peope&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-77-1e4fce451ede&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">     20</span> <span class=\"ansired\"># Create RDD using sc.parallelize and then transforms it into a DataFrame</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     21</span> df <span class=\"ansiyellow\">=</span> sqlContext<span class=\"ansiyellow\">.</span>createDataFrame<span class=\"ansiyellow\">(</span>sc<span class=\"ansiyellow\">.</span>parallelize<span class=\"ansiyellow\">(</span>array<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 22</span><span class=\"ansiyellow\"> </span>dfp <span class=\"ansiyellow\">=</span> sqlContext<span class=\"ansiyellow\">.</span>createDataFrame<span class=\"ansiyellow\">(</span>sc<span class=\"ansiyellow\">.</span>parallelize<span class=\"ansiyellow\">(</span>peope<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;peope&apos; is not defined\n</div>","startTime":1446772534699,"submitTime":1446772535033,"finishTime":1446772535037,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"latestUser":"dmatrix@comcast.net","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"60dc46e3-c591-49d2-90b8-3b4abdb6e5f4","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3648","sparkCtxId":"3350236377910829590","clusterName":"","arguments":{},"clusterId":"","clusterMemory":0,"parent":null,"localVersion":667,"presenceMarks":[],"comments":null,"deltaEvent":"update"},{"type":"command","id":3649,"parentId":3596,"deltaVersion":1446753907709,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"b43e1987-c420-4403-b46f-e1f2a851f7a3","subtype":"command","commandType":"auto","position":10.91796875,"command":"%md\n\n#### **Show this data**\nUse the **``display``** command to view a DataFrame in a notebook.","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1434023658369,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"latestUser":"denny@databricks.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"41a81e62-caa0-4c60-92c3-67b150ddb114","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3649","arguments":{},"parent":null,"localVersion":102,"presenceMarks":[],"comments":null,"deltaEvent":"update","clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3650,"parentId":3596,"deltaVersion":1446753907716,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"0ae06fdf-6753-4869-81ff-76cc951d0862","subtype":"command","commandType":"auto","position":11.064453125,"command":"display(df)","commandVersion":0,"results":{"overflow":false,"data":[["vowels","a",105],["consonants","b",25],["consonants","c",30],["consonants","d",45],["vowels","e",55]],"plotOptions":null,"aggType":"","aggSchema":[],"schema":[{"name":"group","type":"string"},{"name":"key","type":"string"},{"name":"value","type":"bigint"}],"aggError":"","aggData":[],"type":"table","aggOverflow":false,"aggSeriesLimitReached":false,"arguments":{}},"errorSummary":null,"error":null,"startTime":1446772540985,"submitTime":1446772541336,"finishTime":1446772541166,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"pieChart","width":"260","height":"293","xColumns":["key"],"yColumns":["value"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"latestUser":"dmatrix@comcast.net","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"e8f815e1-2d47-4dc0-8bc3-b12bd2e1d35e","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3650","sparkCtxId":"3350236377910829590","clusterName":"","arguments":{},"clusterId":"","clusterMemory":0,"parent":null,"localVersion":103,"presenceMarks":[],"comments":null,"deltaEvent":"update"},{"type":"command","id":3651,"parentId":3596,"deltaVersion":1446753907720,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"b90f3c41-4aaf-464d-8d7c-5da2d8353ce4","subtype":"command","commandType":"auto","position":11.1376953125,"command":"%md \n***\n#### ![Quick Note](http://training.databricks.com/databricks_guide/icon_note3_s.png) **The visualization above is interactive**\n* Click on the **Chart Button** ![Chart Button](http://training.databricks.com/databricks_guide/chart_button.png) to toggle the view.\n* Try different types of graphs by clicking on the arrow next to the chart button.\n* If you have selected a graph, you can click on **Plot Options...** for even more ways to customize the view.\n***","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1434023845016,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"latestUser":"denny@databricks.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"a78f6fc4-48a6-41fa-97d7-c6a8477a5a2f","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3651","arguments":{},"parent":null,"localVersion":98,"presenceMarks":[],"comments":null,"deltaEvent":"update","clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3652,"parentId":3596,"deltaVersion":1446753907727,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"02ba9d75-c639-48d2-8546-359297eeb558","subtype":"command","commandType":"auto","position":11.17431640625,"command":"# Exercise: Create a DataFrame and display it. \n# Can you use the \"Plot Options\" to plot the group vs. the sum of the values in that group?\n# (Hint: Vowels = 6, and consonants = 9)\ndisplay(df)\n","commandVersion":0,"results":{"overflow":false,"data":[["vowels","a",105],["consonants","b",25],["consonants","c",30],["consonants","d",45],["vowels","e",55]],"plotOptions":null,"aggType":"","aggSchema":[],"schema":[{"name":"group","type":"string"},{"name":"key","type":"string"},{"name":"value","type":"bigint"}],"aggError":"","aggData":[],"type":"table","aggOverflow":false,"aggSeriesLimitReached":false,"arguments":{}},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;displa&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-66-d334c920b183&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      2</span> <span class=\"ansired\"># Can you use the &quot;Plot Options&quot; to plot the group vs. the sum of the values in that group?</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      3</span> <span class=\"ansired\"># (Hint: Vowels = 6, and consonants = 9)</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 4</span><span class=\"ansiyellow\"> </span>displa<span class=\"ansiyellow\">(</span>df<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;displa&apos; is not defined\n</div>","startTime":1446772545379,"submitTime":1446772545728,"finishTime":1446772545601,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"pieChart","width":"260","height":"auto","xColumns":["group"],"yColumns":["value"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":{"pieChart":[{"key":"donut","value":true}],"barChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}],"areaChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}]},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"latestUser":"dmatrix@comcast.net","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"40ad87b7-4dc9-4131-98c9-46240d19be20","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3652","parent":null,"localVersion":180,"presenceMarks":[],"comments":null,"deltaEvent":"update","sparkCtxId":"3350236377910829590","clusterId":"","clusterMemory":0,"clusterName":"","arguments":{}},{"type":"command","id":3653,"parentId":3596,"deltaVersion":1446753907741,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"4230f960-8aed-4f52-bf64-b77705611f40","subtype":"command","commandType":"auto","position":12.962158203125,"command":"%md\n***\n## ![Quick Note](http://training.databricks.com/databricks_guide/icon_note3_s.png) **Where to Go Next**\n\nWe've now covered the basics of a Databricks Python Notebook.  Practice the optional exercises below for more python exercises, look to the following notebooks in other languages, or go to the Databricks Product Overview.\n* [Notebook Tutorials in Scala](/#workspace/databricks_guide/01 Intro Notebooks/2 Intro Scala Notebooks)\n* [Notebook Tutorials in SQL](/#workspace/databricks_guide/01 Intro Notebooks/3 Intro SQL Notebooks)\n* [Notebook Tutorials in R](/#workspace/databricks_guide/01 Intro Notebooks/4 Intro R Notebooks)\n* [Databricks Product Overview](/#workspace/databricks_guide/02 Product Overview/00 Product Overview)\n***","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1435791006218,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"vida","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"b18b5c1e-dafc-40fd-8a58-83671392db20","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3653","arguments":{},"parent":null,"localVersion":110,"presenceMarks":[],"comments":null,"deltaEvent":"update","clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3654,"parentId":3596,"deltaVersion":1446753907181,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"8d2d6895-113c-4e40-a2dd-70e694aef3f8","subtype":"command","commandType":"auto","position":36.75,"command":"%md ## **Optional Tasks**","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1433998811581,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"denny@databricks.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"d80e3786-6e4b-4135-9baf-4486f60ede2c","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3654","arguments":{},"parent":null,"localVersion":96,"presenceMarks":[],"comments":null,"deltaEvent":"update","clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3655,"parentId":3596,"deltaVersion":1446753907182,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"a4432f75-97a8-4a7f-a9e2-b06c59e62a82","subtype":"command","commandType":"auto","position":37.75,"command":"%md\n### **Importing Standard Python libraries**\n* For other libraries that are not available by default, you can upload other libraries to the Workspace.\n* Refer to the **[Libraries](/#workspace/databricks_guide/02 Product Overview/07 Libraries)** guide for more details.","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1434024203866,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"denny@databricks.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"8622530d-8276-48b4-9fd3-c49f5e16ebe5","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3655","arguments":{},"parent":null,"localVersion":96,"presenceMarks":[],"comments":null,"deltaEvent":"update","clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3656,"parentId":3596,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"89b681a4-a8be-4bfc-8216-46f2fa0bfba7","subtype":"command","commandType":"auto","position":38.75,"command":"import re\nm = re.search('(?<=abc)def', 'abcdef')\nm.group(0)","commandVersion":0,"results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">70</span><span class=\"ansired\">]: </span>&apos;def&apos;\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1446770901005,"submitTime":1446770901317,"finishTime":1446770901083,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"dmatrix@comcast.net","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"df5e4ba5-600e-4e32-8c9d-8b02219c0198","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3656","parent":null,"localVersion":94,"presenceMarks":[],"comments":null,"deltaEvent":"update","sparkCtxId":"3350236377910829590","clusterId":"","clusterMemory":0,"clusterName":"","arguments":{}},{"type":"command","id":3657,"parentId":3596,"deltaVersion":1446753907183,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"b00ac601-d820-4968-be23-243df7983b73","subtype":"command","commandType":"auto","position":39.25,"command":"%md\n### **Using Spark SQL within a Python Notebook**\nYou can use execute SQL commands within a python notebook by invoking **``%sql``**.","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1434025237645,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"denny@databricks.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"779a648f-79da-4e55-877c-66b788a423c9","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3657","arguments":{},"parent":null,"localVersion":98,"presenceMarks":[],"comments":null,"deltaEvent":"update","clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3658,"parentId":3596,"deltaVersion":1446753907666,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"93da4b2b-dd9d-4f1e-a1b5-9452a5ab2bfc","subtype":"command","commandType":"auto","position":39.4921875,"command":"%sql show databases","commandVersion":0,"results":{"overflow":false,"data":[["default"]],"plotOptions":null,"aggType":"","aggSchema":[],"schema":[{"name":"result","type":"string"}],"aggError":"","aggData":[],"type":"table","aggOverflow":false,"aggSeriesLimitReached":false,"arguments":{}},"errorSummary":null,"error":null,"startTime":1446772463407,"submitTime":1446772463753,"finishTime":1446772463446,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"dmatrix@comcast.net","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"02a313f8-3390-483f-96ed-50e573679a75","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3658","sparkCtxId":"3350236377910829590","clusterName":"","arguments":{},"clusterId":"","clusterMemory":0,"parent":null,"localVersion":100,"presenceMarks":[],"comments":null,"deltaEvent":"update"},{"type":"command","id":3659,"parentId":3596,"deltaVersion":1446753907670,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"7d3fdc1d-a3a7-41c7-a0ad-f2de98c97292","subtype":"command","commandType":"auto","position":39.609375,"command":"%md\n\n#### **Use ``registerTempTable`` on a DataFrame** \n* Register the above DataFrame table (built in python) for SQL queries.\n* Temporary tables are not meant to be persistent, i.e. they will not survive cluster restarts.","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1434024402887,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"denny@databricks.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"5c8e755b-3139-480a-badc-18e2a46e020d","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3659","arguments":{},"parent":null,"localVersion":100,"presenceMarks":[],"comments":null,"deltaEvent":"update","clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3660,"parentId":3596,"deltaVersion":1446753907838,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"80cdc453-de83-4b4d-a13b-43617238a0bb","subtype":"command","commandType":"auto","position":39.6171875,"command":"df.registerTempTable(\"PythonTempTable\")","commandVersion":0,"results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"plotOptions":null},"errorSummary":"<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax","error":"<div class=\"ansiout\"><span class=\"ansicyan\">  File </span><span class=\"ansigreen\">&quot;&lt;ipython-input-82-75c1918bfdef&gt;&quot;</span><span class=\"ansicyan\">, line </span><span class=\"ansigreen\">2</span>\n<span class=\"ansiyellow\">    dfp.registerTempTable(&quot;P&quot;ythonTempPeopleTable&quot;)</span>\n<span class=\"ansigrey\">                                                ^</span>\n<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax\n\n</div>","startTime":1446772779302,"submitTime":1446772779635,"finishTime":1446772779347,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"dmatrix@comcast.net","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"cf687c1b-8aae-4ba5-90bd-c8727a9f8490","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3660","parent":null,"localVersion":172,"presenceMarks":[],"comments":null,"deltaEvent":"update","sparkCtxId":"3350236377910829590","clusterId":"","clusterMemory":0,"clusterName":"","arguments":{}},{"type":"command","id":3661,"parentId":3596,"deltaVersion":1446753907848,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"62c991e1-3aa8-4d4f-b6c4-0ae92186fd3c","subtype":"command","commandType":"auto","position":39.623046875,"command":"%sql describe PythonTempTable\n","commandVersion":0,"results":{"overflow":false,"data":[["group","string",""],["key","string",""],["value","bigint",""]],"plotOptions":null,"aggType":"","aggSchema":[],"schema":[{"name":"col_name","type":"string"},{"name":"data_type","type":"string"},{"name":"comment","type":"string"}],"aggError":"","aggData":[],"type":"table","aggOverflow":false,"aggSeriesLimitReached":false,"arguments":{}},"errorSummary":"Error in SQL statement: AnalysisException: missing EOF at '%' near 'PythonTempTable'; line 2 pos 0","error":"com.databricks.backend.common.rpc.DatabricksExceptions$SQLExecutionException: org.apache.spark.sql.AnalysisException: missing EOF at '%' near 'PythonTempTable'; line 2 pos 0\n\tat org.apache.spark.sql.hive.HiveQl$.createPlan(HiveQl.scala:313)\n\tat org.apache.spark.sql.hive.ExtendedHiveQlParser$$anonfun$hiveQl$1.apply(ExtendedHiveQlParser.scala:41)\n\tat org.apache.spark.sql.hive.ExtendedHiveQlParser$$anonfun$hiveQl$1.apply(ExtendedHiveQlParser.scala:40)\n\tat scala.util.parsing.combinator.Parsers$Success.map(Parsers.scala:136)\n\tat scala.util.parsing.combinator.Parsers$Success.map(Parsers.scala:135)\n\tat scala.util.parsing.combinator.Parsers$Parser$$anonfun$map$1.apply(Parsers.scala:242)\n\tat scala.util.parsing.combinator.Parsers$Parser$$anonfun$map$1.apply(Parsers.scala:242)\n\tat scala.util.parsing.combinator.Parsers$$anon$3.apply(Parsers.scala:222)\n\tat scala.util.parsing.combinator.Parsers$Parser$$anonfun$append$1$$anonfun$apply$2.apply(Parsers.scala:254)\n\tat scala.util.parsing.combinator.Parsers$Parser$$anonfun$append$1$$anonfun$apply$2.apply(Parsers.scala:254)\n\tat scala.util.parsing.combinator.Parsers$Failure.append(Parsers.scala:202)\n\tat scala.util.parsing.combinator.Parsers$Parser$$anonfun$append$1.apply(Parsers.scala:254)\n\tat scala.util.parsing.combinator.Parsers$Parser$$anonfun$append$1.apply(Parsers.scala:254)\n\tat scala.util.parsing.combinator.Parsers$$anon$3.apply(Parsers.scala:222)\n\tat scala.util.parsing.combinator.Parsers$$anon$2$$anonfun$apply$14.apply(Parsers.scala:891)\n\tat scala.util.parsing.combinator.Parsers$$anon$2$$anonfun$apply$14.apply(Parsers.scala:891)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:57)\n\tat scala.util.parsing.combinator.Parsers$$anon$2.apply(Parsers.scala:890)\n\tat scala.util.parsing.combinator.PackratParsers$$anon$1.apply(PackratParsers.scala:110)\n\tat org.apache.spark.sql.catalyst.AbstractSparkSQLParser.parse(AbstractSparkSQLParser.scala:34)\n\tat org.apache.spark.sql.hive.HiveQl$.parseSql(HiveQl.scala:290)\n\tat org.apache.spark.sql.hive.HiveQLDialect.parse(HiveContext.scala:62)\n\tat org.apache.spark.sql.SQLContext$$anonfun$3.apply(SQLContext.scala:175)\n\tat org.apache.spark.sql.SQLContext$$anonfun$3.apply(SQLContext.scala:175)\n\tat org.apache.spark.sql.SparkSQLParser$$anonfun$org$apache$spark$sql$SparkSQLParser$$others$1.apply(SparkSQLParser.scala:115)\n\tat org.apache.spark.sql.SparkSQLParser$$anonfun$org$apache$spark$sql$SparkSQLParser$$others$1.apply(SparkSQLParser.scala:114)\n\tat scala.util.parsing.combinator.Parsers$Success.map(Parsers.scala:136)\n\tat scala.util.parsing.combinator.Parsers$Success.map(Parsers.scala:135)\n\tat scala.util.parsing.combinator.Parsers$Parser$$anonfun$map$1.apply(Parsers.scala:242)\n\tat scala.util.parsing.combinator.Parsers$Parser$$anonfun$map$1.apply(Parsers.scala:242)\n\tat scala.util.parsing.combinator.Parsers$$anon$3.apply(Parsers.scala:222)\n\tat scala.util.parsing.combinator.Parsers$Parser$$anonfun$append$1$$anonfun$apply$2.apply(Parsers.scala:254)\n\tat scala.util.parsing.combinator.Parsers$Parser$$anonfun$append$1$$anonfun$apply$2.apply(Parsers.scala:254)\n\tat scala.util.parsing.combinator.Parsers$Failure.append(Parsers.scala:202)\n\tat scala.util.parsing.combinator.Parsers$Parser$$anonfun$append$1.apply(Parsers.scala:254)\n\tat scala.util.parsing.combinator.Parsers$Parser$$anonfun$append$1.apply(Parsers.scala:254)\n\tat scala.util.parsing.combinator.Parsers$$anon$3.apply(Parsers.scala:222)\n\tat scala.util.parsing.combinator.Parsers$$anon$2$$anonfun$apply$14.apply(Parsers.scala:891)\n\tat scala.util.parsing.combinator.Parsers$$anon$2$$anonfun$apply$14.apply(Parsers.scala:891)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:57)\n\tat scala.util.parsing.combinator.Parsers$$anon$2.apply(Parsers.scala:890)\n\tat scala.util.parsing.combinator.PackratParsers$$anon$1.apply(PackratParsers.scala:110)\n\tat org.apache.spark.sql.catalyst.AbstractSparkSQLParser.parse(AbstractSparkSQLParser.scala:34)\n\tat org.apache.spark.sql.SQLContext$$anonfun$2.apply(SQLContext.scala:172)\n\tat org.apache.spark.sql.SQLContext$$anonfun$2.apply(SQLContext.scala:172)\n\tat org.apache.spark.sql.execution.datasources.DDLParser.parse(DDLParser.scala:42)\n\tat org.apache.spark.sql.SQLContext.parseSql(SQLContext.scala:195)\n\tat org.apache.spark.sql.hive.HiveContext.parseSql(HiveContext.scala:292)\n\tat org.apache.spark.sql.SQLContext.sql(SQLContext.scala:725)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$5.apply(DriverLocal.scala:310)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$5.apply(DriverLocal.scala:290)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:244)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:244)\n\tat scala.collection.immutable.List.foreach(List.scala:318)\n\tat scala.collection.TraversableLike$class.map(TraversableLike.scala:244)\n\tat scala.collection.AbstractTraversable.map(Traversable.scala:105)\n\tat com.databricks.backend.daemon.driver.DriverLocal.executeSql(DriverLocal.scala:290)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:162)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$3.apply(DriverWrapper.scala:485)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$3.apply(DriverWrapper.scala:485)\n\tat scala.util.Try$.apply(Try.scala:161)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:482)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:384)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:195)\n\tat java.lang.Thread.run(Thread.java:745)\n\n\tat com.databricks.backend.daemon.driver.DriverLocal.executeSql(DriverLocal.scala:325)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:162)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$3.apply(DriverWrapper.scala:485)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$3.apply(DriverWrapper.scala:485)\n\tat scala.util.Try$.apply(Try.scala:161)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:482)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:384)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:195)\n\tat java.lang.Thread.run(Thread.java:745)\n","startTime":1446772781965,"submitTime":1446772782315,"finishTime":1446772781991,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"dmatrix@comcast.net","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"d07cef05-b110-4d36-884a-8bef1c6b147b","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3661","parent":null,"localVersion":155,"presenceMarks":[],"comments":null,"deltaEvent":"update","sparkCtxId":"3350236377910829590","clusterId":"","clusterMemory":0,"clusterName":"","arguments":{}},{"type":"command","id":3662,"parentId":3596,"deltaVersion":1446753907877,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"b9256732-460d-4044-ab16-4883891f56a8","subtype":"command","commandType":"auto","position":39.6240234375,"command":"%md\n#### **Visualizations and Spark SQL**\n* A visualization appears automatically for the output of a **SQL select** statement in notebooks (no need to call ``display``).","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1434024431785,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"denny@databricks.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"09893350-74c3-4ddc-9d1d-0822f6477fd6","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3662","arguments":{},"parent":null,"localVersion":120,"presenceMarks":[],"comments":null,"deltaEvent":"update","clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3663,"parentId":3596,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"89cad353-2014-4412-8292-077a74fc276b","subtype":"command","commandType":"auto","position":39.62451171875,"command":"%sql select * from PythonTempTable","commandVersion":0,"results":{"type":"table","data":[["vowels","a",105],["consonants","b",25],["consonants","c",30],["consonants","d",45],["vowels","e",55]],"arguments":{},"schema":[{"name":"group","type":"string"},{"name":"key","type":"string"},{"name":"value","type":"bigint"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null},"errorSummary":null,"error":null,"startTime":1446770936008,"submitTime":1446770936322,"finishTime":1446770936218,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"778","height":"272","xColumns":["key","group"],"yColumns":["value"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"dmatrix@comcast.net","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"c92c3b7e-b323-471e-aaed-2412d7abc5c0","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3663","parent":null,"localVersion":95,"presenceMarks":[],"comments":null,"deltaEvent":"update","sparkCtxId":"3350236377910829590","clusterId":"","clusterMemory":0,"clusterName":"","arguments":{}},{"type":"command","id":3664,"parentId":3596,"deltaVersion":1446753907186,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"bf8154af-e85e-4574-a074-a9214da3cb7b","subtype":"command","commandType":"auto","position":39.625,"command":"%md\n&nbsp;\n\n#### ** Persist DataFrames into Tables **\nUse **``saveAsTable``** to persist tables to be used in other notebooks.\n* These table definitions will persist even after cluster restarts.","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1434024450828,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"denny@databricks.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"40f2addf-9b75-4a51-97ab-be8a09c10e22","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3664","arguments":{},"parent":null,"localVersion":98,"presenceMarks":[],"comments":null,"deltaEvent":"update","clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3665,"parentId":3596,"deltaVersion":1446753907828,"running":false,"state":"error","shouldRun":false,"rerunning":false,"stages":[],"guid":"8f0e5030-64a9-4b91-8fb8-9501514b0c95","subtype":"command","commandType":"auto","position":39.734375,"command":"\ndf.write.saveAsTable(\"PythonTestTable\")","commandVersion":0,"results":null,"errorSummary":"java.lang.RuntimeException: Tables created with SQLContext must be TEMPORARY. Use a HiveContext instead.","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">Py4JJavaError</span>                             Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-95-ebddc9449b2e&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>df<span class=\"ansiyellow\">.</span>write<span class=\"ansiyellow\">.</span>saveAsTable<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;PythonTestTable&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/home/ubuntu/databricks/spark/python/pyspark/sql/readwriter.py</span> in <span class=\"ansicyan\">saveAsTable</span><span class=\"ansiblue\">(self, name, format, mode, partitionBy, **options)</span>\n<span class=\"ansigreen\">    368</span>         <span class=\"ansigreen\">if</span> format <span class=\"ansigreen\">is</span> <span class=\"ansigreen\">not</span> None<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    369</span>             self<span class=\"ansiyellow\">.</span>format<span class=\"ansiyellow\">(</span>format<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 370</span><span class=\"ansiyellow\">         </span>self<span class=\"ansiyellow\">.</span>_jwrite<span class=\"ansiyellow\">.</span>saveAsTable<span class=\"ansiyellow\">(</span>name<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    371</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    372</span>     <span class=\"ansiyellow\">@</span>since<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">1.4</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/home/ubuntu/databricks/spark/python/lib/py4j-0.8.2.1-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">    536</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    537</span>         return_value = get_return_value(answer, self.gateway_client,\n<span class=\"ansigreen\">--&gt; 538</span><span class=\"ansiyellow\">                 self.target_id, self.name)\n</span><span class=\"ansigreen\">    539</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    540</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/home/ubuntu/databricks/spark/python/pyspark/sql/utils.py</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     34</span>     <span class=\"ansigreen\">def</span> deco<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     35</span>         <span class=\"ansigreen\">try</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 36</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> f<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     37</span>         <span class=\"ansigreen\">except</span> py4j<span class=\"ansiyellow\">.</span>protocol<span class=\"ansiyellow\">.</span>Py4JJavaError <span class=\"ansigreen\">as</span> e<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     38</span>             s <span class=\"ansiyellow\">=</span> e<span class=\"ansiyellow\">.</span>java_exception<span class=\"ansiyellow\">.</span>toString<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/home/ubuntu/databricks/spark/python/lib/py4j-0.8.2.1-src.zip/py4j/protocol.py</span> in <span class=\"ansicyan\">get_return_value</span><span class=\"ansiblue\">(answer, gateway_client, target_id, name)</span>\n<span class=\"ansigreen\">    298</span>                 raise Py4JJavaError(\n<span class=\"ansigreen\">    299</span>                     <span class=\"ansiblue\">&apos;An error occurred while calling {0}{1}{2}.\\n&apos;</span><span class=\"ansiyellow\">.</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 300</span><span class=\"ansiyellow\">                     format(target_id, &apos;.&apos;, name), value)\n</span><span class=\"ansigreen\">    301</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    302</span>                 raise Py4JError(\n\n<span class=\"ansired\">Py4JJavaError</span>: An error occurred while calling o2297.saveAsTable.\n: java.lang.RuntimeException: Tables created with SQLContext must be TEMPORARY. Use a HiveContext instead.\n\tat scala.sys.package$.error(package.scala:27)\n\tat org.apache.spark.sql.execution.SparkStrategies$DDLStrategy$.apply(SparkStrategies.scala:416)\n\tat org.apache.spark.sql.catalyst.planning.QueryPlanner$$anonfun$1.apply(QueryPlanner.scala:58)\n\tat org.apache.spark.sql.catalyst.planning.QueryPlanner$$anonfun$1.apply(QueryPlanner.scala:58)\n\tat scala.collection.Iterator$$anon$13.hasNext(Iterator.scala:371)\n\tat org.apache.spark.sql.catalyst.planning.QueryPlanner.plan(QueryPlanner.scala:59)\n\tat org.apache.spark.sql.SQLContext$QueryExecution.sparkPlan$lzycompute(SQLContext.scala:926)\n\tat org.apache.spark.sql.SQLContext$QueryExecution.sparkPlan(SQLContext.scala:924)\n\tat org.apache.spark.sql.SQLContext$QueryExecution.executedPlan$lzycompute(SQLContext.scala:930)\n\tat org.apache.spark.sql.SQLContext$QueryExecution.executedPlan(SQLContext.scala:930)\n\tat org.apache.spark.sql.SQLContext$QueryExecution.toRdd$lzycompute(SQLContext.scala:933)\n\tat org.apache.spark.sql.SQLContext$QueryExecution.toRdd(SQLContext.scala:933)\n\tat org.apache.spark.sql.DataFrameWriter.saveAsTable(DataFrameWriter.scala:228)\n\tat org.apache.spark.sql.DataFrameWriter.saveAsTable(DataFrameWriter.scala:198)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:497)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:231)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:379)\n\tat py4j.Gateway.invoke(Gateway.java:259)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:133)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:207)\n\tat java.lang.Thread.run(Thread.java:745)\n\n</div>","startTime":1446772746027,"submitTime":1446772746027,"finishTime":1446772746128,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"dmatrix@comcast.net","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"d5174f94-c981-49d1-8713-eab68f0db39e","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3665","parent":null,"localVersion":112,"presenceMarks":[],"comments":null,"deltaEvent":"update","sparkCtxId":"3350236377910829590","clusterId":"","clusterMemory":0,"clusterName":"","arguments":{}},{"type":"command","id":3666,"parentId":3596,"deltaVersion":1446753907832,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"576ceb60-9052-4613-af12-67c5c40c1cc8","subtype":"command","commandType":"auto","position":39.7421875,"command":"%md\n***\n![Quick Note](http://training.databricks.com/databricks_guide/icon_note3_s.png) For more information on working with Python and Spark SQL, please refer to [Spark SQL Programming Guide](https://spark.apache.org/docs/latest/sql-programming-guide.html)\n***","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1435791110053,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"vida","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"5ddb07be-d23b-41d5-8834-0cce4786aaa6","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3666","arguments":{},"parent":null,"localVersion":104,"presenceMarks":[],"comments":null,"deltaEvent":"update","clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3667,"parentId":3596,"deltaVersion":1446753907188,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"358f2936-a2e2-4e3c-a2d6-ba13a77f8e94","subtype":"command","commandType":"auto","position":40.75,"command":"%md\n### ** Display HTML **\nDisplay HTML within your notebook, using the **displayHTML** command.","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1435791102755,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"vida","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"38f98d2b-0ca9-4223-b228-d5fe97dbfd75","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3667","arguments":{},"parent":null,"localVersion":96,"presenceMarks":[],"comments":null,"deltaEvent":"update","clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":3668,"parentId":3596,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"743f1bcb-d34d-4a9f-b348-e1a9f7617ba0","subtype":"command","commandType":"auto","position":41.75,"command":"displayHTML(\"<h3 style=\\\"color:blue\\\">Blue Text</h3>\")","commandVersion":0,"results":{"type":"htmlSandbox","data":"<h3 style=\"color:blue\">Blue Text</h3>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1446771026058,"submitTime":1446771026371,"finishTime":1446771026136,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"dmatrix@comcast.net","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"64dd518b-3421-4ec7-bec9-8dfee8d3b18b","globalVars":{},"iPythonMetadata":null,"path":"/1/3593/3596/3668","parent":null,"localVersion":94,"presenceMarks":[],"comments":null,"deltaEvent":"update","sparkCtxId":"3350236377910829590","clusterId":"","clusterMemory":0,"clusterName":"","arguments":{}},{"type":"command","commandText":"","position":42.75,"guid":"510e9699-dfc2-4c3b-b592-e299ba314463","lastModifiedBy":"","parent":null,"deltaVersion":-1,"localVersion":13,"running":false,"state":"input","shouldRun":false,"rerunning":false,"stages":[],"commandType":"auto","command":"","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"presenceMarks":[],"comments":null,"path":"/1/3593/3596/3672","subtype":"command","customPlotOptions":{},"iPythonMetadata":null,"pivotAggregation":null,"nuid":"9905e4fc-ed98-42b3-9040-4426ed7d2541","id":3672,"inputWidgets":{},"deltaEvent":"create","latestUser":"","parentId":3596,"globalVars":{},"clusterId":"","clusterName":"","clusterMemory":0},{"type":"dashboardV2","id":3597,"parentId":3596,"defaultSize":{"width":1024,"height":768},"guid":"263930c6-e687-4a29-993a-48aef8acd15c","globalVars":{},"path":"/1/3593/3596/3597","parent":null,"nuid":"bb07effc-717f-4ace-b762-b864c2ffdb4b","presenceMarks":[]},{"type":"command","commandText":"","position":12.0682373046875,"guid":"b9a8c99c-dea6-4807-8958-f79de2446f54","lastModifiedBy":"","parent":null,"deltaVersion":1446753907884,"localVersion":51,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"commandType":"auto","command":"display(dfp)","commandVersion":0,"results":{"overflow":false,"data":[[32,"San Francisco",1,"Jules Damji","advocate"],[42,"London",2,"Arther Dent","Hitch-hiker"],[2009,"Milkyway",3,"Zaphod Beeblebrox","Wiseman"],[55,"Essex",4,"Ford Prefect","Realtor"],[2005,"Andromeda",5,"Trillian","Space Traveler"],[1000,"M33",6,"Slartibarfast","Creator"],[4500,"X33",7,"Random Dent","Invisble Hand"]],"plotOptions":null,"aggType":"","aggSchema":[],"schema":[{"name":"age","type":"bigint"},{"name":"city","type":"string"},{"name":"key","type":"bigint"},{"name":"name","type":"string"},{"name":"occupation","type":"string"}],"aggError":"","aggData":[],"type":"table","aggOverflow":false,"aggSeriesLimitReached":false,"arguments":{}},"errorSummary":null,"error":null,"startTime":1446772549248,"submitTime":1446772549598,"finishTime":1446772549637,"collapsed":false,"bindings":{},"displayType":"barChart","width":660,"height":"auto","xColumns":["name","age"],"yColumns":["key","<id>"],"pivotColumns":[],"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"presenceMarks":[],"comments":null,"path":"/1/3593/3596/3673","subtype":"command","customPlotOptions":{"barChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}]},"iPythonMetadata":null,"pivotAggregation":"sum","nuid":"fa9cf1ec-384a-49be-a812-73c901da598f","id":3673,"inputWidgets":{},"deltaEvent":"update","latestUser":"dmatrix@comcast.net","parentId":3596,"globalVars":{},"sparkCtxId":"3350236377910829590","clusterId":"","clusterMemory":0,"clusterName":"","arguments":{}},{"type":"command","commandText":"","position":39.623291015625,"guid":"54fe515d-5af8-442e-8630-c49182ed106f","lastModifiedBy":"","parent":null,"deltaVersion":1446753907859,"localVersion":62,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"commandType":"auto","command":"dfp.registerTempTable(\"PeopleTable\")","commandVersion":0,"results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"plotOptions":null},"errorSummary":"<span class=\"ansired\">TypeError</span>: saveAsTable() takes at least 2 arguments (1 given)","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">TypeError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-94-9f795635f552&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> dfp<span class=\"ansiyellow\">.</span>registerTempTable<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;PeopleTable&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span>dfp<span class=\"ansiyellow\">.</span>saveAsTable<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">TypeError</span>: saveAsTable() takes at least 2 arguments (1 given)\n</div>","startTime":1446772789777,"submitTime":1446772790133,"finishTime":1446772789805,"collapsed":false,"bindings":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"presenceMarks":[],"comments":null,"path":"/1/3593/3596/3675","subtype":"command","customPlotOptions":{},"iPythonMetadata":null,"pivotAggregation":null,"nuid":"b1139100-c14b-4162-a815-3f3aaa7c0bc7","id":3675,"inputWidgets":{},"deltaEvent":"update","latestUser":"dmatrix@comcast.net","parentId":3596,"globalVars":{},"sparkCtxId":"3350236377910829590","clusterId":"","clusterMemory":0,"clusterName":"","arguments":{}}];</script>

<script src="https://databricks-prod-cloudfront.cloud.databricks.com/static/201511031715010800-b38c68475dfc920d015b8b9c64a2676d63f65035/notebook-main.js" onerror="window.mainJsLoadError=true"></script>
</head>
<body>

<script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/201511031715010800-b38c68475dfc920d015b8b9c64a2676d63f65035/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = '<h1>Network Error</h1><p><b>Please check your network connection and try again.</b></p><p>Could not load a required resource: ' + u + '</p>';
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
};
</script>
</body>
</html>