<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>IoTDeviceGeoIPDS - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">
<link rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201603140314360000-85b1fe2c3d05a7f47c2b46cddec3c14867c62d86/lib/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201603140314360000-85b1fe2c3d05a7f47c2b46cddec3c14867c62d86/lib/jquery-ui-bundle/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201603140314360000-85b1fe2c3d05a7f47c2b46cddec3c14867c62d86/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201603140314360000-85b1fe2c3d05a7f47c2b46cddec3c14867c62d86/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201603140314360000-85b1fe2c3d05a7f47c2b46cddec3c14867c62d86/img/favicon.ico"/>
<script>window.settings = {"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","workspaceFeaturedLinks":[{"linkURI":"https://docs.cloud.databricks.com/docs/latest/databricks_guide/index.html","displayName":"Databricks Guide","icon":"question"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/sample_applications/index.html","displayName":"Application Examples","icon":"code"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/courses/index.html","displayName":"Training","icon":"graduation-cap"}],"sparkDocsSearchGoogleCx":"004588677886978090460:_rj0wilqwdm","dbcForumURL":"http://forums.databricks.com/","dbfsS3Host":"https://databricks-prod-storage-oregon.s3.amazonaws.com","nodeInfo":{"node_types":[{"spark_heap_memory":4800,"instance_type_id":"r3.2xlarge","spark_core_oversubscription_factor":3.0,"node_type_id":"dev-tier-node","description":"Community Optimized","container_memory_mb":6000,"memory_mb":6144,"num_cores":0.88}],"default_node_type_id":"dev-tier-node"},"enableThirdPartyApplicationsUI":false,"enableClusterAcls":false,"notebookRevisionVisibilityHorizon":6,"enableTableHandler":true,"isAdmin":true,"enableLargeResultDownload":true,"zoneInfos":[{"id":"us-west-2c","isDefault":true},{"id":"us-west-2b","isDefault":false},{"id":"us-west-2a","isDefault":false}],"nameAndEmail":"Jules Damji (jules.damji@gmail.com)","enablePublishNotebooks":true,"enableFullTextSearch":false,"enableElasticSparkUI":false,"clusters":true,"allowRunOnPendingClusters":true,"hideOffHeapCache":false,"applications":false,"useStaticGuide":true,"fileStoreBase":"FileStore","configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableResetPassword":true,"enableJobsSparkUpgrade":true,"sparkVersions":[{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1)","packageLabel":"spark-1.3-jenkins-ip-10-30-10-144-U85b1fe2c3d-Sa2ee4664b2-2016-03-14-18:46:30.567151","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1)","packageLabel":"spark-1.4-jenkins-ip-10-30-10-144-U85b1fe2c3d-S9c254ab12a-2016-03-14-18:46:30.567151","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1)","packageLabel":"spark-1.5-jenkins-ip-10-30-10-144-U85b1fe2c3d-S9ca52d000d-2016-03-14-18:46:30.567151","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-1.6.0-jenkins-ip-10-30-10-144-U85b1fe2c3d-Sf90f83597b-2016-03-14-18:46:30.567151","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-1.6.1-hadoop1-jenkins-ip-10-30-10-144-U85b1fe2c3d-S91a12bb288-2016-03-14-18:46:30.567151","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-1.6.1-hadoop2-jenkins-ip-10-30-10-144-U85b1fe2c3d-S91a12bb288-2016-03-14-18:46:30.567151","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-1.6.1-hadoop1-jenkins-ip-10-30-10-144-U85b1fe2c3d-S91a12bb288-2016-03-14-18:46:30.567151","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-1.6.1-hadoop1-jenkins-ip-10-30-10-144-U85b1fe2c3d-S91a12bb288-2016-03-14-18:46:30.567151","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-1.6.1-hadoop2-jenkins-ip-10-30-10-144-U85b1fe2c3d-S91a12bb288-2016-03-14-18:46:30.567151","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"master","displayName":"Spark master (dev)","packageLabel":"","upgradable":true,"deprecated":false,"customerVisible":false}],"enableRestrictedClusterCreation":true,"enableFeedback":true,"defaultNumWorkers":0,"defaultZoneId":"us-west-2c","serverContinuationTimeoutMillis":10000,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":false,"driverStdoutFilePrefix":"stdout","enableSparkDocsSearch":true,"prefetchSidebarNodes":true,"sparkHistoryServerEnabled":true,"sanitizeMarkdownHtml":true,"enableIPythonImportExport":true,"enableNotebookHistoryDiffing":true,"branch":"2.15-rc3","accountsLimit":3,"enableNotebookGitBranching":true,"local":false,"enableStrongPassword":false,"displayDefaultContainerMemoryGB":6,"devTierHomepageDesign":"control","deploymentMode":"production","useSpotForWorkers":true,"enableUserInviteWorkflow":true,"enableStaticNotebooks":true,"dbcGuideURL":"#workspace/databricks_guide/00 Welcome to Databricks","enableCssTransitions":true,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterAclsConfig":false,"orgId":8599738367597028,"enableNotebookGitVersioning":true,"files":"files/","enableAutoScaledClusterSelection":true,"enableDriverLogsUI":true,"disableLegacyDashboards":true,"enableWorkspaceAclsConfig":false,"dropzoneMaxFileSize":4096,"enableNewDashboardViews":true,"driverLog4jFilePrefix":"log4j","enableMavenLibraries":true,"displayRowLimit":1000,"defaultSparkVersion":{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-1.6.0-jenkins-ip-10-30-10-144-U85b1fe2c3d-Sf90f83597b-2016-03-14-18:46:30.567151","upgradable":true,"deprecated":false,"customerVisible":true},"enableMountAclsConfig":false,"clusterPublisherRootId":3343418796473382,"enableLatestJobRunResultPermalink":true,"disallowAddingAdmins":true,"enableSparkConfUI":true,"enableOrgSwitcherUI":true,"clustersLimit":1,"enableJdbcImport":true,"logfiles":"logfiles/","enableWebappSharding":false,"enableClusterDeltaUpdates":true,"csrfToken":"64d99a59-8430-49f9-9af9-42f8496611e9","useFixedStaticNotebookVersionForDevelopment":false,"enableMountAcls":false,"requireEmailUserName":true,"enableDashboardViews":false,"dbcFeedbackURL":"http://feedback.databricks.com/forums/263785-product-feedback","enableMountAclService":true,"enableWorkspaceAclService":true,"someName":"Jules Damji","enableWorkspaceAcls":false,"gitHash":"85b1fe2c3d05a7f47c2b46cddec3c14867c62d86","showWorkspaceFeaturedLinks":true,"userFullname":"Jules Damji","allowFeedbackForumAccess":true,"enableImportFromUrl":true,"enableMiniClusters":true,"enableWebSocketDeltaUpdates":true,"showDevTierBetaVersion":true,"enableDebugUI":false,"showHiddenSparkVersions":false,"allowNonAdminUsers":true,"userId":3601578643761083,"dbcSupportURL":"","staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/201603140314360000-85b1fe2c3d05a7f47c2b46cddec3c14867c62d86/","enableSparkPackages":true,"enableHybridClusterType":false,"enableNotebookHistoryUI":true,"availableWorkspaces":[{"name":"Dmatrix Inc.","needsConfirmation":false,"orgId":8599738367597028,"owner":"jules.damji@gmail.com"}],"enableFolderHtmlExport":true,"enableSparkVersionsUI":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.cloud.databricks.com/docs/latest/featured_notebooks/1%20QuickStart%20Notebooks%20(Python).html","displayName":"Getting Started","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/featured_notebooks/3%20QuickStart%20DataFrames%20(Scala).html","displayName":"Introduction to DataFrames","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/featured_notebooks/DecisionTrees-Example.html","displayName":"Decision Trees in Spark","icon":"img/home/Scala_icon.svg"}],"databricksGuideStaticUrl":"https://docs.cloud.databricks.com/docs/latest/databricks_guide","enableHybridClusters":true,"upgradeURL":"https://accounts.cloud.databricks.com/registration.html","clusterManagerAclsEnabled":false,"notebookLoadingBackground":"#fff","enableNewJobRunDetailsPage":true,"user":"jules.damji@gmail.com","enableServerAutoComplete":true,"enableStaticHtmlImport":true,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"tablesPublisherRootId":3343418796473381,"enableNewInputWidgetUI":false,"accounts":true,"useFramedStaticNotebooks":true,"enableNewProgressReportUI":true,"defaultCoresPerContainer":4};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":2012071946276838,"name":"IoTDeviceGeoIPDS","language":"scala","commands":[{"version":"CommandV1","origId":922964923687096,"guid":"35ed77d6-b32b-4fa2-8d95-570a7ff83cde","subtype":"command","commandType":"auto","position":0.5,"command":"import main.scala._\nimport main.scala.DeviceIoTData\nimport org.apache.spark.{SparkContext, SparkConf}\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import main.scala._\nimport main.scala.DeviceIoTData\nimport org.apache.spark.{SparkContext, SparkConf}\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:31: error: object DeviceIoTData is not a member of package main.scala\n       import main.scala.DeviceIoTData\n              ^\n</div>","error":null,"workflows":[],"startTime":1.458173351131E12,"submitTime":1.458173346701E12,"finishTime":1.458173352625E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jules.damji@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"8a629577-4c66-4f1f-9e72-5b42ca269971"},{"version":"CommandV1","origId":922964923687098,"guid":"5e18c113-ac3c-4bcf-a632-4a556cfc3b5f","subtype":"command","commandType":"auto","position":0.875,"command":"%md Use the case class so that we can use a Dataset and Dataframe interchangably\nCase class for mapping to a Dataset for the JSON {\"device_id\": 198164, \"device_name\": \"sensor-pad-198164owomcJZ\", \"ip\": \"80.55.20.25\", \"cca2\": \"PL\", \"cca3\": \"POL\", \"cn\": \"Poland\", \"latitude\": 53.080000, \"longitude\": 18.620000, \"scale\": \"Celius\", \"temp\": 21, \"humidity\": 65, \"battery_level\": 8, \"c02_level\": 1408, \"lcd\": \"red\", \"timestamp\" :1458081226051 }\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">defined class DeviceIotData\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.45809003001E12,"submitTime":1.458090029519E12,"finishTime":1.458090030445E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jules.damji@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"99e8975d-8718-4467-8e1a-b0f57e1af5e9"},{"version":"CommandV1","origId":2012071946276840,"guid":"d94460b7-0e81-4a8a-8403-c0dfc05daaee","subtype":"command","commandType":"auto","position":1.0,"command":"\n//fetch the JSON device information uploaded into the Filestore\nval jsonFile = \"/FileStore/tables/hll2y8jf1458081917577/iot_devices.json\"\n\n//read the json file and create the dataset using the case class\nval ds = sqlContext.read.json(jsonFile).as[DeviceIoTData]\n\n//show Dataset's first 20 rows\nds.show(5)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---------+--------------------+-------------+----+----+-------------+--------+---------+------+----+--------+-------------+---------+------+-------------+\n|device_id|         device_name|           ip|cca2|cca3|           cn|latitude|longitude| scale|temp|humidity|battery_level|c02_level|   lcd|    timestamp|\n+---------+--------------------+-------------+----+----+-------------+--------+---------+------+----+--------+-------------+---------+------+-------------+\n|        1|meter-gauge-1C4Gf...| 68.161.225.1|  US| USA|United States|    38.0|    -97.0|Celius|  16|      52|            1|     1519|   red|1458081219484|\n|        2| sensor-pad-2rqK95fI|213.161.254.1|  NO| NOR|       Norway|   62.47|     6.15|Celius|  16|      83|            9|     1467|   red|1458081219509|\n|        3|device-mac-3o6Nyu...|    88.36.5.1|  IT| ITA|        Italy|   42.83|    12.83|Celius|  31|      61|            9|     1563|   red|1458081219510|\n|        4|  sensor-pad-4YF1Vmz|66.39.173.154|  US| USA|United States|   44.06|  -121.32|Celius|  22|      73|            4|     1578|   red|1458081219511|\n|        5|therm-stick-5XnZG...|  203.82.41.9|  PH| PHL|  Philippines|   14.58|   120.97|Celius|  10|      26|            4|     1044|yellow|1458081219511|\n+---------+--------------------+-------------+----+----+-------------+--------+---------+------+----+--------+-------------+---------+------+-------------+\nonly showing top 5 rows\n\njsonFile: String = /FileStore/tables/hll2y8jf1458081917577/iot_devices.json\nds: org.apache.spark.sql.Dataset[main.scala.DeviceIoTData] = [device_id: bigint, device_name: string, ip: string, cca2: string, cca3: string, cn: string, latitude: double, longitude: double, scale: string, temp: bigint, humidity: bigint, battery_level: bigint, c02_level: bigint, lcd: string, timestamp: bigint]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 5.0 failed 1 times, most recent failure: Lost task 0.0 in stage 5.0 (TID 8, localhost): java.lang.IllegalStateException: unread block data","error":"<div class=\"ansiout\">\tat java.io.ObjectInputStream$BlockDataInputStream.setBlockDataMode(ObjectInputStream.java:2431)\n\tat java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1383)\n\tat java.io.ObjectInputStream.defaultReadFields(ObjectInputStream.java:2000)\n\tat java.io.ObjectInputStream.readSerialData(ObjectInputStream.java:1924)\n\tat java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1801)\n\tat java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1351)\n\tat java.io.ObjectInputStream.readObject(ObjectInputStream.java:371)\n\tat org.apache.spark.serializer.JavaDeserializationStream.readObject(JavaSerializer.scala:76)\n\tat org.apache.spark.serializer.JavaSerializerInstance.deserialize(JavaSerializer.scala:115)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:194)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:745)\n\nDriver stacktrace:\n\tat org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1431)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1419)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1418)\n\tat scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:47)\n\tat org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:1418)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:799)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:799)\n\tat scala.Option.foreach(Option.scala:236)\n\tat org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:799)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1640)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1599)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1588)\n\tat org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:620)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1835)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1955)\n\tat org.apache.spark.rdd.RDD$$anonfun$reduce$1.apply(RDD.scala:1025)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:150)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:111)\n\tat org.apache.spark.rdd.RDD.withScope(RDD.scala:316)\n\tat org.apache.spark.rdd.RDD.reduce(RDD.scala:1007)\n\tat org.apache.spark.rdd.RDD$$anonfun$treeAggregate$1.apply(RDD.scala:1150)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:150)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:111)\n\tat org.apache.spark.rdd.RDD.withScope(RDD.scala:316)\n\tat org.apache.spark.rdd.RDD.treeAggregate(RDD.scala:1127)\n\tat org.apache.spark.sql.execution.datasources.json.InferSchema$.infer(InferSchema.scala:65)\n\tat org.apache.spark.sql.execution.datasources.json.JSONRelation$$anonfun$4.apply(JSONRelation.scala:114)\n\tat org.apache.spark.sql.execution.datasources.json.JSONRelation$$anonfun$4.apply(JSONRelation.scala:109)\n\tat scala.Option.getOrElse(Option.scala:120)\n\tat org.apache.spark.sql.execution.datasources.json.JSONRelation.dataSchema$lzycompute(JSONRelation.scala:109)\n\tat org.apache.spark.sql.execution.datasources.json.JSONRelation.dataSchema(JSONRelation.scala:108)\n\tat org.apache.spark.sql.sources.HadoopFsRelation.schema$lzycompute(interfaces.scala:636)\n\tat org.apache.spark.sql.sources.HadoopFsRelation.schema(interfaces.scala:635)\n\tat org.apache.spark.sql.execution.datasources.LogicalRelation.&lt;init&gt;(LogicalRelation.scala:37)\n\tat org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:125)\n\tat org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:109)\n\tat org.apache.spark.sql.DataFrameReader.json(DataFrameReader.scala:244)\nCaused by: java.lang.IllegalStateException: unread block data\n\tat java.io.ObjectInputStream$BlockDataInputStream.setBlockDataMode(ObjectInputStream.java:2431)\n\tat java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1383)\n\tat java.io.ObjectInputStream.defaultReadFields(ObjectInputStream.java:2000)\n\tat java.io.ObjectInputStream.readSerialData(ObjectInputStream.java:1924)\n\tat java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1801)\n\tat java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1351)\n\tat java.io.ObjectInputStream.readObject(ObjectInputStream.java:371)\n\tat org.apache.spark.serializer.JavaDeserializationStream.readObject(JavaSerializer.scala:76)\n\tat org.apache.spark.serializer.JavaSerializerInstance.deserialize(JavaSerializer.scala:115)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:194)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:745)</div>","workflows":[],"startTime":1.45817336127E12,"submitTime":1.458173356836E12,"finishTime":1.458173366089E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jules.damji@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"e08467fd-1bc8-4e70-b498-ec0dffe9cd3f"},{"version":"CommandV1","origId":922964923687095,"guid":"36c07c1a-9110-4ad3-a825-8f4fc97cb1bb","subtype":"command","commandType":"auto","position":1.5,"command":"//issue select, map, filter, foreach operations on the datasets, just as you would for Dataframes\n// convert the dataset to dataframe and use simple column name select() method.\nds.toDF().select(\"device_name\", \"device_id\", \"temp\", \"humidity\").orderBy($\"temp\").show(10)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+--------------------+---------+----+--------+\n|         device_name|device_id|temp|humidity|\n+--------------------+---------+----+--------+\n|therm-stick-99785...|    99785|  10|      53|\n|meter-gauge-10015...|   100151|  10|      76|\n|sensor-pad-998120...|    99812|  10|      33|\n|meter-gauge-99469...|    99469|  10|      71|\n|sensor-pad-998643...|    99864|  10|      80|\n|device-mac-99741f...|    99741|  10|      86|\n|sensor-pad-99868o...|    99868|  10|      70|\n|sensor-pad-99632l...|    99632|  10|      31|\n|meter-gauge-99913...|    99913|  10|      40|\n|meter-gauge-99671...|    99671|  10|      64|\n+--------------------+---------+----+--------+\nonly showing top 10 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:90: error: not found: value $temp\n              ds.toDF().select(&quot;device_name&quot;, &quot;device_id&quot;, &quot;temp&quot;, &quot;humidity&quot;).orderBy($temp).show(10)\n                                                                                       ^\n</div>","error":null,"workflows":[],"startTime":1.458173386188E12,"submitTime":1.458173381755E12,"finishTime":1.458173387695E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jules.damji@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"261c6421-cc95-4e6e-81b3-29c7b8e8810d"},{"version":"CommandV1","origId":922964923687099,"guid":"5c7ee8e4-f1c3-42d9-bdbb-1d7201d9600a","subtype":"command","commandType":"auto","position":1.75,"command":"//filter out dataset rows that meet the temperature and humimdity predicate\nval dsFilter = ds.filter (d => {d.temp > 30 && d.humidity > 70})\ndsFilter.show(10)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---------+--------------------+---------------+----+----+-----------------+--------+---------+------+----+--------+-------------+---------+------+-------------+\n|device_id|         device_name|             ip|cca2|cca3|               cn|latitude|longitude| scale|temp|humidity|battery_level|c02_level|   lcd|    timestamp|\n+---------+--------------------+---------------+----+----+-----------------+--------+---------+------+----+--------+-------------+---------+------+-------------+\n|       29|meter-gauge-29FRd...|   83.98.224.49|  NL| NLD|      Netherlands|   52.37|      4.9|Celius|  33|      99|            5|      921| green|1458081219527|\n|       47|meter-gauge-47CoY...|195.178.145.209|  UA| UKR|          Ukraine|   50.45|    30.52|Celius|  31|      79|            1|     1272|yellow|1458081219540|\n|       49|meter-gauge-49Vg2...|   170.37.224.1|  US| USA|    United States|   42.28|   -71.44|Celius|  31|      81|            8|      972| green|1458081219542|\n|       53| meter-gauge-53CfWFw|   80.89.168.34|  SE| SWE|           Sweden|   59.33|    18.07|Celius|  34|      92|            2|     1323|yellow|1458081219545|\n|       75|device-mac-75xUEy...| 143.161.246.65|  AT| AUT|          Austria|    48.2|    16.37|Celius|  33|      83|            1|     1448|   red|1458081219557|\n|       95|therm-stick-95EgQ...| 200.25.144.102|  EC| ECU|          Ecuador|   -2.17|    -79.9|Celius|  34|      72|            7|     1440|   red|1458081219567|\n|      127|meter-gauge-127gn...|  219.103.112.2|  JP| JPN|            Japan|   35.69|   139.69|Celius|  34|      76|            5|      978| green|1458081219587|\n|      139|meter-gauge-139Hc...|    61.247.94.1|  KR| KOR|Republic of Korea|   37.29|   127.01|Celius|  34|      91|            5|      892| green|1458081219594|\n|      157|meter-gauge-157OD...|  83.146.16.226|  GB| GBR|   United Kingdom|    51.5|    -0.13|Celius|  32|      98|            7|     1310|yellow|1458081219603|\n|      170|sensor-pad-1702Wf...|   212.87.11.82|  PL| POL|           Poland|   52.25|     21.0|Celius|  34|      94|            6|     1550|   red|1458081219609|\n+---------+--------------------+---------------+----+----+-----------------+--------+---------+------+----+--------+-------------+---------+------+-------------+\nonly showing top 10 rows\n\ndsFilter: org.apache.spark.sql.Dataset[main.scala.DeviceIoTData] = [device_id: bigint, device_name: string, ip: string, cca2: string, cca3: string, cn: string, latitude: double, longitude: double, scale: string, temp: bigint, humidity: bigint, battery_level: bigint, c02_level: bigint, lcd: string, timestamp: bigint]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.458173394176E12,"submitTime":1.458173389738E12,"finishTime":1.45817339488E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jules.damji@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"112f847b-00a6-4c3e-add1-69e20631f822"},{"version":"CommandV1","origId":1950784138661604,"guid":"db95a56b-7e00-45c6-a03e-2ac48b9c522f","subtype":"command","commandType":"auto","position":1.78125,"command":"%md Define a function we can use to log battery replacements for devices.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"7ecd7a77-7eb5-41e0-b12d-6e56c780c644"},{"version":"CommandV1","origId":1146492938652307,"guid":"aab45764-7986-43e4-be93-ad71e3543dde","subtype":"command","commandType":"auto","position":1.8125,"command":"def logBatteryReplacement(log: java.io.PrintStream = Console.out, row: org.apache.spark.sql.Row): Unit = {\nval message = \"[***ALERT***: BATTERY NEEDS REPLACEMENT: device_name: %s; device_id: %s ; cca3: %s]\" format(row(0), row(1), row(2))\n  log.println(message)\n}","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">logBatteryReplacement: (log: java.io.PrintStream, row: org.apache.spark.sql.Row)Unit\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:36: error: not found: value dn\n       val message = &quot;[***ALERT***: BATTERY NEEDS REPLACEMENT: device_name: %s; device_id: %s ; cca3: %s]&quot; format(dn, id, cca3)\n                                                                                                                  ^\n</div>","error":null,"workflows":[],"startTime":1.458174060085E12,"submitTime":1.458174055633E12,"finishTime":1.458174060179E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jules.damji@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"640da50c-73f3-48e2-9583-65fe81703d82"},{"version":"CommandV1","origId":922964923687106,"guid":"c40544e3-3005-4d91-9307-18d28ec45f5a","subtype":"command","commandType":"auto","position":1.84375,"command":"//filter dataset rows with battery level == 0 and apply our defined funcion to each element to log an alert.\nval dsBatteryZero = ds.filter (d => {d.battery_level == 0}).toDF().select(\"device_name\", \"device_id\", \"cca3\")\ndsBatteryZero.foreach(d => logBatteryReplacement(Console.err, d))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">dsBatteryZero: org.apache.spark.sql.DataFrame = [device_name: string, device_id: bigint, cca3: string]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:47: error: type mismatch;\n found   : Any\n required: String\n              dsBatteryZero.foreach(d =&gt; logBatteryReplacement(Console.out, d(0), d(1), d(2)))\n                                                                             ^\n</div>","error":null,"workflows":[],"startTime":1.458174112749E12,"submitTime":1.458174108295E12,"finishTime":1.458174114395E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jules.damji@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"c80ff05c-3448-4007-b361-88d365552f19"},{"version":"CommandV1","origId":1950784138661605,"guid":"82eb7a5d-2396-460b-b370-53256f669014","subtype":"command","commandType":"auto","position":1.859375,"command":"%md Let's appy a more sophisticated query on the dataset","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"2cfdf73e-ee08-4f0e-a8ab-4e63e00f19d0"},{"version":"CommandV1","origId":922964923687103,"guid":"043b6278-a6c4-45bf-a541-4c1dd0033bbb","subtype":"command","commandType":"auto","position":1.875,"command":"// apply filter, convert to datafream, groupBy, and compute average\nval dsGroupBy = ds.filter (d => {d.temp > 30 && d.humidity > 70}).toDF().groupBy($\"cca3\").avg(\"temp\")\ndsGroupBy.show(10)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+----+------------------+\n|cca3|         avg(temp)|\n+----+------------------+\n| GRC| 32.74074074074074|\n| DNK| 32.54430379746835|\n| TUR| 32.24242424242424|\n| BEL| 32.03448275862069|\n| GRD|              32.0|\n| SGP| 32.65151515151515|\n| JOR|              32.5|\n| CZE| 32.56976744186046|\n| GEO|32.666666666666664|\n| GRL|              32.0|\n+----+------------------+\nonly showing top 10 rows\n\ndsGroupBy: org.apache.spark.sql.DataFrame = [cca3: string, avg(temp): double]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:90: error: not found: value foreach\n              ds.filter (d =&gt; {d.temp &gt; 30 &amp;&amp; d.humidity &gt; 70}).toDF().groupBy($&quot;cca3&quot;).avg(&quot;temp&quot;).map(foreach(println(_)))\n                                                                                                        ^\n</div>","error":null,"workflows":[],"startTime":1.45817413901E12,"submitTime":1.458174134546E12,"finishTime":1.458174140962E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jules.damji@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"6fee31ea-dc8c-419a-93e1-a717e8dfa07c"},{"version":"CommandV1","origId":922964923687108,"guid":"1cc3e641-9937-4b2e-8911-953060e4c660","subtype":"command","commandType":"auto","position":1.90625,"command":"%md Save the Dataset as a temporary table and issue SQL queires against it.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"c642afd0-82fd-4442-9e00-7962e2afb185"},{"version":"CommandV1","origId":922964923687107,"guid":"96426798-9703-42a5-90e8-b0f0d5b703bf","subtype":"command","commandType":"auto","position":1.9375,"command":"ds.toDF().registerTempTable(\"iot_device_data\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:41: error: value registerTempTable is not a member of org.apache.spark.sql.Dataset[main.scala.DeviceIoTData]\n              ds.registerTempTable(&quot;iot_device_data&quot;)\n                 ^\n</div>","error":null,"workflows":[],"startTime":1.458174283013E12,"submitTime":1.458174278552E12,"finishTime":1.458174283088E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jules.damji@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"befdf0b7-d06b-4fc4-841f-53371f934c00"},{"version":"CommandV1","origId":2012071946276842,"guid":"1bb1b970-9341-4caf-983a-a21193fdae6b","subtype":"command","commandType":"auto","position":2.0,"command":"%sql select cca3, count(distinct device_id) as device_id from iot_device_data group by cca3 order by device_id desc limit 1000","commandVersion":0,"state":"finished","results":{"type":"table","data":[["USA",70405.0],["CHN",14455.0],["JPN",12100.0],["KOR",11879.0],["DEU",7942.0],["GBR",6486.0],["CAN",6041.0],["RUS",5989.0],["FRA",5305.0],["BRA",3224.0],["AUS",3119.0],["ITA",2915.0],["SWE",2880.0],["POL",2744.0],["NLD",2488.0],["ESP",2310.0],["TWN",2128.0],["IND",1867.0],["CZE",1507.0],["NOR",1487.0],["AUT",1462.0],["UKR",1448.0],["HKG",1428.0],["BGR",1334.0],["CHE",1321.0],["MEX",1214.0],["DNK",1190.0],["ROU",1151.0],["SGP",1076.0],["ARG",978.0],["THA",947.0],["IDN",811.0],["HUN",772.0],["MYS",726.0],["ISR",710.0],["FIN",694.0],["PHL",681.0],["TUR",681.0],["BEL",666.0],["ZAF",560.0],["NZL",457.0],["PRT",450.0],["IRL",446.0],["COL",423.0],["GRC",418.0],["CHL",371.0],["LVA",358.0],["IRN",336.0],["LTU",312.0],["SVK",305.0],["SVN",281.0],["PAK",256.0],["SRB",255.0],["PRI",253.0],["VNM",246.0],["ECU",242.0],["EGY",241.0],["KAZ",228.0],["HRV",193.0],["EST",190.0],["VEN",190.0],["BGD",153.0],["SAU",136.0],["PAN",127.0],["ARE",123.0],["BLR",123.0],["KWT",120.0],["URY",117.0],["PER",116.0],["CRI",116.0],["BOL",108.0],["BIH",106.0],["KEN",96.0],["GEO",95.0],["CYP",93.0],["LUX",88.0],["MAR",88.0],["ISL",81.0],["MDA",79.0],["MKD",75.0],["LBN",72.0],["LKA",65.0],["GTM",63.0],["MLT",63.0],["ATG",60.0],["SLV",60.0],["QAT",58.0],["NGA",58.0],["BHR",55.0],["BMU",53.0],["TZA",53.0],["VIR",51.0],["HND",50.0],["AZE",49.0],["NIC",47.0],["JOR",46.0],["JAM",44.0],["KHM",43.0],["KGZ",43.0],["MNG",39.0],["BRB",38.0],["MUS",37.0],["UZB",34.0],["ARM",34.0],["DZA",34.0],["JEY",34.0],["MAC",33.0],["UGA",33.0],["NPL",33.0],["GUM",32.0],["SDN",32.0],["PRY",32.0],["ALB",32.0],["TUN",31.0],["NAM",30.0],["GHA",30.0],["CMR",29.0],["TTO",28.0],["AGO",28.0],["ZWE",27.0],["DMA",26.0],["CYM",26.0],["SEN",25.0],["OMN",25.0],["PSE",25.0],["DOM",24.0],["BFA",24.0],["KNA",23.0],["MOZ",22.0],["ALA",20.0],["PYF",20.0],["YEM",19.0],["AFG",19.0],["BRN",19.0],["BHS",18.0],["NCL",18.0],["PNG",16.0],["LBY",16.0],["LIE",15.0],["MDG",15.0],["CUB",15.0],["FRO",14.0],["MNE",14.0],["BLZ",13.0],["GRD",12.0],["GLP",12.0],["MCO",12.0],["BWA",12.0],["HTI",12.0],["FJI",11.0],["SWZ",11.0],["VCT",11.0],["MDV",11.0],["MLI",11.0],["CIV",10.0],["VUT",10.0],["SUR",10.0],["MNP",9.0],["MWI",9.0],["REU",9.0],["GIB",9.0],["COD",8.0],["IMN",8.0],["BTN",8.0],["ABW",8.0],["GGY",8.0],["LAO",7.0],["ZMB",7.0],["IRQ",7.0],["AIA",7.0],["MRT",7.0],["TGO",7.0],["GMB",7.0],["LCA",6.0],["MTQ",6.0],["VGB",6.0],["RWA",6.0],["GUY",5.0],["LSO",5.0],["SYR",5.0],["TJK",4.0],["AND",4.0],["SLE",4.0],["SYC",4.0],["FSM",3.0],["SMR",3.0],["MHL",3.0],["COG",3.0],["ASM",3.0],["TKM",3.0],["TLS",3.0],["BEN",3.0],["COK",3.0],["GRL",2.0],["LBR",2.0],["IOT",2.0],["SLB",2.0],["TON",1.0],["WSM",1.0],["FLK",1.0],["MAF",1.0],["TCA",1.0],["VAT",1.0],["GAB",1.0],["GIN",1.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"cca3","type":"\"string\""},{"name":"device_id","type":"\"long\""}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"Error in SQL statement: SparkException: Job aborted due to stage failure: Task 0 in stage 2.0 failed 1 times, most recent failure: Lost task 0.0 in stage 2.0 (TID 4, localhost): java.lang.IllegalStateException: unread block data\n\tat java.io.ObjectInputStream$BlockDataInputStream.setBlockDataMode(ObjectInputStream.java:2431)\n\tat java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1383)\n\tat java.io.ObjectInputStream.defaultReadFields(ObjectInputStream.java:2000)\n\tat java.io.ObjectInputStream.readSerialData(ObjectInputStream.java:1924)\n\tat java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1801)\n\tat java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1351)\n\tat java.io.ObjectInputStream.readObject(ObjectInputStream.java:371)\n\tat org.apache.spark.serializer.JavaDeserializationStream.readObject(JavaSerializer.scala:76)\n\tat org.apache.spark.serializer.JavaSerializerInstance.deserialize(JavaSerializer.scala:115)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:194)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:745)\n\nDriver stacktrace:","error":"com.databricks.backend.common.rpc.DatabricksExceptions$SQLExecutionException: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 2.0 failed 1 times, most recent failure: Lost task 0.0 in stage 2.0 (TID 4, localhost): java.lang.IllegalStateException: unread block data\n\tat java.io.ObjectInputStream$BlockDataInputStream.setBlockDataMode(ObjectInputStream.java:2431)\n\tat java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1383)\n\tat java.io.ObjectInputStream.defaultReadFields(ObjectInputStream.java:2000)\n\tat java.io.ObjectInputStream.readSerialData(ObjectInputStream.java:1924)\n\tat java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1801)\n\tat java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1351)\n\tat java.io.ObjectInputStream.readObject(ObjectInputStream.java:371)\n\tat org.apache.spark.serializer.JavaDeserializationStream.readObject(JavaSerializer.scala:76)\n\tat org.apache.spark.serializer.JavaSerializerInstance.deserialize(JavaSerializer.scala:115)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:194)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:745)\n\nDriver stacktrace:\n\tat org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1431)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1419)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1418)\n\tat scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:47)\n\tat org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:1418)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:799)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:799)\n\tat scala.Option.foreach(Option.scala:236)\n\tat org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:799)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1640)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1599)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1588)\n\tat org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:620)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1835)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1848)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1861)\n\tat org.apache.spark.sql.execution.SparkPlan.executeTake(SparkPlan.scala:212)\n\tat org.apache.spark.sql.execution.Limit.executeCollect(basicOperators.scala:165)\n\tat org.apache.spark.sql.execution.SparkPlan.executeCollectPublic(SparkPlan.scala:174)\n\tat org.apache.spark.sql.DataFrame$$anonfun$org$apache$spark$sql$DataFrame$$execute$1$1.apply(DataFrame.scala:1499)\n\tat org.apache.spark.sql.DataFrame$$anonfun$org$apache$spark$sql$DataFrame$$execute$1$1.apply(DataFrame.scala:1499)\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:56)\n\tat org.apache.spark.sql.DataFrame.withNewExecutionId(DataFrame.scala:2086)\n\tat org.apache.spark.sql.DataFrame.org$apache$spark$sql$DataFrame$$execute$1(DataFrame.scala:1498)\n\tat org.apache.spark.sql.DataFrame.org$apache$spark$sql$DataFrame$$collect(DataFrame.scala:1505)\n\tat org.apache.spark.sql.DataFrame$$anonfun$head$1.apply(DataFrame.scala:1375)\n\tat org.apache.spark.sql.DataFrame$$anonfun$head$1.apply(DataFrame.scala:1374)\n\tat org.apache.spark.sql.DataFrame.withCallback(DataFrame.scala:2099)\n\tat org.apache.spark.sql.DataFrame.head(DataFrame.scala:1374)\n\tat org.apache.spark.sql.DataFrame.take(DataFrame.scala:1456)\n\tat com.databricks.backend.daemon.driver.OutputAggregator$.withOutputAggregation0(OutputAggregator.scala:80)\n\tat com.databricks.backend.daemon.driver.OutputAggregator$.withOutputAggregation(OutputAggregator.scala:42)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.executeSql(SQLDriverLocal.scala:90)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.repl(SQLDriverLocal.scala:116)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:157)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:157)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:83)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:57)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:78)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:30)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:116)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:30)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:156)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$3.apply(DriverWrapper.scala:483)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$3.apply(DriverWrapper.scala:483)\n\tat scala.util.Try$.apply(Try.scala:161)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:480)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:381)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:212)\n\tat java.lang.Thread.run(Thread.java:745)\nCaused by: java.lang.IllegalStateException: unread block data\n\tat java.io.ObjectInputStream$BlockDataInputStream.setBlockDataMode(ObjectInputStream.java:2431)\n\tat java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1383)\n\tat java.io.ObjectInputStream.defaultReadFields(ObjectInputStream.java:2000)\n\tat java.io.ObjectInputStream.readSerialData(ObjectInputStream.java:1924)\n\tat java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1801)\n\tat java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1351)\n\tat java.io.ObjectInputStream.readObject(ObjectInputStream.java:371)\n\tat org.apache.spark.serializer.JavaDeserializationStream.readObject(JavaSerializer.scala:76)\n\tat org.apache.spark.serializer.JavaSerializerInstance.deserialize(JavaSerializer.scala:115)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:194)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\t... 1 more\n\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.executeSql(SQLDriverLocal.scala:104)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.repl(SQLDriverLocal.scala:116)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:157)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:157)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:83)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:57)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:78)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:30)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:116)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:30)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:156)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$3.apply(DriverWrapper.scala:483)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$3.apply(DriverWrapper.scala:483)\n\tat scala.util.Try$.apply(Try.scala:161)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:480)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:381)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:212)\n\tat java.lang.Thread.run(Thread.java:745)\n","workflows":[],"startTime":1.458174290455E12,"submitTime":1.458174285964E12,"finishTime":1.458174297814E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"mapPlot","width":"1102.5","height":"377.5","xColumns":["cca3"],"yColumns":["device_id"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":{"mapPlot":[]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jules.damji@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"dffedbdc-916a-42b3-9faf-8b8da5180e36"},{"version":"CommandV1","origId":922964923687084,"guid":"e7a1ea90-78b3-40ab-8d74-db3d7bfa7a81","subtype":"command","commandType":"auto","position":3.0,"command":"%sql select cca3, c02_level, device_name, humidity from iot_device_data where humidity > 80 and c02_level > 1400 and device_name like 'therm%' order by humidity, c02_level desc limit 1000\n","commandVersion":0,"state":"finished","results":{"type":"table","data":[["USA",1594.0,"therm-stick-167615lHQfTcO",81.0],["USA",1591.0,"therm-stick-5875C6XYY",81.0],["VEN",1590.0,"therm-stick-192545u9rEIu",81.0],["JPN",1589.0,"therm-stick-34495ccWYv6CuSS",81.0],["PER",1586.0,"therm-stick-145735Woa4DycQL",81.0],["USA",1585.0,"therm-stick-87115eReKn0CJpm",81.0],["BGR",1579.0,"therm-stick-1879852Wprx37",81.0],["KEN",1575.0,"therm-stick-94625XdUR8Ye19",81.0],["USA",1574.0,"therm-stick-169225HQvUx",81.0],["PHL",1573.0,"therm-stick-1925Iz5Mvn",81.0],["EST",1570.0,"therm-stick-33295huQ3c2j",81.0],["USA",1559.0,"therm-stick-143665l7ZEGC",81.0],["VNM",1554.0,"therm-stick-53975IKFAXDMap",81.0],["KOR",1551.0,"therm-stick-41825QVdSDg7Yt",81.0],["KOR",1544.0,"therm-stick-119975MH1dXJvEO",81.0],["SVN",1535.0,"therm-stick-134755lwNJY",81.0],["JPN",1535.0,"therm-stick-3479520yBJrzG",81.0],["USA",1531.0,"therm-stick-94295Sbrf9FTs",81.0],["DEU",1526.0,"therm-stick-24455SWshbPb",81.0],["USA",1525.0,"therm-stick-119515LkSCq",81.0],["ROU",1521.0,"therm-stick-138995PTwJM1A7UX",81.0],["MEX",1516.0,"therm-stick-155075GJIzWBq",81.0],["USA",1508.0,"therm-stick-11845sob5FW",81.0],["BRA",1502.0,"therm-stick-85825OlFi9PW",81.0],["USA",1496.0,"therm-stick-10915lcaJqgaXPN",81.0],["IND",1484.0,"therm-stick-110315T7mC05mN47",81.0],["USA",1468.0,"therm-stick-32135idg1Dmuep",81.0],["BIH",1466.0,"therm-stick-152315FfExm0Rp",81.0],["TWN",1465.0,"therm-stick-133925CKA4YAU5ae",81.0],["USA",1463.0,"therm-stick-178615LygfH5l",81.0],["CHN",1456.0,"therm-stick-141775aEBQcgnx",81.0],["IRL",1455.0,"therm-stick-112955yYlfo",81.0],["JPN",1444.0,"therm-stick-166205XOcKYuFmE",81.0],["USA",1441.0,"therm-stick-38705xfGztNC",81.0],["USA",1429.0,"therm-stick-1634750VR83Ko",81.0],["JPN",1428.0,"therm-stick-82345Ncijmt7l",81.0],["FRA",1427.0,"therm-stick-192865BcTwjpBqw",81.0],["KOR",1422.0,"therm-stick-13165cgdPF",81.0],["DEU",1421.0,"therm-stick-92275N6zTG",81.0],["AUT",1415.0,"therm-stick-192775fkIL2G",81.0],["GBR",1415.0,"therm-stick-49235TiINPOXcO",81.0],["JPN",1408.0,"therm-stick-1457656VMgqSishH",81.0],["NZL",1585.0,"therm-stick-71515OZROBXyRuv",82.0],["HKG",1582.0,"therm-stick-28355edghqz",82.0],["MEX",1578.0,"therm-stick-48265ucilM",82.0],["DEU",1565.0,"therm-stick-168258KhH5d",82.0],["USA",1554.0,"therm-stick-13325BEh9H",82.0],["RUS",1550.0,"therm-stick-68695NsQkv",82.0],["SVK",1544.0,"therm-stick-259852nz8Khs",82.0],["AUS",1540.0,"therm-stick-1590851C5nht",82.0],["CAN",1533.0,"therm-stick-81175PkdgXus",82.0],["USA",1520.0,"therm-stick-5615H7zMBMW",82.0],["SWE",1518.0,"therm-stick-188135eMn5w2a",82.0],["USA",1514.0,"therm-stick-127805LsCq4",82.0],["JPN",1502.0,"therm-stick-150575MWyUlT8",82.0],["CHN",1497.0,"therm-stick-8135SlDxaTcA",82.0],["KOR",1494.0,"therm-stick-34975Y8fx0R",82.0],["JPN",1492.0,"therm-stick-110705mcL7b",82.0],["USA",1492.0,"therm-stick-185885HIFvryvgmY",82.0],["ARE",1485.0,"therm-stick-133915hQZIFcbx3t",82.0],["POL",1483.0,"therm-stick-48775GbcgJMfbby",82.0],["LVA",1483.0,"therm-stick-106045GyoRDr",82.0],["CAN",1479.0,"therm-stick-23845CLCBX9F3x",82.0],["USA",1475.0,"therm-stick-56485yDVYE",82.0],["CHN",1471.0,"therm-stick-183815ZmDtutS",82.0],["NLD",1467.0,"therm-stick-96295kjyepyX0H",82.0],["USA",1459.0,"therm-stick-193285zGvk9s",82.0],["AUT",1456.0,"therm-stick-195275BfEEm1N",82.0],["THA",1452.0,"therm-stick-176575xpN5HE",82.0],["USA",1445.0,"therm-stick-49805Mz6Ce5",82.0],["DEU",1441.0,"therm-stick-54685gQouU",82.0],["CHN",1440.0,"therm-stick-17695D4Ifrv3",82.0],["USA",1437.0,"therm-stick-30505twZo94L",82.0],["ESP",1435.0,"therm-stick-1295054K4Ap",82.0],["DEU",1424.0,"therm-stick-194035myEsMg",82.0],["JPN",1422.0,"therm-stick-43355HRb6N",82.0],["USA",1421.0,"therm-stick-32515bs84XU",82.0],["GBR",1417.0,"therm-stick-160525EQU8B2JT",82.0],["NZL",1417.0,"therm-stick-122195xiDVv45",82.0],["USA",1415.0,"therm-stick-31715WDxxweF",82.0],["AUT",1415.0,"therm-stick-66305nXcdA4Ii",82.0],["USA",1408.0,"therm-stick-1225859uj6anOn",82.0],["ESP",1408.0,"therm-stick-21515KN5VtxLO",82.0],["CHN",1406.0,"therm-stick-157555Au9nT9KcH",82.0],["KOR",1403.0,"therm-stick-178153K9CBsEgdP",82.0],["USA",1401.0,"therm-stick-1119050CS83",82.0],["IRL",1592.0,"therm-stick-501852qb9fc",83.0],["USA",1587.0,"therm-stick-1757659EtJBiB",83.0],["USA",1586.0,"therm-stick-174565TfTnGVi",83.0],["GEO",1586.0,"therm-stick-91775N83xkq1dY",83.0],["USA",1583.0,"therm-stick-66275vopioR7fVj",83.0],["GBR",1583.0,"therm-stick-10555386J8hL1b",83.0],["USA",1582.0,"therm-stick-44855UaLUCEHQ5A",83.0],["JPN",1579.0,"therm-stick-84355kbljO",83.0],["GEO",1570.0,"therm-stick-123355WTX5",83.0],["GBR",1560.0,"therm-stick-139555THGSOk",83.0],["JPN",1549.0,"therm-stick-181955ldwi6",83.0],["NLD",1546.0,"therm-stick-180745AjExnnav",83.0],["KOR",1540.0,"therm-stick-58705YbUPXINSZf",83.0],["TWN",1537.0,"therm-stick-34475Bt77BGnm",83.0],["USA",1525.0,"therm-stick-86525rj8P3x5znZ",83.0],["POL",1519.0,"therm-stick-4225BQKnLr",83.0],["IRN",1513.0,"therm-stick-71885O1hM0klqg",83.0],["CAN",1510.0,"therm-stick-1277957xmjjs",83.0],["USA",1498.0,"therm-stick-76175my4TREH0Cw",83.0],["USA",1497.0,"therm-stick-151805ChtQaIWIS3",83.0],["GBR",1494.0,"therm-stick-1771850ukRDl",83.0],["USA",1490.0,"therm-stick-112235cA1UsoO6Yh",83.0],["USA",1488.0,"therm-stick-48358gCGPc8",83.0],["FRA",1488.0,"therm-stick-191935enGxHTnkI",83.0],["BRA",1487.0,"therm-stick-1025757FTVe63",83.0],["USA",1480.0,"therm-stick-166315SRO0wn5t",83.0],["USA",1478.0,"therm-stick-100535oJD9IJv80",83.0],["CAN",1477.0,"therm-stick-65165NTHhmSKmx2",83.0],["KOR",1464.0,"therm-stick-171295ZlS50V",83.0],["USA",1454.0,"therm-stick-189875VILTivap3u",83.0],["USA",1450.0,"therm-stick-144415rTHZf4hX",83.0],["DEU",1446.0,"therm-stick-182305qTV27ahPt",83.0],["USA",1444.0,"therm-stick-53215IENl2ycGfD",83.0],["USA",1443.0,"therm-stick-149545cI3saJ",83.0],["USA",1439.0,"therm-stick-70355SCU5Z4",83.0],["DEU",1437.0,"therm-stick-43465yeF4mEA8bn",83.0],["JPN",1422.0,"therm-stick-167395dzrBBL",83.0],["CHN",1415.0,"therm-stick-35KXlFJix",83.0],["SGP",1412.0,"therm-stick-85375kO0Ri",83.0],["GBR",1411.0,"therm-stick-127355NHckUpwv5",83.0],["BRA",1599.0,"therm-stick-34805pJU3mAgQ",84.0],["USA",1580.0,"therm-stick-52735keVaU18EL",84.0],["RUS",1579.0,"therm-stick-1758959Doya",84.0],["USA",1578.0,"therm-stick-91555YRsdBy",84.0],["USA",1571.0,"therm-stick-130225fgCRMEVb",84.0],["USA",1554.0,"therm-stick-31165xBOqW9rm",84.0],["CAN",1554.0,"therm-stick-988751mz9j3",84.0],["MYS",1552.0,"therm-stick-1142350tAye1EEW",84.0],["IDN",1551.0,"therm-stick-695hDDOEMxuCD",84.0],["GBR",1548.0,"therm-stick-111935aHqaCn",84.0],["USA",1547.0,"therm-stick-8785zYOI62",84.0],["USA",1537.0,"therm-stick-148015XusKTGo3",84.0],["DEU",1531.0,"therm-stick-71095P30NVjgPY",84.0],["BRA",1530.0,"therm-stick-17155qGJ0du",84.0],["JPN",1524.0,"therm-stick-82495Uncem",84.0],["DEU",1523.0,"therm-stick-63155RHZHstX",84.0],["CHN",1514.0,"therm-stick-107395mCou52Lcl",84.0],["CHN",1514.0,"therm-stick-2075WCrcc",84.0],["USA",1513.0,"therm-stick-40625ECovsH6L",84.0],["USA",1509.0,"therm-stick-84305qqqrY",84.0],["ROU",1503.0,"therm-stick-148115eaYOu",84.0],["CHN",1501.0,"therm-stick-21335IEBhLg",84.0],["GBR",1497.0,"therm-stick-68245hBHChqY",84.0],["FRA",1491.0,"therm-stick-32155vXdBXPFUjg",84.0],["CHN",1479.0,"therm-stick-1457159lkUXa",84.0],["HUN",1478.0,"therm-stick-8576568rU9Q",84.0],["ESP",1478.0,"therm-stick-151745Cos96gR",84.0],["CHN",1475.0,"therm-stick-68065SKIWN",84.0],["THA",1475.0,"therm-stick-42005kvEogb08Gg",84.0],["JPN",1457.0,"therm-stick-165955Zppux7K",84.0],["CHN",1454.0,"therm-stick-73835bm73DSwncX",84.0],["USA",1445.0,"therm-stick-103915ZO1yC8",84.0],["USA",1438.0,"therm-stick-146495csT7hVe",84.0],["JPN",1434.0,"therm-stick-148985fhn7FLtl",84.0],["USA",1431.0,"therm-stick-67595i44AqoFl",84.0],["TWN",1426.0,"therm-stick-58555bMbBkz",84.0],["SGP",1422.0,"therm-stick-104555Tcr45D4",84.0],["IDN",1422.0,"therm-stick-62935JpgNDi",84.0],["CHN",1417.0,"therm-stick-160145BKjT7e",84.0],["BRA",1417.0,"therm-stick-175915Zafa7rvh8m",84.0],["USA",1408.0,"therm-stick-3867516QVDu",84.0],["USA",1405.0,"therm-stick-97825qx2ixFs",84.0],["CHN",1585.0,"therm-stick-1775058ACEX",85.0],["USA",1584.0,"therm-stick-174905IdUuXiFGK",85.0],["USA",1584.0,"therm-stick-63095IrWryWWH",85.0],["CHN",1584.0,"therm-stick-63445WeQVe8xv",85.0],["USA",1582.0,"therm-stick-75805LeHfiOun8",85.0],["HKG",1576.0,"therm-stick-40255dtkse25Ewz",85.0],["GBR",1573.0,"therm-stick-176275usUW889",85.0],["ITA",1560.0,"therm-stick-116795CW0wvyOF56",85.0],["USA",1555.0,"therm-stick-181145LobNhyTy",85.0],["CAN",1544.0,"therm-stick-11495mf9aZf5",85.0],["SWE",1537.0,"therm-stick-642050lA0r",85.0],["USA",1535.0,"therm-stick-118135Dj0bVK",85.0],["USA",1535.0,"therm-stick-29765UX0LkNiR1",85.0],["USA",1529.0,"therm-stick-121175SFxnb",85.0],["RUS",1528.0,"therm-stick-79645lhlDp2",85.0],["SVK",1527.0,"therm-stick-147235gZZnyH4D",85.0],["USA",1523.0,"therm-stick-51875wMmHWIbGTl",85.0],["NOR",1521.0,"therm-stick-20695bPBX3",85.0],["USA",1520.0,"therm-stick-78985pQwoMd",85.0],["CHN",1513.0,"therm-stick-13745G9Qm1bR5",85.0],["USA",1506.0,"therm-stick-196775qHyLSy5EtB",85.0],["TWN",1506.0,"therm-stick-483959kaGu7",85.0],["FRA",1505.0,"therm-stick-147085zrl7J",85.0],["CHN",1500.0,"therm-stick-143405l3RdmR8E",85.0],["CHN",1490.0,"therm-stick-109475TwMTY",85.0],["ITA",1480.0,"therm-stick-19465CRsLiyX",85.0],["CHL",1477.0,"therm-stick-139385WiT5I",85.0],["UKR",1475.0,"therm-stick-197665hiso9",85.0],["HRV",1471.0,"therm-stick-157565chlAh",85.0],["DEU",1467.0,"therm-stick-1105853Ez5nR",85.0],["ESP",1458.0,"therm-stick-478252cWYfO",85.0],["CHN",1457.0,"therm-stick-118805ZYfkAzWe",85.0],["USA",1452.0,"therm-stick-197995mrDcc",85.0],["CHN",1447.0,"therm-stick-146035cWioS",85.0],["AUS",1445.0,"therm-stick-90505PLy0F7",85.0],["USA",1442.0,"therm-stick-1003759W4Kr",85.0],["USA",1442.0,"therm-stick-159515XSGCc",85.0],["USA",1434.0,"therm-stick-36775ISqgZNiE",85.0],["TWN",1428.0,"therm-stick-114395Ec5Mv0P1N",85.0],["JPN",1428.0,"therm-stick-14061566CQNR",85.0],["USA",1412.0,"therm-stick-77955Vf1Jjr",85.0],["USA",1412.0,"therm-stick-141505MkcdY14Ez",85.0],["USA",1409.0,"therm-stick-58385sh9Jbza78",85.0],["USA",1599.0,"therm-stick-161915ISrfXnO7rQ",86.0],["ARG",1597.0,"therm-stick-82985GHymDJrSZ",86.0],["USA",1592.0,"therm-stick-147475FfvKv3w5",86.0],["GBR",1590.0,"therm-stick-1184356C6rL",86.0],["USA",1587.0,"therm-stick-35225Ur0cJABo",86.0],["USA",1587.0,"therm-stick-155285D73L4r4",86.0],["USA",1586.0,"therm-stick-1142459v8ZoAr4J",86.0],["TWN",1584.0,"therm-stick-178925hKTv7Ku",86.0],["POL",1578.0,"therm-stick-72715eAYrIb1Pl",86.0],["NOR",1574.0,"therm-stick-88585oQNHt77",86.0],["USA",1574.0,"therm-stick-136465ZKCRaK",86.0],["USA",1565.0,"therm-stick-140135RgmKZ",86.0],["CHN",1565.0,"therm-stick-140215TVjn5b9ob1",86.0],["FRA",1560.0,"therm-stick-115805W5e1YFCxgG",86.0],["USA",1559.0,"therm-stick-1263650xRPlH",86.0],["USA",1554.0,"therm-stick-115855zNrXJBC9hO",86.0],["USA",1554.0,"therm-stick-979151c20SEJI",86.0],["USA",1550.0,"therm-stick-63035lbpC3aDghr",86.0],["USA",1545.0,"therm-stick-162005M5u2d1Oli",86.0],["PHL",1539.0,"therm-stick-127225Ukm8R2",86.0],["USA",1537.0,"therm-stick-42245a9QC0t2r",86.0],["CAN",1535.0,"therm-stick-32075PGIfvZ39",86.0],["USA",1527.0,"therm-stick-140365tvuEH8L",86.0],["HUN",1526.0,"therm-stick-189845ehUGW",86.0],["CAN",1525.0,"therm-stick-24395looXUG",86.0],["CZE",1524.0,"therm-stick-141425ifeH4fHVw3",86.0],["JPN",1512.0,"therm-stick-52675AJfFs",86.0],["KOR",1510.0,"therm-stick-121985aBY6Q8Xel",86.0],["USA",1508.0,"therm-stick-57625MsYlVmWV",86.0],["KOR",1494.0,"therm-stick-138935I8gPnKQlS",86.0],["IND",1491.0,"therm-stick-1545569Iflz7G",86.0],["CAN",1489.0,"therm-stick-126985t4HEXz",86.0],["USA",1481.0,"therm-stick-15565u0vhwV",86.0],["USA",1481.0,"therm-stick-298251s2yhjS5Nc",86.0],["USA",1479.0,"therm-stick-97285Ghag6",86.0],["GBR",1462.0,"therm-stick-51005zKv8IIeq",86.0],["SWE",1461.0,"therm-stick-764654ecqTMBWcD",86.0],["USA",1460.0,"therm-stick-103775u7eiFjNgd",86.0],["KOR",1458.0,"therm-stick-1440255Tee3rDr",86.0],["BRA",1450.0,"therm-stick-49655yjQim",86.0],["USA",1448.0,"therm-stick-114205ZTKZNg",86.0],["CAN",1445.0,"therm-stick-157195qMNRboft59",86.0],["USA",1441.0,"therm-stick-5215uv6IS",86.0],["USA",1440.0,"therm-stick-6225596OfY",86.0],["MEX",1437.0,"therm-stick-39385astof",86.0],["RUS",1437.0,"therm-stick-15575N8wJ9",86.0],["DEU",1433.0,"therm-stick-341954sXGIn",86.0],["USA",1421.0,"therm-stick-60035KIDjYF",86.0],["IDN",1418.0,"therm-stick-105365hSvXsmW",86.0],["RUS",1414.0,"therm-stick-612350W2fE2H15",86.0],["DEU",1408.0,"therm-stick-1602356vFAj5WJ",86.0],["USA",1403.0,"therm-stick-136355KNe8t2Iw",86.0],["KOR",1594.0,"therm-stick-13418591mULXvv",87.0],["KOR",1594.0,"therm-stick-165685sNnfhMcI",87.0],["USA",1589.0,"therm-stick-1629054qdGN",87.0],["CHN",1582.0,"therm-stick-194585p2P7aWz",87.0],["GRC",1570.0,"therm-stick-193325fAwts",87.0],["JPN",1557.0,"therm-stick-531053tOGISL",87.0],["GBR",1543.0,"therm-stick-74395nsd2G8W9",87.0],["GHA",1540.0,"therm-stick-103585TdJD2",87.0],["USA",1526.0,"therm-stick-58115ouftwaIR2",87.0],["USA",1519.0,"therm-stick-62335ggnmc7",87.0],["USA",1518.0,"therm-stick-16315B6JmQ",87.0],["USA",1511.0,"therm-stick-170855TJptsEl",87.0],["USA",1506.0,"therm-stick-103145mfv6sMYe",87.0],["USA",1504.0,"therm-stick-140350ZAZ4oQL2m",87.0],["USA",1503.0,"therm-stick-5612538p96nZYQ",87.0],["CHN",1502.0,"therm-stick-105245KmuQr4til",87.0],["JPN",1500.0,"therm-stick-145475tPdoqFQb6x",87.0],["THA",1497.0,"therm-stick-108385eEMCd",87.0],["KOR",1493.0,"therm-stick-713652t3u7",87.0],["USA",1490.0,"therm-stick-165875MZlkpjy",87.0],["USA",1490.0,"therm-stick-163745ktPrf1",87.0],["KOR",1485.0,"therm-stick-123025fEKgFlOveY",87.0],["DEU",1471.0,"therm-stick-127585mK1HTUi",87.0],["JPN",1470.0,"therm-stick-112115jAgUXc4Sf",87.0],["KOR",1469.0,"therm-stick-136295PBtAvb",87.0],["JPN",1467.0,"therm-stick-96605iAYxW",87.0],["USA",1459.0,"therm-stick-950050C1wV",87.0],["USA",1457.0,"therm-stick-35545KUsTCKurnN",87.0],["BRA",1453.0,"therm-stick-30905QziFum",87.0],["KOR",1446.0,"therm-stick-1503555teCbH",87.0],["USA",1428.0,"therm-stick-18995zIAara3",87.0],["USA",1426.0,"therm-stick-100745w0zpJeBIz",87.0],["USA",1414.0,"therm-stick-12725SkcH9xK",87.0],["CHN",1414.0,"therm-stick-106595PJK90aXKO",87.0],["ROU",1414.0,"therm-stick-117965Pq2JCr",87.0],["FRA",1412.0,"therm-stick-31465AZSXl",87.0],["KEN",1410.0,"therm-stick-25775tQgSA3U",87.0],["USA",1408.0,"therm-stick-20615blPF7ht",87.0],["CZE",1406.0,"therm-stick-7205lMU6Wn3",87.0],["FRA",1404.0,"therm-stick-54595HB5ZOVf",87.0],["USA",1402.0,"therm-stick-18095wcSvV",87.0],["AUT",1588.0,"therm-stick-13225HfjG70",88.0],["USA",1586.0,"therm-stick-107455UNw7Y",88.0],["NLD",1580.0,"therm-stick-146785S2AIl6",88.0],["CHN",1577.0,"therm-stick-122245VJJy9afOwA",88.0],["USA",1574.0,"therm-stick-83975DVQ5c",88.0],["NZL",1573.0,"therm-stick-981850Ksxy",88.0],["USA",1559.0,"therm-stick-166795S5tXAb",88.0],["SWE",1544.0,"therm-stick-120755kIl8w",88.0],["THA",1541.0,"therm-stick-134675wLB30Y3if",88.0],["USA",1539.0,"therm-stick-38165DW7WPTAm7m",88.0],["USA",1535.0,"therm-stick-27655VtaaRtmN9",88.0],["USA",1535.0,"therm-stick-75955XV4wIc",88.0],["KOR",1530.0,"therm-stick-94325GigT4MF",88.0],["AUS",1525.0,"therm-stick-12955zhQ78tqTQf",88.0],["USA",1518.0,"therm-stick-166165FRMnog",88.0],["AUT",1514.0,"therm-stick-197875RZ8BR",88.0],["HUN",1511.0,"therm-stick-195325gRq8WoCVr",88.0],["ITA",1508.0,"therm-stick-239056hskrdz",88.0],["BRA",1507.0,"therm-stick-54965hj2nKNMk",88.0],["THA",1506.0,"therm-stick-15715Xp70F",88.0],["GBR",1506.0,"therm-stick-27415So4oLefBWl",88.0],["GBR",1502.0,"therm-stick-104765PvoYe",88.0],["JPN",1498.0,"therm-stick-35751oucqded",88.0],["JPN",1496.0,"therm-stick-193295CNXimHc",88.0],["ITA",1494.0,"therm-stick-136505PtzYAR1xQ6",88.0],["SWE",1490.0,"therm-stick-1921452Eb0T3J",88.0],["USA",1490.0,"therm-stick-546558ltXNV2",88.0],["KOR",1474.0,"therm-stick-29965oXTVx",88.0],["HKG",1468.0,"therm-stick-112175Jlt0Nl",88.0],["USA",1467.0,"therm-stick-66145FFnB9",88.0],["USA",1466.0,"therm-stick-1679153PMg3aiR",88.0],["DEU",1455.0,"therm-stick-7755520DI4",88.0],["JPN",1453.0,"therm-stick-193735Yy9p8N0",88.0],["POL",1452.0,"therm-stick-190375NrNUu",88.0],["USA",1452.0,"therm-stick-44665111sx9MaNB",88.0],["CHE",1450.0,"therm-stick-38215BDSxiASjW",88.0],["CAN",1446.0,"therm-stick-9425LX4ik5RVzW",88.0],["FRA",1445.0,"therm-stick-1020353fyt8Y9",88.0],["KWT",1445.0,"therm-stick-66125kvsB0dh",88.0],["USA",1432.0,"therm-stick-47555iRX1hqU",88.0],["USA",1432.0,"therm-stick-53515FqVP9qkdj",88.0],["DEU",1426.0,"therm-stick-45085giQbmKz",88.0],["USA",1425.0,"therm-stick-534955HFGHlpe",88.0],["ITA",1424.0,"therm-stick-76315tiCzAm7",88.0],["KOR",1421.0,"therm-stick-1788357Q9lrNRYR",88.0],["USA",1419.0,"therm-stick-1614253OlS4yy",88.0],["FRA",1418.0,"therm-stick-16295eUMvEPdxNm",88.0],["USA",1414.0,"therm-stick-40165R5Qi7x4XJr",88.0],["CHN",1411.0,"therm-stick-127475o9BG1",88.0],["TWN",1410.0,"therm-stick-38455keXBZi6RqU",88.0],["AUS",1598.0,"therm-stick-5365hKYRpk",89.0],["USA",1595.0,"therm-stick-139835WtbVGjFMuw",89.0],["CHN",1591.0,"therm-stick-137935hffXf",89.0],["USA",1584.0,"therm-stick-848956ON99XQ2t",89.0],["KOR",1581.0,"therm-stick-149425BYjUuoSl",89.0],["USA",1581.0,"therm-stick-158725XMC62",89.0],["KOR",1580.0,"therm-stick-11585imNXz3",89.0],["USA",1571.0,"therm-stick-112925r0ZnyR",89.0],["RUS",1570.0,"therm-stick-95585W9u28VX",89.0],["JPN",1568.0,"therm-stick-138335mjalR",89.0],["SVK",1564.0,"therm-stick-105145N1YhAx7Q",89.0],["KOR",1555.0,"therm-stick-163625zatmtu",89.0],["USA",1545.0,"therm-stick-22255PvouJlMf8",89.0],["BRA",1544.0,"therm-stick-192805VtVjvIR",89.0],["CHN",1542.0,"therm-stick-1235K2hV8K",89.0],["CHN",1533.0,"therm-stick-171665gDhTySh8QQ",89.0],["USA",1530.0,"therm-stick-154075o6Gl9vQ9on",89.0],["RUS",1503.0,"therm-stick-23751u6P94",89.0],["USA",1501.0,"therm-stick-127535ZpFjxW",89.0],["CHN",1490.0,"therm-stick-151235eBmIdaL5",89.0],["CHN",1483.0,"therm-stick-108925ooSEFITDZw",89.0],["JPN",1481.0,"therm-stick-108665R25k89L",89.0],["NLD",1474.0,"therm-stick-114745eLCGNZXVn",89.0],["JPN",1469.0,"therm-stick-96985WNtfsQ069",89.0],["JPN",1468.0,"therm-stick-197275ILSJecvv",89.0],["CAN",1467.0,"therm-stick-1632656jUTChK5",89.0],["GBR",1455.0,"therm-stick-157165ApUb3",89.0],["MEX",1453.0,"therm-stick-138395cuLGbifHbP",89.0],["JPN",1448.0,"therm-stick-1192155Dnsir",89.0],["BHR",1448.0,"therm-stick-15805kHwUCViE8K",89.0],["DEU",1443.0,"therm-stick-124435YY87sc",89.0],["USA",1439.0,"therm-stick-131105j4Nzduvy6",89.0],["ZMB",1438.0,"therm-stick-74995uKiiE",89.0],["USA",1436.0,"therm-stick-2645toBZzpZb",89.0],["USA",1433.0,"therm-stick-78275XblTD6EAnm",89.0],["RUS",1423.0,"therm-stick-145255D3BEt9",89.0],["USA",1421.0,"therm-stick-34655qEiXIDya4",89.0],["USA",1421.0,"therm-stick-1455651f48XW",89.0],["CAN",1417.0,"therm-stick-95735JkcHSpDdbm",89.0],["USA",1415.0,"therm-stick-161375D1JT3F8lE",89.0],["KEN",1414.0,"therm-stick-18515hTLAFOokcq",89.0],["JPN",1414.0,"therm-stick-131785NhYlqaB2",89.0],["ROU",1406.0,"therm-stick-22475fVmgTm",89.0],["CHN",1406.0,"therm-stick-56635331xzo4E5",89.0],["USA",1403.0,"therm-stick-69865TXV5pAdF",89.0],["USA",1598.0,"therm-stick-101345NbbIcbL8l8",90.0],["KOR",1598.0,"therm-stick-95815LvEi2Dy",90.0],["USA",1595.0,"therm-stick-191015x48ZuWb",90.0],["USA",1592.0,"therm-stick-98275P0jIRL",90.0],["USA",1590.0,"therm-stick-189865Frknk",90.0],["SGP",1590.0,"therm-stick-1740356IESxBGi",90.0],["GBR",1572.0,"therm-stick-18085cvdXx4at",90.0],["USA",1568.0,"therm-stick-53695bdOmX3",90.0],["LBY",1560.0,"therm-stick-133105d6yF8iO8yB",90.0],["USA",1559.0,"therm-stick-86495kyR9Kyrht2",90.0],["CHE",1551.0,"therm-stick-143645hGacGQWIJ",90.0],["ROU",1551.0,"therm-stick-47975GVthdw",90.0],["GBR",1541.0,"therm-stick-117335u2DRZ",90.0],["USA",1537.0,"therm-stick-125275o75Hzn",90.0],["JPN",1537.0,"therm-stick-140035PL5Bd",90.0],["CHN",1527.0,"therm-stick-75005XgU8h1mI",90.0],["CHN",1522.0,"therm-stick-133655RRcH41Qnsv",90.0],["USA",1521.0,"therm-stick-81955lXrzmyA8cC",90.0],["JPN",1517.0,"therm-stick-58825FtfkQmd",90.0],["KOR",1516.0,"therm-stick-138305FiTSqYAp",90.0],["DEU",1516.0,"therm-stick-1361155diBjfY",90.0],["JPN",1502.0,"therm-stick-168085rLL07",90.0],["USA",1484.0,"therm-stick-2215QLk3lba",90.0],["USA",1484.0,"therm-stick-53785v0cjevrzi",90.0],["IND",1461.0,"therm-stick-94775zAsUTG",90.0],["DNK",1451.0,"therm-stick-1213458vt3h9VMc",90.0],["LIE",1445.0,"therm-stick-79705BWdYwWLcm",90.0],["CHE",1440.0,"therm-stick-68915DPxRMAV5",90.0],["JPN",1434.0,"therm-stick-118835rrEZhKo",90.0],["USA",1428.0,"therm-stick-130115GzcijiCY",90.0],["DEU",1424.0,"therm-stick-207551FQsd745",90.0],["JPN",1420.0,"therm-stick-78115Q3Ez5uHEh",90.0],["DEU",1418.0,"therm-stick-264559IrGQU2lN",90.0],["RUS",1416.0,"therm-stick-32215ltcurq",90.0],["USA",1415.0,"therm-stick-134285ES78O",90.0],["IND",1415.0,"therm-stick-2395Tk9MJ",90.0],["IND",1413.0,"therm-stick-19435sztpIi0FEC",90.0],["USA",1411.0,"therm-stick-82925BefrvLJqU",90.0],["AUT",1410.0,"therm-stick-13465C0BK9",90.0],["USA",1402.0,"therm-stick-180725mbf6tB0",90.0],["GBR",1599.0,"therm-stick-185275Tjpmc9JbtQ",91.0],["RUS",1596.0,"therm-stick-12655RNTjk8O",91.0],["CAN",1591.0,"therm-stick-36575mSCQC0",91.0],["USA",1587.0,"therm-stick-1912250TgFFEuk",91.0],["CHN",1584.0,"therm-stick-15665k4PKzDUSKD",91.0],["USA",1578.0,"therm-stick-10045XqkAL684i",91.0],["NLD",1575.0,"therm-stick-14795RHc0hQzU",91.0],["USA",1573.0,"therm-stick-185435A00L4SinCw",91.0],["USA",1573.0,"therm-stick-65525KTUtHbsFOG",91.0],["JPN",1571.0,"therm-stick-187175RDiZM2geHz",91.0],["JPN",1570.0,"therm-stick-80155GMZAm",91.0],["USA",1568.0,"therm-stick-6441518LQbOmaqw",91.0],["JPN",1564.0,"therm-stick-7715Inq50u",91.0],["USA",1563.0,"therm-stick-70015IM46l3vdIU",91.0],["USA",1562.0,"therm-stick-82595GlOidN1nsa",91.0],["USA",1558.0,"therm-stick-140105jyWoRpvdOn",91.0],["USA",1557.0,"therm-stick-166175L1lGx41vS",91.0],["USA",1551.0,"therm-stick-132595fY0Ih7pJch",91.0],["USA",1534.0,"therm-stick-17485GekYG",91.0],["JPN",1530.0,"therm-stick-74045EDknVE1VjX",91.0],["JPN",1527.0,"therm-stick-1037156QDpWZv8R",91.0],["CHN",1523.0,"therm-stick-185465PnXeYTs",91.0],["DEU",1523.0,"therm-stick-180935qUqcXIivmr",91.0],["USA",1517.0,"therm-stick-130825Yg3S9",91.0],["DEU",1509.0,"therm-stick-127175JvcJ67I",91.0],["UKR",1503.0,"therm-stick-190495ty9iM",91.0],["USA",1502.0,"therm-stick-164135gmgspSfL",91.0],["GBR",1499.0,"therm-stick-30575vVYLnBfLAj",91.0],["USA",1478.0,"therm-stick-1062357saoDC2",91.0],["USA",1468.0,"therm-stick-5975pdqH6ALeE",91.0],["KOR",1460.0,"therm-stick-72805s2i4gC3YqK",91.0],["USA",1440.0,"therm-stick-29485Qgw0XS8b",91.0],["THA",1439.0,"therm-stick-174365D1qGEvp8",91.0],["CZE",1438.0,"therm-stick-98075h1YieDvq",91.0],["USA",1436.0,"therm-stick-32665FiXHoN3Cj",91.0],["KOR",1435.0,"therm-stick-159385bza7znP",91.0],["VNM",1431.0,"therm-stick-102625vIPnyei5",91.0],["USA",1427.0,"therm-stick-4285X416nl",91.0],["GBR",1426.0,"therm-stick-116725x42etfBjw",91.0],["CZE",1420.0,"therm-stick-121085fTC37Up",91.0],["CHN",1417.0,"therm-stick-21115m8NxQ",91.0],["USA",1415.0,"therm-stick-147245Ev9JBNQWo",91.0],["GBR",1404.0,"therm-stick-6125HcTtFw4te",91.0],["CHN",1401.0,"therm-stick-48605sXqZ7",91.0],["CAN",1401.0,"therm-stick-575Rqjn4b7BB",91.0],["AUS",1598.0,"therm-stick-142085lybSKy2",92.0],["KOR",1597.0,"therm-stick-100895nCL6bP",92.0],["KOR",1594.0,"therm-stick-126685wT5hZML",92.0],["MYS",1592.0,"therm-stick-1775hbisMe",92.0],["GRC",1588.0,"therm-stick-171125juOYI0",92.0],["MYS",1587.0,"therm-stick-937556pMQrB66L",92.0],["JPN",1575.0,"therm-stick-66115Ez5velCoiC",92.0],["IND",1575.0,"therm-stick-179965s6ZKuD9os",92.0],["CHE",1573.0,"therm-stick-272452XV5IAHsZ6",92.0],["USA",1571.0,"therm-stick-23455T9XHfiw6F",92.0],["USA",1567.0,"therm-stick-152515YSxNGJ",92.0],["CAN",1566.0,"therm-stick-102325sZH1SE",92.0],["GBR",1559.0,"therm-stick-147365XdWVe",92.0],["BEL",1558.0,"therm-stick-92995itidIMmX",92.0],["USA",1555.0,"therm-stick-80185iiTuVuvPVS",92.0],["UKR",1548.0,"therm-stick-60175PO9CLf",92.0],["BRA",1547.0,"therm-stick-516554eN6XeVGkg",92.0],["THA",1547.0,"therm-stick-124625OlhyLyqzT",92.0],["ESP",1538.0,"therm-stick-141935KLQEGxn",92.0],["USA",1538.0,"therm-stick-1026050NaT6",92.0],["KGZ",1532.0,"therm-stick-90265wFhGjPd",92.0],["CHN",1530.0,"therm-stick-7985t2cGHBPAQF",92.0],["CHN",1526.0,"therm-stick-451454zDgQwF",92.0],["FRA",1524.0,"therm-stick-21565S1USn",92.0],["USA",1524.0,"therm-stick-3635AXcmqvcQ4",92.0],["USA",1518.0,"therm-stick-162145xzyHD",92.0],["LTU",1502.0,"therm-stick-1745NGXYaH",92.0],["USA",1499.0,"therm-stick-132145ZZiaA",92.0],["USA",1499.0,"therm-stick-148495XhXZaN",92.0],["CHN",1498.0,"therm-stick-574253FzY5",92.0],["USA",1491.0,"therm-stick-25535sPe0vvYL9",92.0],["GBR",1489.0,"therm-stick-159145i1Wk1q",92.0],["USA",1485.0,"therm-stick-158285jC0mUFEI",92.0],["USA",1483.0,"therm-stick-170215fGYCT",92.0],["GBR",1474.0,"therm-stick-41815Z2HSuZ",92.0],["UKR",1473.0,"therm-stick-82975t6DuTY",92.0],["IDN",1471.0,"therm-stick-87865Wl2dPHEiPg",92.0],["USA",1467.0,"therm-stick-56815j9gyfq",92.0],["KOR",1465.0,"therm-stick-42535gUrzg",92.0],["CHN",1460.0,"therm-stick-148045zDRcsZg",92.0],["USA",1454.0,"therm-stick-163165J07tsx2VU",92.0],["JPN",1446.0,"therm-stick-87475IzS6Z",92.0],["USA",1441.0,"therm-stick-170405jFcPU9x",92.0],["GBR",1440.0,"therm-stick-175145vcqcS0AH",92.0],["USA",1436.0,"therm-stick-919857UWL8",92.0],["USA",1435.0,"therm-stick-119015PSzdZHJrd",92.0],["USA",1427.0,"therm-stick-1646957B4igzWXR",92.0],["KOR",1426.0,"therm-stick-46975MxCOcrE",92.0],["JPN",1424.0,"therm-stick-3235e7nO0F",92.0],["POL",1423.0,"therm-stick-55195MbKLumWF",92.0],["CHN",1419.0,"therm-stick-43505VZu8Z2KUv",92.0],["HKG",1418.0,"therm-stick-197575Or8HgRc9l5",92.0],["BRA",1417.0,"therm-stick-169085JNgQEP6NE",92.0],["DEU",1414.0,"therm-stick-132065pws2GV",92.0],["KOR",1401.0,"therm-stick-86255T3r6fssM1",92.0],["GBR",1594.0,"therm-stick-147385H7n5gR",93.0],["USA",1592.0,"therm-stick-113965oxo9At",93.0],["ROU",1592.0,"therm-stick-162455BluH2zgY",93.0],["USA",1591.0,"therm-stick-132935oAcxhAqQ",93.0],["USA",1591.0,"therm-stick-75895GXrL2",93.0],["USA",1588.0,"therm-stick-35915W7tGRJ3",93.0],["JPN",1583.0,"therm-stick-190565nUmmmLN1O",93.0],["USA",1574.0,"therm-stick-24415hGjnRid",93.0],["CHN",1569.0,"therm-stick-1390150H9U7Yywp",93.0],["KOR",1559.0,"therm-stick-702959iR7KNa9",93.0],["USA",1553.0,"therm-stick-26755ih75DygEN",93.0],["ITA",1550.0,"therm-stick-95605mfGqCe",93.0],["USA",1545.0,"therm-stick-169235Jfz5sw1sj",93.0],["FRA",1543.0,"therm-stick-117865U7V7Olo",93.0],["DEU",1540.0,"therm-stick-48415A9AL7KWBpa",93.0],["USA",1535.0,"therm-stick-1114153tTlsdme",93.0],["USA",1530.0,"therm-stick-121265CSPk92o577",93.0],["KOR",1528.0,"therm-stick-178415EwKlN84o",93.0],["UKR",1527.0,"therm-stick-139745Z9HZBHtSSg",93.0],["JPN",1511.0,"therm-stick-120455LUO4g",93.0],["JPN",1511.0,"therm-stick-160555ZSMPJ",93.0],["USA",1510.0,"therm-stick-167935frxqw52Ej",93.0],["KOR",1510.0,"therm-stick-152525mhpdS",93.0],["USA",1506.0,"therm-stick-73135oFt6za",93.0],["IND",1505.0,"therm-stick-129695ESujq",93.0],["TWN",1504.0,"therm-stick-76455vSg5MhwB",93.0],["KOR",1503.0,"therm-stick-32585ObRBsk5xa",93.0],["CHN",1503.0,"therm-stick-91265GifPJrF",93.0],["USA",1502.0,"therm-stick-97535MWt6ZbnpNU",93.0],["POL",1502.0,"therm-stick-82765XSbbDu",93.0],["SWE",1493.0,"therm-stick-100505ZPFgeZ",93.0],["FRA",1489.0,"therm-stick-698451bgbl2r",93.0],["CHN",1485.0,"therm-stick-215958JNOlj12",93.0],["ZAF",1481.0,"therm-stick-108785O6uggZKCl",93.0],["AUS",1478.0,"therm-stick-1242554AzIHsgUKv",93.0],["USA",1478.0,"therm-stick-28925pX4ieE5bA",93.0],["DEU",1477.0,"therm-stick-152125BCFIiQ",93.0],["USA",1471.0,"therm-stick-159745RY0tUUym",93.0],["USA",1469.0,"therm-stick-83935QoABZ3h9h",93.0],["AUS",1468.0,"therm-stick-6475UEhOOJ4e8",93.0],["JPN",1462.0,"therm-stick-4055SNv0DsY5Qk",93.0],["SWE",1461.0,"therm-stick-191545DO70fnS",93.0],["USA",1444.0,"therm-stick-18581588BjzYQBe",93.0],["USA",1444.0,"therm-stick-149825jiNsvEoff",93.0],["USA",1443.0,"therm-stick-139325nO7HiUyft",93.0],["NLD",1439.0,"therm-stick-89525XKjhK18g5",93.0],["USA",1432.0,"therm-stick-174125dypzGbN",93.0],["FRA",1431.0,"therm-stick-81245gmU1Yh",93.0],["AUS",1418.0,"therm-stick-1617854nbyE2DS31",93.0],["CAN",1418.0,"therm-stick-148535YCpNuKrw",93.0],["USA",1416.0,"therm-stick-88615esWpbipA",93.0],["SWE",1411.0,"therm-stick-68905KyPWc9yd0",93.0],["RUS",1402.0,"therm-stick-180785oW1E6Pja83",93.0],["USA",1594.0,"therm-stick-154025NVi3h8RCn",94.0],["DEU",1593.0,"therm-stick-184985IEilR2",94.0],["CHN",1582.0,"therm-stick-116455T7WMR2s5cL",94.0],["USA",1578.0,"therm-stick-155915QrRZaIE",94.0],["FRA",1577.0,"therm-stick-89005izjQCb5A",94.0],["USA",1576.0,"therm-stick-103595M1hm6Ak",94.0],["JPN",1572.0,"therm-stick-17095tgET4z",94.0],["USA",1566.0,"therm-stick-620052d72kmbEv",94.0],["USA",1564.0,"therm-stick-62195st1KzQz8R",94.0],["MEX",1559.0,"therm-stick-60475objf0ink",94.0],["FRA",1557.0,"therm-stick-36395zxK8u",94.0],["CHN",1555.0,"therm-stick-31355RPcaC",94.0],["USA",1547.0,"therm-stick-185S2B0z",94.0],["USA",1544.0,"therm-stick-150145stk1M",94.0],["RUS",1542.0,"therm-stick-99588wvF",94.0],["DEU",1532.0,"therm-stick-164785KTV5xOfTqR",94.0],["CHN",1527.0,"therm-stick-168025Ue1DP5lbA",94.0],["LVA",1525.0,"therm-stick-314358r75fSpE",94.0],["BRA",1522.0,"therm-stick-170315LwK9dlAtA",94.0],["BGD",1521.0,"therm-stick-175855r3HMZwgs82",94.0],["USA",1516.0,"therm-stick-1778586lwZQOMkz",94.0],["BEL",1514.0,"therm-stick-162265PyBGMNGzdE",94.0],["BRA",1512.0,"therm-stick-63655jLsA44d",94.0],["USA",1510.0,"therm-stick-33325oTK4v",94.0],["USA",1505.0,"therm-stick-175535mJcdU1N",94.0],["USA",1501.0,"therm-stick-30325BIUW4C",94.0],["USA",1501.0,"therm-stick-61445AvEvhQgG26",94.0],["USA",1490.0,"therm-stick-914154p1eie",94.0],["FRA",1489.0,"therm-stick-64295frOeOGS",94.0],["GBR",1487.0,"therm-stick-9605zmBCzRsF",94.0],["DNK",1479.0,"therm-stick-101995qnKLI1",94.0],["USA",1472.0,"therm-stick-189295uRvGSecMr",94.0],["USA",1470.0,"therm-stick-18179521ww1r",94.0],["POL",1466.0,"therm-stick-6145rCvGvYnX",94.0],["USA",1461.0,"therm-stick-148075v4s3n",94.0],["BRA",1459.0,"therm-stick-49145vouLti",94.0],["POL",1457.0,"therm-stick-176305ysp6hi",94.0],["CHN",1456.0,"therm-stick-76985Pj9Tus7Oaq",94.0],["RUS",1454.0,"therm-stick-95155HCMnscd4aS",94.0],["USA",1451.0,"therm-stick-593651rhnjh8F6",94.0],["USA",1447.0,"therm-stick-104995yT3axWueGH",94.0],["IND",1438.0,"therm-stick-42395VdXDtjLu",94.0],["RUS",1437.0,"therm-stick-12365mxVGIYAw",94.0],["USA",1434.0,"therm-stick-45395DuWWXOuRBx",94.0],["USA",1434.0,"therm-stick-1394358ziMQ0KL",94.0],["USA",1431.0,"therm-stick-144835PKpBSY",94.0],["SWE",1431.0,"therm-stick-61475nC8sp",94.0],["JPN",1419.0,"therm-stick-1941953S9td",94.0],["CHN",1402.0,"therm-stick-47485EDolSB1",94.0],["USA",1593.0,"therm-stick-161615UrEuTHj6SC",95.0],["USA",1593.0,"therm-stick-177575xFvcs2t",95.0],["JPN",1593.0,"therm-stick-187295T5wWyLr",95.0],["HKG",1583.0,"therm-stick-76085fqYyStRlA",95.0],["USA",1578.0,"therm-stick-6815DPjLa",95.0],["RUS",1578.0,"therm-stick-60905B3FRX",95.0],["POL",1575.0,"therm-stick-37015D7dGavCfI",95.0],["CYP",1571.0,"therm-stick-141745e4mvUeaX1t",95.0],["CAN",1568.0,"therm-stick-121135N0RZrm9",95.0],["JPN",1557.0,"therm-stick-266457bSDyxaoE",95.0],["ESP",1557.0,"therm-stick-46085MiHlDfMb2",95.0],["USA",1555.0,"therm-stick-230350mxI2",95.0],["JPN",1553.0,"therm-stick-134305fxJq9rFoyQ",95.0],["USA",1549.0,"therm-stick-131495fjYAWCu9",95.0],["USA",1544.0,"therm-stick-154265yC9seTiIG",95.0],["KOR",1539.0,"therm-stick-161755HBqKoTc",95.0],["USA",1534.0,"therm-stick-3659zkf1b89Q",95.0],["SVN",1527.0,"therm-stick-98965Oz8wyOG",95.0],["KOR",1526.0,"therm-stick-197725ZQwebq",95.0],["IDN",1517.0,"therm-stick-176795k5mqX9",95.0],["USA",1515.0,"therm-stick-3395AhZeV",95.0],["POL",1512.0,"therm-stick-1217153Io6OTmBfz",95.0],["KOR",1511.0,"therm-stick-1502653ExTV",95.0],["POL",1507.0,"therm-stick-128845D7Fgt",95.0],["LVA",1500.0,"therm-stick-59455acbHBw5",95.0],["USA",1499.0,"therm-stick-106315nhORm7",95.0],["USA",1495.0,"therm-stick-15955d82ccb",95.0],["NLD",1495.0,"therm-stick-176585Jm5Ls2",95.0],["USA",1494.0,"therm-stick-189515ZCF4Vc",95.0],["GBR",1494.0,"therm-stick-170045Y28ygOibaN",95.0],["USA",1489.0,"therm-stick-1906551Et4DNi",95.0],["FRA",1479.0,"therm-stick-264858j4pJKk9LF",95.0],["USA",1476.0,"therm-stick-62185hluNFuBVB",95.0],["BHR",1468.0,"therm-stick-164572xLY7C",95.0],["RUS",1467.0,"therm-stick-124355eaG91sy0",95.0],["USA",1464.0,"therm-stick-24605S0pRzWOl",95.0],["USA",1463.0,"therm-stick-106555E7LVgx",95.0],["USA",1463.0,"therm-stick-93095VcY955E",95.0],["DEU",1459.0,"therm-stick-56245TTGUsLf",95.0],["RUS",1441.0,"therm-stick-84995R2YYLj",95.0],["USA",1440.0,"therm-stick-681358NtdB",95.0],["USA",1431.0,"therm-stick-35635bT7YmI",95.0],["CAN",1431.0,"therm-stick-92975H5ws2mx",95.0],["RUS",1421.0,"therm-stick-84455uPFAQ",95.0],["USA",1416.0,"therm-stick-126785TEPsf",95.0],["NLD",1406.0,"therm-stick-120385WKOX4UuRV",95.0],["USA",1406.0,"therm-stick-156085EZLiRSe",95.0],["USA",1598.0,"therm-stick-142325Z8fua9fWT",96.0],["USA",1596.0,"therm-stick-336656ljhgFWT",96.0],["USA",1593.0,"therm-stick-974752h4H5n",96.0],["USA",1592.0,"therm-stick-507050XzTq17",96.0],["NLD",1592.0,"therm-stick-172835LBB58M7",96.0],["USA",1581.0,"therm-stick-165625esbtPoLbW",96.0],["AUT",1577.0,"therm-stick-1260351TBla6i",96.0],["CHN",1575.0,"therm-stick-128605t6XZ2HbK",96.0],["USA",1570.0,"therm-stick-184105g8kxsTRfj",96.0],["KOR",1569.0,"therm-stick-812159B3b2c9RdH",96.0],["USA",1557.0,"therm-stick-188545Y6j42xTL",96.0],["MCO",1556.0,"therm-stick-474351n04UXX",96.0],["USA",1553.0,"therm-stick-735952UpVszde",96.0],["USA",1546.0,"therm-stick-33035cSu701x",96.0],["USA",1542.0,"therm-stick-7105RlvK3nvdZ",96.0],["POL",1531.0,"therm-stick-128275tpgxicS",96.0],["USA",1528.0,"therm-stick-50435cvDlzK5nP",96.0],["USA",1528.0,"therm-stick-61825gltKY7wQ",96.0],["KOR",1519.0,"therm-stick-197075ro7uub",96.0],["USA",1518.0,"therm-stick-61115KGSxGkUD",96.0],["CHN",1516.0,"therm-stick-28495SWUdctbXx",96.0],["KOR",1513.0,"therm-stick-197605lHNKNxmo",96.0],["TUR",1509.0,"therm-stick-75605eKFd1g",96.0],["CHN",1496.0,"therm-stick-38815XarRwPeDym",96.0],["CHN",1495.0,"therm-stick-80305UTzaR",96.0],["USA",1489.0,"therm-stick-1394051xsjmYxo",96.0],["DEU",1485.0,"therm-stick-187075ohtF7",96.0],["USA",1483.0,"therm-stick-93535AKdVD8HAi",96.0],["USA",1479.0,"therm-stick-22075RG5uCqD3y",96.0],["USA",1476.0,"therm-stick-86425VvPCuPvcIa",96.0],["MYS",1475.0,"therm-stick-194125SawStreKc0",96.0],["KOR",1475.0,"therm-stick-143465bu7aQb",96.0],["AUS",1471.0,"therm-stick-41675LdYtoa",96.0],["USA",1463.0,"therm-stick-167735JTUe02XeD",96.0],["USA",1463.0,"therm-stick-17455XXC2HrT",96.0],["BGR",1459.0,"therm-stick-60125JdvscSvc",96.0],["USA",1452.0,"therm-stick-1138756OAXn",96.0],["NLD",1449.0,"therm-stick-16555gCW8XtW",96.0],["ITA",1434.0,"therm-stick-39875f4DfaCCBNu",96.0],["USA",1433.0,"therm-stick-176135qF89l",96.0],["USA",1431.0,"therm-stick-5845HrAOiToPS",96.0],["CHN",1430.0,"therm-stick-105635bN8VYvPw",96.0],["USA",1428.0,"therm-stick-400556GLHsJccD5",96.0],["JPN",1427.0,"therm-stick-143525Wi4JphaN",96.0],["AUS",1427.0,"therm-stick-1553456Y4IaR",96.0],["ITA",1420.0,"therm-stick-86957xBxa",96.0],["USA",1411.0,"therm-stick-108635OeELTcr",96.0],["TWN",1401.0,"therm-stick-92935kZpkmZ0szq",96.0],["ITA",1401.0,"therm-stick-131515yQnU2G6zOJ",96.0],["USA",1596.0,"therm-stick-142225XrtxJuT",97.0],["ESP",1594.0,"therm-stick-1251051rOhD9V",97.0],["USA",1591.0,"therm-stick-281755HNAXeHDhP",97.0],["IND",1587.0,"therm-stick-126485M4hlabjj",97.0],["ITA",1585.0,"therm-stick-88015oDh8TfOM",97.0],["FRA",1584.0,"therm-stick-164215mXxlqHSnkS",97.0],["USA",1584.0,"therm-stick-18835oU7qoJeZE3",97.0],["CHN",1582.0,"therm-stick-196475BOVs68zN",97.0],["JPN",1580.0,"therm-stick-175385CjR1Skv",97.0],["USA",1569.0,"therm-stick-1537850JLLlhD",97.0],["GRD",1565.0,"therm-stick-148285Sx4euuy",97.0],["FIN",1565.0,"therm-stick-89515XHXTBpJNr",97.0],["USA",1563.0,"therm-stick-74585b8VMQK2",97.0],["HUN",1556.0,"therm-stick-34685zqIlB",97.0],["CHN",1553.0,"therm-stick-123235S9wK1wc7wo",97.0],["USA",1550.0,"therm-stick-176225cYSVaXD",97.0],["ECU",1550.0,"therm-stick-196285YW9jq1p",97.0],["POL",1547.0,"therm-stick-677052speWgmxx",97.0],["JPN",1544.0,"therm-stick-123115Cn11BmLY",97.0],["CHN",1537.0,"therm-stick-34895CUevU",97.0],["CAN",1536.0,"therm-stick-121495R3TpSXY",97.0],["USA",1535.0,"therm-stick-158185sqXeLJ9rOf",97.0],["USA",1533.0,"therm-stick-134405tcmq2AqGAl",97.0],["KOR",1521.0,"therm-stick-84785loGOl",97.0],["CHN",1519.0,"therm-stick-24635gwYJIL1",97.0],["CAN",1516.0,"therm-stick-121235atc7Y0tdLA",97.0],["USA",1512.0,"therm-stick-194645phKZTYT6E",97.0],["NLD",1508.0,"therm-stick-179375taSUg5oG",97.0],["IND",1503.0,"therm-stick-128885kaf1r9PR8P",97.0],["CHN",1501.0,"therm-stick-86705XJq25uE10",97.0],["CHN",1501.0,"therm-stick-83756OslP",97.0],["ZAF",1500.0,"therm-stick-39175HUw3M2S3c",97.0],["UKR",1499.0,"therm-stick-153515Mg6rOP",97.0],["SWE",1487.0,"therm-stick-46415L7pFG15",97.0],["KOR",1480.0,"therm-stick-64835jZIy1Jvj",97.0],["JPN",1471.0,"therm-stick-174295Qa1diVVkT",97.0],["JPN",1459.0,"therm-stick-35795kTkyp",97.0],["NLD",1451.0,"therm-stick-84925dtsz7ZJZ8d",97.0],["HKG",1451.0,"therm-stick-130895An92wckv",97.0],["BLR",1449.0,"therm-stick-18801565Kd3",97.0],["USA",1446.0,"therm-stick-81265HX2qph",97.0],["SWE",1445.0,"therm-stick-52285ZHCZUck",97.0],["USA",1425.0,"therm-stick-166405SSnHOSy1R",97.0],["CZE",1423.0,"therm-stick-57455vRZlgKkGCP",97.0],["SWE",1410.0,"therm-stick-1253757jAenJ0qw",97.0],["CHN",1409.0,"therm-stick-88775bkdFXXI",97.0],["RUS",1405.0,"therm-stick-1175354rjyXQ",97.0],["USA",1591.0,"therm-stick-153535elB9iSblo",98.0],["USA",1578.0,"therm-stick-450255EFonl",98.0],["USA",1577.0,"therm-stick-14575Kn5vjClkX",98.0],["GBR",1576.0,"therm-stick-145655D4IcZaUoIx",98.0],["USA",1573.0,"therm-stick-194705GvZ06r9lyF",98.0],["USA",1570.0,"therm-stick-84095I6bsr9",98.0],["KNA",1568.0,"therm-stick-172465HnGxY",98.0],["CHN",1562.0,"therm-stick-9545qKZ6qyPd",98.0],["USA",1552.0,"therm-stick-697455eFyVJTI3Q",98.0],["USA",1543.0,"therm-stick-168125eiCIj",98.0],["CHL",1543.0,"therm-stick-77315qWEn9q",98.0],["USA",1542.0,"therm-stick-66905RdrLFkeT",98.0],["CAN",1538.0,"therm-stick-8405dWMHDBW",98.0],["BEL",1536.0,"therm-stick-171185XpJ1jw",98.0],["CHN",1533.0,"therm-stick-190315uB0hx2qdc",98.0],["USA",1531.0,"therm-stick-52945XdzKe0",98.0],["USA",1526.0,"therm-stick-189085nkcoTQUnt",98.0],["LVA",1523.0,"therm-stick-101515DUXiPAsmU",98.0],["USA",1522.0,"therm-stick-21955xhOSZAwKhN",98.0],["CHN",1520.0,"therm-stick-1191356OdYLxga",98.0],["USA",1520.0,"therm-stick-23795OfnNw",98.0],["DEU",1517.0,"therm-stick-40495EyEcJ1C",98.0],["USA",1512.0,"therm-stick-12625kkUrcmT",98.0],["SRB",1492.0,"therm-stick-1374352gQQ7",98.0],["COL",1488.0,"therm-stick-59515IfB7dM44",98.0],["RUS",1475.0,"therm-stick-177815M8oJ71wZnC",98.0],["USA",1470.0,"therm-stick-93965UZUGfrM",98.0],["USA",1469.0,"therm-stick-193525NNttT",98.0],["USA",1463.0,"therm-stick-110785pNOXuEv82",98.0],["USA",1462.0,"therm-stick-131735heZzZ29U9",98.0],["USA",1461.0,"therm-stick-106135gFnASgaXOP",98.0],["BRA",1461.0,"therm-stick-160225OXUD0BXxmv",98.0],["USA",1460.0,"therm-stick-989959Z6NKcDuu",98.0],["JPN",1457.0,"therm-stick-38965t2fyfN7",98.0],["RUS",1455.0,"therm-stick-97235D9f5pYAn",98.0],["USA",1455.0,"therm-stick-170825OVuN4",98.0],["IND",1454.0,"therm-stick-40195uwH1AG",98.0],["SGP",1454.0,"therm-stick-100145TuXiWPiO",98.0],["TUR",1449.0,"therm-stick-131225GBbthin",98.0],["USA",1443.0,"therm-stick-59185PffJhvuk0B",98.0],["USA",1442.0,"therm-stick-37295PlJGahVr",98.0],["FIN",1439.0,"therm-stick-163495F1zUha",98.0],["CHN",1436.0,"therm-stick-796751RgNo962G",98.0],["RUS",1434.0,"therm-stick-142855RtE8tIv",98.0],["SWE",1430.0,"therm-stick-45905eDuDizj",98.0],["CRI",1426.0,"therm-stick-189955yKQ49zNP",98.0],["HKG",1422.0,"therm-stick-74725VsnBKbnJ",98.0],["AUS",1420.0,"therm-stick-177175i6SoT",98.0],["USA",1417.0,"therm-stick-177445QUIzmh4x8",98.0],["LVA",1411.0,"therm-stick-146065AtcGg6cMG",98.0],["USA",1405.0,"therm-stick-12505hO9AgS",98.0],["IND",1598.0,"therm-stick-108985HWoAu25YT8",99.0],["RUS",1596.0,"therm-stick-158365kp7IGW",99.0],["HKG",1585.0,"therm-stick-182045qbMxpGh",99.0],["COL",1585.0,"therm-stick-1209255T4nl",99.0],["DEU",1585.0,"therm-stick-143005njFwgCZ78K",99.0],["USA",1584.0,"therm-stick-59005BGlbIWugGk",99.0],["JPN",1583.0,"therm-stick-64745jMebV",99.0],["USA",1581.0,"therm-stick-196645cT64FSOnER",99.0],["USA",1577.0,"therm-stick-58355A0Gusyub",99.0],["KOR",1574.0,"therm-stick-48595nbQUduXY",99.0],["USA",1568.0,"therm-stick-105605hVdAawfQ8",99.0],["DNK",1552.0,"therm-stick-152215pOmZZ1jPpf",99.0],["GBR",1542.0,"therm-stick-9265BHlgoPrYZ",99.0],["PHL",1538.0,"therm-stick-72235BFFecY4kvM",99.0],["KOR",1532.0,"therm-stick-197515RxNvTe9PPW",99.0],["USA",1525.0,"therm-stick-707057J7k9",99.0],["USA",1519.0,"therm-stick-33865pHIWROZr",99.0],["JPN",1515.0,"therm-stick-176315dSWbWE",99.0],["USA",1510.0,"therm-stick-1259955EsjU7",99.0],["USA",1506.0,"therm-stick-94165jFek48ae",99.0],["PHL",1506.0,"therm-stick-32335irondHQ0C",99.0],["RUS",1499.0,"therm-stick-67315aHZ7y",99.0],["HUN",1497.0,"therm-stick-67295c0uuR",99.0],["USA",1491.0,"therm-stick-499851G8RVWPR",99.0],["USA",1491.0,"therm-stick-175555ZzFGC8k",99.0],["DEU",1484.0,"therm-stick-113585NqlngVa",99.0],["NOR",1481.0,"therm-stick-130625JObv71gO",99.0],["USA",1479.0,"therm-stick-15685gfy3Q",99.0],["ARE",1473.0,"therm-stick-19085JEFwNh",99.0],["JPN",1469.0,"therm-stick-38825Z6iqUL7nn",99.0],["CZE",1461.0,"therm-stick-158215pzB4TBT",99.0],["USA",1453.0,"therm-stick-97975BFGeg8gRDq",99.0],["USA",1452.0,"therm-stick-137725drzKk",99.0],["JPN",1439.0,"therm-stick-184655LASGcJxjVC",99.0],["BGD",1433.0,"therm-stick-36935SMJL0EAm",99.0],["USA",1426.0,"therm-stick-81505CJrXO",99.0],["AUS",1424.0,"therm-stick-1544153boVsSnY2S",99.0],["CHN",1403.0,"therm-stick-172525cJ7U05k",99.0],["USA",1402.0,"therm-stick-152645cwSuPTK",99.0],["CAN",1401.0,"therm-stick-142405jzXaLtN2",99.0],["USA",1401.0,"therm-stick-51175edMCWcTPl",99.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"cca3","type":"\"string\""},{"name":"c02_level","type":"\"long\""},{"name":"device_name","type":"\"string\""},{"name":"humidity","type":"\"long\""}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"Error in SQL statement: AnalysisException: expression 'device_id' is neither present in the group by, nor is it an aggregate function. Add to group by or wrap in first() (or first_value) if you don't care which value you get.;","error":"com.databricks.backend.common.rpc.DatabricksExceptions$SQLExecutionException: org.apache.spark.sql.AnalysisException: expression 'device_id' is neither present in the group by, nor is it an aggregate function. Add to group by or wrap in first() (or first_value) if you don't care which value you get.;\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$class.failAnalysis(CheckAnalysis.scala:38)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.failAnalysis(Analyzer.scala:44)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1.org$apache$spark$sql$catalyst$analysis$CheckAnalysis$class$$anonfun$$checkValidAggregateExpression$1(CheckAnalysis.scala:130)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1$$anonfun$apply$4.apply(CheckAnalysis.scala:158)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1$$anonfun$apply$4.apply(CheckAnalysis.scala:158)\n\tat scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:47)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1.apply(CheckAnalysis.scala:158)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1.apply(CheckAnalysis.scala:50)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:121)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$class.checkAnalysis(CheckAnalysis.scala:50)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.checkAnalysis(Analyzer.scala:44)\n\tat org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:34)\n\tat org.apache.spark.sql.DataFrame.<init>(DataFrame.scala:133)\n\tat org.apache.spark.sql.DataFrame$.apply(DataFrame.scala:52)\n\tat org.apache.spark.sql.SQLContext.sql(SQLContext.scala:816)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal$$anonfun$1.apply(SQLDriverLocal.scala:71)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal$$anonfun$1.apply(SQLDriverLocal.scala:29)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:244)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:244)\n\tat scala.collection.immutable.List.foreach(List.scala:318)\n\tat scala.collection.TraversableLike$class.map(TraversableLike.scala:244)\n\tat scala.collection.AbstractTraversable.map(Traversable.scala:105)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.executeSql(SQLDriverLocal.scala:29)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.repl(SQLDriverLocal.scala:116)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:157)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:157)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:83)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:57)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:78)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:30)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:116)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:30)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:156)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$3.apply(DriverWrapper.scala:483)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$3.apply(DriverWrapper.scala:483)\n\tat scala.util.Try$.apply(Try.scala:161)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:480)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:381)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:212)\n\tat java.lang.Thread.run(Thread.java:745)\n\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.executeSql(SQLDriverLocal.scala:104)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.repl(SQLDriverLocal.scala:116)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:157)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:157)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:83)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:57)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:78)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:30)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:116)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:30)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:156)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$3.apply(DriverWrapper.scala:483)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$3.apply(DriverWrapper.scala:483)\n\tat scala.util.Try$.apply(Try.scala:161)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:480)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:381)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:212)\n\tat java.lang.Thread.run(Thread.java:745)\n","workflows":[],"startTime":1.458174596729E12,"submitTime":1.458174592243E12,"finishTime":1.458174597692E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"245.5","xColumns":["cca3"],"yColumns":["c02_level"],"pivotColumns":[],"pivotAggregation":"count","customPlotOptions":{"pieChart":[{"key":"donut","value":true}],"barChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}],"mapPlot":[],"areaChart":[{"key":"grouped","value":false},{"key":"stacked","value":true},{"key":"100_stacked","value":false}],"lineChart":[]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jules.damji@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"37934a9e-d3ea-473e-8623-88e476d961fe"},{"version":"CommandV1","origId":922964923687090,"guid":"1c574fac-75da-4209-a4c8-21d80fd5a491","subtype":"command","commandType":"auto","position":4.0,"command":"%sql select cca3, c02_level from iot_device_data where c02_level > 1400 order by c02_level desc","commandVersion":0,"state":"finished","results":{"type":"table","data":[["FRA",1599.0],["MCO",1599.0],["USA",1599.0],["RUS",1599.0],["USA",1599.0],["CHN",1599.0],["USA",1599.0],["USA",1599.0],["AUS",1599.0],["CAN",1599.0],["USA",1599.0],["USA",1599.0],["THA",1599.0],["FRA",1599.0],["USA",1599.0],["JPN",1599.0],["JPN",1599.0],["USA",1599.0],["USA",1599.0],["USA",1599.0],["SWE",1599.0],["KOR",1599.0],["USA",1599.0],["USA",1599.0],["USA",1599.0],["JPN",1599.0],["HKG",1599.0],["ITA",1599.0],["KOR",1599.0],["USA",1599.0],["GBR",1599.0],["RUS",1599.0],["KOR",1599.0],["IDN",1599.0],["DEU",1599.0],["USA",1599.0],["KOR",1599.0],["USA",1599.0],["BRA",1599.0],["SWE",1599.0],["USA",1599.0],["CAN",1599.0],["JPN",1599.0],["PAK",1599.0],["TWN",1599.0],["MEX",1599.0],["CHN",1599.0],["USA",1599.0],["USA",1599.0],["MEX",1599.0],["USA",1599.0],["USA",1599.0],["BRA",1599.0],["JPN",1599.0],["AZE",1599.0],["AUS",1599.0],["JPN",1599.0],["SGP",1599.0],["GBR",1599.0],["BRA",1599.0],["CHN",1599.0],["USA",1599.0],["RUS",1599.0],["KOR",1599.0],["USA",1599.0],["CHN",1599.0],["USA",1599.0],["DEU",1599.0],["USA",1599.0],["USA",1599.0],["USA",1599.0],["ROU",1599.0],["FRA",1599.0],["USA",1599.0],["USA",1599.0],["USA",1599.0],["DEU",1599.0],["JPN",1599.0],["USA",1599.0],["BEL",1599.0],["FRA",1599.0],["USA",1599.0],["RUS",1599.0],["JPN",1599.0],["USA",1599.0],["USA",1599.0],["USA",1599.0],["RUS",1599.0],["GBR",1599.0],["USA",1599.0],["USA",1599.0],["USA",1599.0],["GBR",1599.0],["USA",1599.0],["DEU",1599.0],["CAN",1599.0],["JPN",1599.0],["IND",1599.0],["JPN",1599.0],["CHN",1599.0],["CHN",1599.0],["USA",1599.0],["TWN",1599.0],["BRA",1599.0],["USA",1599.0],["CHN",1599.0],["ITA",1599.0],["USA",1599.0],["USA",1599.0],["USA",1599.0],["JPN",1599.0],["USA",1599.0],["USA",1599.0],["USA",1599.0],["IRL",1599.0],["USA",1599.0],["USA",1599.0],["USA",1599.0],["USA",1599.0],["CAN",1599.0],["USA",1599.0],["USA",1599.0],["ITA",1599.0],["USA",1599.0],["USA",1599.0],["USA",1599.0],["USA",1599.0],["KOR",1599.0],["USA",1599.0],["CHN",1599.0],["CHN",1599.0],["KOR",1599.0],["DEU",1599.0],["DEU",1599.0],["KOR",1599.0],["USA",1599.0],["CHN",1599.0],["USA",1599.0],["PAN",1599.0],["GBR",1599.0],["KOR",1599.0],["DEU",1599.0],["USA",1599.0],["JPN",1599.0],["BRA",1599.0],["SWE",1599.0],["USA",1599.0],["USA",1599.0],["USA",1599.0],["BRA",1599.0],["USA",1599.0],["USA",1599.0],["KOR",1599.0],["USA",1599.0],["POL",1599.0],["USA",1599.0],["DNK",1599.0],["HUN",1599.0],["CHN",1599.0],["ESP",1599.0],["CAN",1599.0],["USA",1599.0],["GBR",1599.0],["KAZ",1599.0],["DEU",1599.0],["ESP",1599.0],["USA",1599.0],["JPN",1599.0],["USA",1599.0],["CHN",1599.0],["EGY",1599.0],["KOR",1599.0],["USA",1599.0],["USA",1599.0],["MEX",1599.0],["DEU",1599.0],["USA",1599.0],["DEU",1599.0],["CHN",1599.0],["CAN",1599.0],["USA",1599.0],["CHN",1599.0],["ESP",1599.0],["RUS",1599.0],["ESP",1599.0],["GBR",1599.0],["TWN",1599.0],["USA",1599.0],["CHN",1599.0],["USA",1599.0],["CHN",1599.0],["USA",1599.0],["CHN",1599.0],["DNK",1599.0],["CHN",1599.0],["LVA",1599.0],["USA",1599.0],["USA",1599.0],["DEU",1599.0],["GBR",1599.0],["USA",1599.0],["USA",1599.0],["AUS",1599.0],["USA",1599.0],["IDN",1599.0],["ARG",1599.0],["KOR",1599.0],["RUS",1599.0],["USA",1599.0],["DNK",1599.0],["JPN",1599.0],["JPN",1599.0],["CZE",1599.0],["SWE",1599.0],["USA",1599.0],["UKR",1599.0],["ESP",1599.0],["FRA",1599.0],["ARE",1599.0],["KOR",1599.0],["USA",1599.0],["USA",1599.0],["RUS",1599.0],["USA",1599.0],["DEU",1599.0],["CHE",1599.0],["TZA",1599.0],["IND",1599.0],["USA",1599.0],["LTU",1599.0],["USA",1599.0],["ITA",1599.0],["MEX",1599.0],["THA",1599.0],["PRI",1599.0],["NLD",1599.0],["DEU",1599.0],["USA",1599.0],["USA",1599.0],["TWN",1599.0],["DEU",1599.0],["JPN",1599.0],["USA",1599.0],["USA",1599.0],["USA",1599.0],["CHN",1599.0],["HKG",1599.0],["AUS",1599.0],["FRA",1599.0],["CHN",1599.0],["DNK",1599.0],["KOR",1599.0],["JPN",1599.0],["DEU",1599.0],["CHN",1599.0],["ESP",1599.0],["DEU",1599.0],["ISR",1599.0],["USA",1599.0],["FRA",1599.0],["CAN",1599.0],["KOR",1599.0],["KOR",1599.0],["CHN",1599.0],["KOR",1599.0],["CHN",1599.0],["ESP",1598.0],["IND",1598.0],["USA",1598.0],["USA",1598.0],["USA",1598.0],["UKR",1598.0],["USA",1598.0],["ROU",1598.0],["USA",1598.0],["USA",1598.0],["CHN",1598.0],["GBR",1598.0],["CHN",1598.0],["JPN",1598.0],["USA",1598.0],["ITA",1598.0],["USA",1598.0],["USA",1598.0],["USA",1598.0],["SLV",1598.0],["CHN",1598.0],["USA",1598.0],["CHE",1598.0],["KOR",1598.0],["GBR",1598.0],["GBR",1598.0],["PAK",1598.0],["USA",1598.0],["USA",1598.0],["USA",1598.0],["USA",1598.0],["DEU",1598.0],["QAT",1598.0],["EST",1598.0],["USA",1598.0],["USA",1598.0],["USA",1598.0],["RUS",1598.0],["USA",1598.0],["CAN",1598.0],["USA",1598.0],["SRB",1598.0],["FRA",1598.0],["KOR",1598.0],["DEU",1598.0],["GBR",1598.0],["USA",1598.0],["BRA",1598.0],["USA",1598.0],["CHN",1598.0],["USA",1598.0],["USA",1598.0],["IND",1598.0],["BGR",1598.0],["POL",1598.0],["UKR",1598.0],["IDN",1598.0],["USA",1598.0],["CZE",1598.0],["KOR",1598.0],["BGD",1598.0],["JPN",1598.0],["JPN",1598.0],["IDN",1598.0],["KOR",1598.0],["USA",1598.0],["CHN",1598.0],["USA",1598.0],["RUS",1598.0],["CHN",1598.0],["USA",1598.0],["USA",1598.0],["USA",1598.0],["USA",1598.0],["USA",1598.0],["USA",1598.0],["CHN",1598.0],["USA",1598.0],["USA",1598.0],["USA",1598.0],["JPN",1598.0],["USA",1598.0],["USA",1598.0],["KOR",1598.0],["KOR",1598.0],["USA",1598.0],["POL",1598.0],["USA",1598.0],["IND",1598.0],["USA",1598.0],["CHN",1598.0],["USA",1598.0],["GBR",1598.0],["USA",1598.0],["CHN",1598.0],["RUS",1598.0],["RUS",1598.0],["USA",1598.0],["CHN",1598.0],["DEU",1598.0],["AUS",1598.0],["PHL",1598.0],["THA",1598.0],["USA",1598.0],["USA",1598.0],["BRA",1598.0],["CHN",1598.0],["ISR",1598.0],["MYS",1598.0],["CAN",1598.0],["JPN",1598.0],["CHN",1598.0],["ESP",1598.0],["USA",1598.0],["JPN",1598.0],["CHE",1598.0],["KOR",1598.0],["AUT",1598.0],["USA",1598.0],["KOR",1598.0],["BGR",1598.0],["USA",1598.0],["ESP",1598.0],["USA",1598.0],["USA",1598.0],["ITA",1598.0],["DNK",1598.0],["USA",1598.0],["JPN",1598.0],["CHE",1598.0],["USA",1598.0],["AUS",1598.0],["USA",1598.0],["IND",1598.0],["PHL",1598.0],["CAN",1598.0],["CAN",1598.0],["USA",1598.0],["MEX",1598.0],["CAN",1598.0],["USA",1598.0],["USA",1598.0],["USA",1598.0],["USA",1598.0],["RUS",1598.0],["MYS",1598.0],["ITA",1598.0],["KOR",1598.0],["NLD",1598.0],["NLD",1598.0],["NLD",1598.0],["PER",1598.0],["CAN",1598.0],["USA",1598.0],["DEU",1598.0],["USA",1598.0],["CHN",1598.0],["UKR",1598.0],["USA",1598.0],["USA",1598.0],["DEU",1598.0],["USA",1598.0],["RUS",1598.0],["TWN",1598.0],["JPN",1598.0],["AUS",1598.0],["USA",1598.0],["CZE",1598.0],["USA",1598.0],["NOR",1598.0],["IRL",1598.0],["SRB",1598.0],["USA",1598.0],["NLD",1598.0],["USA",1598.0],["JPN",1598.0],["GBR",1598.0],["USA",1598.0],["MEX",1598.0],["DEU",1598.0],["GBR",1598.0],["CHN",1598.0],["AUS",1598.0],["TWN",1598.0],["CHN",1598.0],["SWE",1598.0],["USA",1598.0],["JPN",1598.0],["KOR",1598.0],["ESP",1598.0],["NLD",1598.0],["CHN",1598.0],["USA",1598.0],["BOL",1598.0],["USA",1598.0],["USA",1598.0],["CHN",1598.0],["USA",1598.0],["JPN",1598.0],["CAN",1598.0],["NLD",1598.0],["CHE",1598.0],["USA",1598.0],["USA",1598.0],["JPN",1598.0],["JPN",1598.0],["KOR",1598.0],["DEU",1598.0],["FRA",1598.0],["USA",1598.0],["JPN",1598.0],["AUS",1598.0],["USA",1598.0],["USA",1598.0],["USA",1598.0],["PHL",1598.0],["GBR",1598.0],["USA",1598.0],["USA",1598.0],["BGR",1598.0],["USA",1598.0],["IND",1598.0],["AUS",1598.0],["USA",1598.0],["GBR",1598.0],["KOR",1598.0],["UKR",1598.0],["KOR",1598.0],["CZE",1598.0],["CHN",1597.0],["USA",1597.0],["THA",1597.0],["USA",1597.0],["USA",1597.0],["USA",1597.0],["SWE",1597.0],["JPN",1597.0],["RUS",1597.0],["DEU",1597.0],["USA",1597.0],["USA",1597.0],["USA",1597.0],["TWN",1597.0],["DEU",1597.0],["ECU",1597.0],["TWN",1597.0],["USA",1597.0],["USA",1597.0],["MKD",1597.0],["ITA",1597.0],["USA",1597.0],["DEU",1597.0],["CZE",1597.0],["BLR",1597.0],["ESP",1597.0],["CAN",1597.0],["NOR",1597.0],["CHN",1597.0],["USA",1597.0],["USA",1597.0],["KOR",1597.0],["THA",1597.0],["CHN",1597.0],["KOR",1597.0],["UKR",1597.0],["USA",1597.0],["TUR",1597.0],["JPN",1597.0],["ISR",1597.0],["SLE",1597.0],["USA",1597.0],["JPN",1597.0],["USA",1597.0],["USA",1597.0],["USA",1597.0],["SVN",1597.0],["GBR",1597.0],["JPN",1597.0],["CZE",1597.0],["ISR",1597.0],["USA",1597.0],["POL",1597.0],["IRN",1597.0],["USA",1597.0],["USA",1597.0],["USA",1597.0],["POL",1597.0],["USA",1597.0],["NLD",1597.0],["CHN",1597.0],["JPN",1597.0],["IND",1597.0],["USA",1597.0],["USA",1597.0],["GBR",1597.0],["KOR",1597.0],["USA",1597.0],["USA",1597.0],["USA",1597.0],["PRI",1597.0],["BGR",1597.0],["USA",1597.0],["GRC",1597.0],["HKG",1597.0],["USA",1597.0],["JPN",1597.0],["ROU",1597.0],["BGR",1597.0],["USA",1597.0],["ESP",1597.0],["AUS",1597.0],["USA",1597.0],["DEU",1597.0],["USA",1597.0],["ITA",1597.0],["JPN",1597.0],["USA",1597.0],["JPN",1597.0],["USA",1597.0],["CAN",1597.0],["GBR",1597.0],["IDN",1597.0],["RUS",1597.0],["CHN",1597.0],["USA",1597.0],["GBR",1597.0],["JPN",1597.0],["KOR",1597.0],["BRA",1597.0],["AUT",1597.0],["CAN",1597.0],["AUS",1597.0],["JPN",1597.0],["TUR",1597.0],["JPN",1597.0],["CZE",1597.0],["SWE",1597.0],["PHL",1597.0],["USA",1597.0],["USA",1597.0],["KOR",1597.0],["FIN",1597.0],["BRA",1597.0],["IND",1597.0],["PHL",1597.0],["USA",1597.0],["TWN",1597.0],["FRA",1597.0],["JAM",1597.0],["USA",1597.0],["JPN",1597.0],["USA",1597.0],["COL",1597.0],["USA",1597.0],["ITA",1597.0],["USA",1597.0],["DEU",1597.0],["JPN",1597.0],["USA",1597.0],["USA",1597.0],["CHN",1597.0],["CAN",1597.0],["USA",1597.0],["USA",1597.0],["FRA",1597.0],["USA",1597.0],["FRA",1597.0],["DEU",1597.0],["FRA",1597.0],["FRA",1597.0],["SWE",1597.0],["CHE",1597.0],["CHN",1597.0],["USA",1597.0],["USA",1597.0],["HKG",1597.0],["IND",1597.0],["USA",1597.0],["USA",1597.0],["ITA",1597.0],["CAN",1597.0],["LTU",1597.0],["KOR",1597.0],["USA",1597.0],["AUT",1597.0],["USA",1597.0],["USA",1597.0],["JPN",1597.0],["GBR",1597.0],["USA",1597.0],["KOR",1597.0],["ECU",1597.0],["USA",1597.0],["TUR",1597.0],["ITA",1597.0],["RWA",1597.0],["DEU",1597.0],["ARG",1597.0],["USA",1597.0],["FRA",1597.0],["RUS",1597.0],["UKR",1597.0],["UKR",1597.0],["USA",1597.0],["JPN",1597.0],["JPN",1597.0],["USA",1597.0],["DEU",1597.0],["USA",1597.0],["DEU",1597.0],["KOR",1597.0],["URY",1597.0],["GRC",1597.0],["USA",1597.0],["USA",1597.0],["USA",1597.0],["USA",1597.0],["USA",1597.0],["USA",1597.0],["USA",1597.0],["KOR",1597.0],["CHN",1597.0],["RUS",1597.0],["FRA",1597.0],["USA",1597.0],["DEU",1597.0],["USA",1597.0],["CHN",1597.0],["USA",1597.0],["DEU",1597.0],["ECU",1597.0],["HUN",1597.0],["CAN",1597.0],["USA",1597.0],["DEU",1597.0],["USA",1597.0],["LTU",1597.0],["AUS",1597.0],["USA",1597.0],["KOR",1597.0],["JPN",1597.0],["DEU",1597.0],["USA",1597.0],["FRA",1597.0],["USA",1597.0],["NLD",1597.0],["ROU",1597.0],["DEU",1597.0],["USA",1597.0],["CAN",1597.0],["PER",1597.0],["JPN",1597.0],["CAN",1597.0],["HUN",1597.0],["POL",1597.0],["USA",1597.0],["ZAF",1597.0],["RUS",1597.0],["NLD",1597.0],["PAN",1597.0],["AUS",1597.0],["CHN",1597.0],["USA",1597.0],["GBR",1596.0],["CHN",1596.0],["DEU",1596.0],["USA",1596.0],["HUN",1596.0],["LVA",1596.0],["USA",1596.0],["USA",1596.0],["CHE",1596.0],["USA",1596.0],["SVK",1596.0],["CAN",1596.0],["USA",1596.0],["ESP",1596.0],["RUS",1596.0],["USA",1596.0],["USA",1596.0],["RUS",1596.0],["USA",1596.0],["USA",1596.0],["USA",1596.0],["DEU",1596.0],["CHE",1596.0],["USA",1596.0],["CAN",1596.0],["JPN",1596.0],["GBR",1596.0],["USA",1596.0],["USA",1596.0],["USA",1596.0],["USA",1596.0],["USA",1596.0],["CHN",1596.0],["USA",1596.0],["USA",1596.0],["AUS",1596.0],["CHN",1596.0],["JPN",1596.0],["FRA",1596.0],["GBR",1596.0],["ITA",1596.0],["USA",1596.0],["USA",1596.0],["NLD",1596.0],["USA",1596.0],["IND",1596.0],["BGR",1596.0],["SRB",1596.0],["BRA",1596.0],["CHN",1596.0],["JPN",1596.0],["CAN",1596.0],["RUS",1596.0],["JPN",1596.0],["HUN",1596.0],["ARM",1596.0],["POL",1596.0],["BRA",1596.0],["USA",1596.0],["USA",1596.0],["GBR",1596.0],["ROU",1596.0],["IRN",1596.0],["SWE",1596.0],["FRA",1596.0],["USA",1596.0],["ISR",1596.0],["KOR",1596.0],["TWN",1596.0],["CHN",1596.0],["USA",1596.0],["GRC",1596.0],["SWE",1596.0],["NLD",1596.0],["CHN",1596.0],["FRA",1596.0],["CHN",1596.0],["USA",1596.0],["USA",1596.0],["TWN",1596.0],["USA",1596.0],["MYS",1596.0],["USA",1596.0],["ITA",1596.0],["CAN",1596.0],["USA",1596.0],["USA",1596.0],["USA",1596.0],["USA",1596.0],["USA",1596.0],["USA",1596.0],["USA",1596.0],["USA",1596.0],["CHN",1596.0],["CHN",1596.0],["KOR",1596.0],["GBR",1596.0],["GBR",1596.0],["USA",1596.0],["KOR",1596.0],["USA",1596.0],["USA",1596.0],["USA",1596.0],["JPN",1596.0],["USA",1596.0],["CHN",1596.0],["ITA",1596.0],["SGP",1596.0],["CAN",1596.0],["USA",1596.0],["KOR",1596.0],["NLD",1596.0],["USA",1596.0],["USA",1596.0],["ARG",1596.0],["USA",1596.0],["USA",1596.0],["BRA",1596.0],["GBR",1596.0],["ITA",1596.0],["CHN",1596.0],["USA",1596.0],["NOR",1596.0],["AUS",1596.0],["USA",1596.0],["USA",1596.0],["CHN",1596.0],["USA",1596.0],["CHN",1596.0],["CHN",1596.0],["CHE",1596.0],["NLD",1596.0],["POL",1596.0],["RUS",1596.0],["FRA",1596.0],["USA",1596.0],["BRA",1596.0],["KOR",1596.0],["USA",1596.0],["MEX",1596.0],["ISL",1596.0],["NOR",1596.0],["KOR",1596.0],["USA",1596.0],["SWE",1596.0],["FIN",1596.0],["USA",1596.0],["USA",1596.0],["JPN",1596.0],["USA",1596.0],["POL",1596.0],["GBR",1596.0],["RUS",1596.0],["CHN",1596.0],["KOR",1596.0],["AUS",1596.0],["JPN",1596.0],["USA",1596.0],["USA",1596.0],["JPN",1596.0],["USA",1596.0],["DNK",1596.0],["FRA",1596.0],["JPN",1596.0],["CAN",1596.0],["CHN",1596.0],["USA",1596.0],["USA",1596.0],["FRA",1596.0],["USA",1596.0],["USA",1596.0],["USA",1596.0],["USA",1596.0],["JPN",1596.0],["CHN",1596.0],["FRO",1596.0],["USA",1596.0],["DEU",1596.0],["USA",1596.0],["USA",1596.0],["USA",1596.0],["DEU",1596.0],["KOR",1596.0],["USA",1596.0],["KOR",1596.0],["UKR",1596.0],["UKR",1596.0],["DEU",1596.0],["USA",1596.0],["CAN",1596.0],["USA",1596.0],["USA",1596.0],["FRA",1596.0],["CHN",1596.0],["RUS",1596.0],["USA",1596.0],["USA",1596.0],["USA",1596.0],["USA",1596.0],["GBR",1596.0],["BEL",1596.0],["COL",1596.0],["SWE",1596.0],["RUS",1596.0],["USA",1596.0],["COL",1596.0],["IRL",1596.0],["CHN",1596.0],["USA",1596.0],["USA",1596.0],["KOR",1596.0],["KOR",1596.0],["GBR",1596.0],["USA",1596.0],["PRT",1596.0],["USA",1596.0],["FRA",1596.0],["USA",1596.0],["GBR",1596.0],["DEU",1596.0],["USA",1596.0],["KOR",1596.0],["CAN",1596.0],["USA",1596.0],["ROU",1596.0],["LVA",1596.0],["USA",1596.0],["JPN",1596.0],["TWN",1596.0],["NLD",1596.0],["CAN",1596.0],["USA",1596.0],["SVN",1596.0],["POL",1595.0],["USA",1595.0],["USA",1595.0],["CHN",1595.0],["USA",1595.0],["CHN",1595.0],["USA",1595.0],["USA",1595.0],["USA",1595.0],["KOR",1595.0],["CZE",1595.0],["USA",1595.0],["USA",1595.0],["CHL",1595.0],["USA",1595.0],["BFA",1595.0],["USA",1595.0],["JEY",1595.0],["SGP",1595.0],["USA",1595.0],["DNK",1595.0],["USA",1595.0],["USA",1595.0],["USA",1595.0],["USA",1595.0],["USA",1595.0],["FRA",1595.0],["USA",1595.0],["USA",1595.0],["CHN",1595.0],["POL",1595.0],["FRA",1595.0],["BRA",1595.0],["AUS",1595.0],["USA",1595.0],["USA",1595.0],["JPN",1595.0],["AUS",1595.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"cca3","type":"\"string\""},{"name":"c02_level","type":"\"long\""}],"overflow":true,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"org.apache.spark.sql.AnalysisException: cannot resolve 'iot_device_data.c02_level' given input columns: [cca3, c02_level]; line 1 pos 13","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1.458174603605E12,"submitTime":1.458174599111E12,"finishTime":1.45817460462E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"pieChart","width":"1010.5","height":"402.5","xColumns":["cca3"],"yColumns":["c02_level"],"pivotColumns":[],"pivotAggregation":"count","customPlotOptions":{"mapPlot":[],"pieChart":[{"key":"donut","value":true}]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jules.damji@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"d60f7bc3-de8e-42fa-ae79-6de3b00b1113"},{"version":"CommandV1","origId":922964923687091,"guid":"64e8d8eb-c781-4f96-a21b-c288c5b04c4a","subtype":"command","commandType":"auto","position":5.0,"command":"%sql select cca3, count(distinct device_id) as devices from iot_device_data group by cca3 order by devices desc limit 10","commandVersion":0,"state":"finished","results":{"type":"table","data":[["USA",70405.0],["CHN",14455.0],["JPN",12100.0],["KOR",11879.0],["DEU",7942.0],["GBR",6486.0],["CAN",6041.0],["RUS",5989.0],["FRA",5305.0],["BRA",3224.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"cca3","type":"\"string\""},{"name":"devices","type":"\"long\""}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1.458175144461E12,"submitTime":1.458175139967E12,"finishTime":1.458175148864E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"335.5","xColumns":["cca3"],"yColumns":["device_id"],"pivotColumns":[],"pivotAggregation":"count","customPlotOptions":{"mapPlot":[],"pieChart":[{"key":"donut","value":true}],"barChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jules.damji@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"a598d016-74c9-405b-ad4a-ad0e457d9516"},{"version":"CommandV1","origId":922964923687092,"guid":"c892b7e3-4a78-4b87-b959-e3a29e3e0cbc","subtype":"command","commandType":"auto","position":6.0,"command":"%sql select cca3, count(distinct device_id) as device_id from iot_device_data where lcd == 'red' group by cca3 order by device_id desc limit 100","commandVersion":0,"state":"finished","results":{"type":"table","data":[["USA",17421.0],["CHN",3698.0],["JPN",3014.0],["KOR",2917.0],["DEU",1973.0],["GBR",1626.0],["RUS",1515.0],["CAN",1487.0],["FRA",1294.0],["BRA",821.0],["AUS",763.0],["ITA",731.0],["SWE",717.0],["POL",661.0],["NLD",628.0],["ESP",590.0],["TWN",518.0],["IND",427.0],["HKG",385.0],["CZE",375.0],["UKR",373.0],["NOR",358.0],["CHE",348.0],["AUT",342.0],["MEX",312.0],["DNK",309.0],["BGR",302.0],["ROU",290.0],["SGP",258.0],["THA",239.0],["HUN",212.0],["ARG",210.0],["IDN",205.0],["PHL",184.0],["MYS",180.0],["BEL",175.0],["FIN",164.0],["ISR",160.0],["TUR",158.0],["ZAF",125.0],["COL",120.0],["NZL",113.0],["PRT",110.0],["IRL",106.0],["GRC",100.0],["IRN",96.0],["CHL",92.0],["LVA",92.0],["LTU",90.0],["SVK",86.0],["SVN",75.0],["ECU",69.0],["EGY",68.0],["SRB",62.0],["VNM",61.0],["PAK",59.0],["VEN",53.0],["PRI",50.0],["KAZ",44.0],["EST",42.0],["HRV",40.0],["BGD",39.0],["SAU",38.0],["KWT",35.0],["URY",34.0],["BLR",34.0],["PER",32.0],["KEN",28.0],["GEO",27.0],["ARE",26.0],["CYP",25.0],["LUX",23.0],["CRI",23.0],["BOL",21.0],["PAN",20.0],["LBN",18.0],["BIH",18.0],["MDA",18.0],["NGA",17.0],["MKD",17.0],["MAR",17.0],["BHR",17.0],["HND",16.0],["AZE",16.0],["SLV",16.0],["TZA",15.0],["LKA",15.0],["MLT",15.0],["ATG",14.0],["QAT",13.0],["GUM",12.0],["JAM",12.0],["MNG",12.0],["NIC",12.0],["VIR",12.0],["SEN",11.0],["NAM",11.0],["BMU",11.0],["JEY",10.0],["DOM",10.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"cca3","type":"\"string\""},{"name":"device_id","type":"\"long\""}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"Error in SQL statement: AnalysisException: cannot resolve 'c02_lcd' given input columns: [device_id, longitude, cn, scale, humidity, temp, cca2, device_name, c02_level, ip, cca3, lcd, latitude, timestamp, battery_level]; line 1 pos 79","error":"com.databricks.backend.common.rpc.DatabricksExceptions$SQLExecutionException: org.apache.spark.sql.AnalysisException: cannot resolve 'c02_lcd' given input columns: [device_id, longitude, cn, scale, humidity, temp, cca2, device_name, c02_level, ip, cca3, lcd, latitude, timestamp, battery_level]; line 1 pos 79\n\tat org.apache.spark.sql.catalyst.analysis.package$AnalysisErrorAt.failAnalysis(package.scala:42)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1$$anonfun$apply$2.applyOrElse(CheckAnalysis.scala:60)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1$$anonfun$apply$2.applyOrElse(CheckAnalysis.scala:57)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$transformUp$1.apply(TreeNode.scala:335)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$transformUp$1.apply(TreeNode.scala:335)\n\tat org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:69)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.transformUp(TreeNode.scala:334)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$5.apply(TreeNode.scala:332)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$5.apply(TreeNode.scala:332)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$4.apply(TreeNode.scala:281)\n\tat scala.collection.Iterator$$anon$11.next(Iterator.scala:328)\n\tat scala.collection.Iterator$class.foreach(Iterator.scala:727)\n\tat scala.collection.AbstractIterator.foreach(Iterator.scala:1157)\n\tat scala.collection.generic.Growable$class.$plus$plus$eq(Growable.scala:48)\n\tat scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:103)\n\tat scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:47)\n\tat scala.collection.TraversableOnce$class.to(TraversableOnce.scala:273)\n\tat scala.collection.AbstractIterator.to(Iterator.scala:1157)\n\tat scala.collection.TraversableOnce$class.toBuffer(TraversableOnce.scala:265)\n\tat scala.collection.AbstractIterator.toBuffer(Iterator.scala:1157)\n\tat scala.collection.TraversableOnce$class.toArray(TraversableOnce.scala:252)\n\tat scala.collection.AbstractIterator.toArray(Iterator.scala:1157)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.transformChildren(TreeNode.scala:321)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.transformUp(TreeNode.scala:332)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan.transformExpressionUp$1(QueryPlan.scala:108)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan.org$apache$spark$sql$catalyst$plans$QueryPlan$$recursiveTransform$2(QueryPlan.scala:118)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan$$anonfun$2.apply(QueryPlan.scala:127)\n\tat scala.collection.Iterator$$anon$11.next(Iterator.scala:328)\n\tat scala.collection.Iterator$class.foreach(Iterator.scala:727)\n\tat scala.collection.AbstractIterator.foreach(Iterator.scala:1157)\n\tat scala.collection.generic.Growable$class.$plus$plus$eq(Growable.scala:48)\n\tat scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:103)\n\tat scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:47)\n\tat scala.collection.TraversableOnce$class.to(TraversableOnce.scala:273)\n\tat scala.collection.AbstractIterator.to(Iterator.scala:1157)\n\tat scala.collection.TraversableOnce$class.toBuffer(TraversableOnce.scala:265)\n\tat scala.collection.AbstractIterator.toBuffer(Iterator.scala:1157)\n\tat scala.collection.TraversableOnce$class.toArray(TraversableOnce.scala:252)\n\tat scala.collection.AbstractIterator.toArray(Iterator.scala:1157)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan.transformExpressionsUp(QueryPlan.scala:127)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1.apply(CheckAnalysis.scala:57)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1.apply(CheckAnalysis.scala:50)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:121)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$foreachUp$1.apply(TreeNode.scala:120)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$foreachUp$1.apply(TreeNode.scala:120)\n\tat scala.collection.immutable.List.foreach(List.scala:318)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:120)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$class.checkAnalysis(CheckAnalysis.scala:50)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.checkAnalysis(Analyzer.scala:44)\n\tat org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:34)\n\tat org.apache.spark.sql.DataFrame.<init>(DataFrame.scala:133)\n\tat org.apache.spark.sql.DataFrame$.apply(DataFrame.scala:52)\n\tat org.apache.spark.sql.SQLContext.sql(SQLContext.scala:816)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal$$anonfun$1.apply(SQLDriverLocal.scala:71)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal$$anonfun$1.apply(SQLDriverLocal.scala:29)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:244)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:244)\n\tat scala.collection.immutable.List.foreach(List.scala:318)\n\tat scala.collection.TraversableLike$class.map(TraversableLike.scala:244)\n\tat scala.collection.AbstractTraversable.map(Traversable.scala:105)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.executeSql(SQLDriverLocal.scala:29)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.repl(SQLDriverLocal.scala:116)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:157)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:157)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:83)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:57)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:78)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:30)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:116)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:30)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:156)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$3.apply(DriverWrapper.scala:483)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$3.apply(DriverWrapper.scala:483)\n\tat scala.util.Try$.apply(Try.scala:161)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:480)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:381)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:212)\n\tat java.lang.Thread.run(Thread.java:745)\n\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.executeSql(SQLDriverLocal.scala:104)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.repl(SQLDriverLocal.scala:116)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:157)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:157)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:83)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:57)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:78)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:30)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:116)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:30)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:156)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$3.apply(DriverWrapper.scala:483)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$3.apply(DriverWrapper.scala:483)\n\tat scala.util.Try$.apply(Try.scala:161)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:480)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:381)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:212)\n\tat java.lang.Thread.run(Thread.java:745)\n","workflows":[],"startTime":1.458174619643E12,"submitTime":1.458174615158E12,"finishTime":1.458174624808E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"mapPlot","width":"843.5","height":"361.5","xColumns":["cca3"],"yColumns":["device_id"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":{"mapPlot":[]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jules.damji@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"d3efd390-5896-4277-8468-1824ef0a2185"},{"version":"CommandV1","origId":922964923687093,"guid":"4174bcb1-260c-4296-b552-51374afc3d10","subtype":"command","commandType":"auto","position":7.0,"command":"%sql select cca3, count(distinct device_id) as device_id from iot_device_data where battery_level == 0 group by cca3 order by device_id desc limit 100","commandVersion":0,"state":"finished","results":{"type":"table","data":[["USA",7059.0],["CHN",1431.0],["JPN",1183.0],["KOR",1180.0],["DEU",769.0],["GBR",664.0],["CAN",630.0],["RUS",615.0],["FRA",523.0],["BRA",310.0],["AUS",295.0],["SWE",291.0],["ITA",272.0],["NLD",258.0],["POL",246.0],["ESP",212.0],["TWN",202.0],["IND",201.0],["CZE",161.0],["UKR",161.0],["NOR",149.0],["AUT",143.0],["HKG",136.0],["BGR",135.0],["CHE",132.0],["MEX",127.0],["DNK",123.0],["ROU",112.0],["ARG",109.0],["THA",105.0],["SGP",102.0],["HUN",90.0],["IDN",87.0],["FIN",79.0],["PHL",77.0],["TUR",73.0],["ISR",68.0],["MYS",67.0],["BEL",66.0],["COL",52.0],["IRL",50.0],["ZAF",48.0],["NZL",46.0],["PRT",42.0],["LVA",39.0],["GRC",38.0],["CHL",36.0],["IRN",34.0],["SVK",31.0],["LTU",28.0],["VNM",28.0],["EST",26.0],["PAK",25.0],["ECU",25.0],["SRB",24.0],["KAZ",23.0],["PRI",21.0],["SAU",21.0],["SVN",18.0],["HRV",18.0],["KWT",17.0],["EGY",17.0],["ARE",16.0],["BGD",16.0],["PAN",15.0],["BOL",14.0],["VEN",13.0],["CRI",13.0],["QAT",13.0],["URY",12.0],["MAR",11.0],["GEO",10.0],["PER",10.0],["LUX",10.0],["GTM",10.0],["MLT",10.0],["NPL",9.0],["BLR",9.0],["KEN",9.0],["BIH",8.0],["BHR",8.0],["MDA",8.0],["KHM",7.0],["LKA",7.0],["TUN",7.0],["MKD",6.0],["OMN",6.0],["TZA",6.0],["CUB",5.0],["AZE",5.0],["VIR",5.0],["ALA",5.0],["BRN",5.0],["SLV",5.0],["TTO",5.0],["GHA",5.0],["UZB",5.0],["JOR",5.0],["SDN",5.0],["HND",5.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"cca3","type":"\"string\""},{"name":"device_id","type":"\"long\""}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1.458174624816E12,"submitTime":1.458174619926E12,"finishTime":1.458174629181E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"pieChart","width":"1053.5","height":"303.5","xColumns":["cca3"],"yColumns":["device_id"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":{"areaChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}],"lineChart":[],"barChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}],"pieChart":[{"key":"donut","value":true}]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jules.damji@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"b148b9d7-1635-4a66-84ec-ee740c90197c"}],"dashboards":[],"guid":"07c044a9-43b8-4ff1-ae82-a6431d8d8ff3","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/201603140314360000-85b1fe2c3d05a7f47c2b46cddec3c14867c62d86/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/201603140314360000-85b1fe2c3d05a7f47c2b46cddec3c14867c62d86/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>
