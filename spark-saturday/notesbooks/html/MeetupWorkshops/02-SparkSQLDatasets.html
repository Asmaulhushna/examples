<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>02-SparkSQLDatasets - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta name="robots" content="nofollow">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">
<link rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/jquery-ui-bundle/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/img/favicon.ico"/>
<script>window.settings = {"enableNotebookNotifications":true,"enableSshKeyUI":false,"defaultInteractivePricePerDBU":0.4,"enableOnDemandClusterType":true,"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","enableJobsPrefetching":true,"workspaceFeaturedLinks":[{"linkURI":"https://docs.databricks.com/index.html","displayName":"Documentation","icon":"question"},{"linkURI":"https://docs.databricks.com/release-notes/product/index.html","displayName":"Release Notes","icon":"code"},{"linkURI":"https://docs.databricks.com/spark/latest/training/index.html","displayName":"Training & Tutorials","icon":"graduation-cap"}],"enableClearStateFeature":true,"dbcForumURL":"http://forums.databricks.com/","enableProtoClusterInfoDeltaPublisher":true,"enableAttachExistingCluster":true,"serverlessDefaultSparkVersion":"2.2.x-scala2.11","maxCustomTags":45,"serverlessDefaultMaxWorkers":20,"enableInstanceProfilesUIInJobs":true,"nodeInfo":{"node_types":[{"support_ssh":false,"spark_heap_memory":4800,"instance_type_id":"r3.2xlarge","spark_core_oversubscription_factor":8.0,"node_type_id":"dev-tier-node","description":"Community Optimized","support_cluster_tags":false,"container_memory_mb":6000,"node_instance_type":{"instance_type_id":"r3.2xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":26.0,"number_of_ips":14,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":0,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":6144,"is_hidden":false,"category":"Community Edition","num_cores":0.88,"support_port_forwarding":false,"support_ebs_volumes":false,"is_deprecated":false}],"default_node_type_id":"dev-tier-node"},"enableDatabaseSupportClusterChoice":true,"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":999999,"serverlessClusterProductName":"Serverless Pool","enableTableHandler":false,"maxEbsVolumesPerInstance":10,"isAdmin":true,"deltaProcessingBatchSize":1000,"timerUpdateQueueLength":100,"enableLargeResultDownload":true,"maxElasticDiskCapacityGB":5000,"serverlessDefaultMinWorkers":2,"zoneInfos":[{"id":"us-west-2c","isDefault":true},{"id":"us-west-2b","isDefault":false},{"id":"us-west-2a","isDefault":false}],"enableCustomSpotPricingUIByTier":false,"serverlessClustersEnabled":false,"enableFindAndReplace":false,"enableEBSVolumesUIForJobs":true,"enablePublishNotebooks":true,"enableMaxConcurrentRuns":true,"enableJobAclsConfig":false,"enableFullTextSearch":false,"enableElasticSparkUI":false,"enableNewClustersCreate":true,"clusters":true,"allowRunOnPendingClusters":true,"fileStoreBase":"FileStore","enableSshKeyUIInJobs":true,"enableDetachAndAttachSubMenu":true,"configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableAdminPasswordReset":false,"enableResetPassword":true,"maxClusterTagValueLength":255,"enableJobsSparkUpgrade":true,"perClusterAutoterminationEnabled":false,"enableNotebookCommandNumbers":true,"sparkVersions":[{"key":"1.6.3-db2-hadoop2-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-aba860a0ffce4f3471fb14aefdcb1d768ac66a53a5ad884c48745ef98aeb9d67","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.1-db5-scala2.11","displayName":"Spark 2.1.1-db5 (Scala 2.11)","packageLabel":"spark-image-08d9fc1551087e0876236f19640c4a83116b1649f15137427d21c9056656e80e","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1)","packageLabel":"spark-image-f710650fb8aaade8e4e812368ea87c45cd8cd0b5e6894ca6c94f3354e8daa6dc","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.2.x-scala2.11","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-67ab3a06d1e83d5b60df7063245eb419a2e9fe329aeeb7e7d9713332c669bb17","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.1.0-db2-scala2.11","displayName":"Spark 2.1.0-db2 (Scala 2.11)","packageLabel":"spark-image-267c4490a3ab8a39acdbbd9f1d36f6decdecebf013e30dd677faff50f1d9cf8b","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.1.x-gpu-scala2.11","displayName":"Spark 2.1 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-f43ddf8ad9acfd71338f5a51345f077173d236016ad7e39ffd6f698403acd4ea","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.0-ubuntu15.10-scala2.10","displayName":"Spark 2.0.0 (Scala 2.10)","packageLabel":"spark-image-073c1b52ace74f251fae2680624a0d8d184a8b57096d1c21c5ce56c29be6a37a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db3-scala2.10","displayName":"Spark 2.0.2-db3 (Scala 2.10)","packageLabel":"spark-image-584091dedb690de20e8cf22d9e02fdcce1281edda99eedb441a418d50e28088f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db1-scala2.11","displayName":"Spark 2.1.0-db1 (Scala 2.11)","packageLabel":"spark-image-e8ad5b72cf0f899dcf2b4720c1f572ab0e87a311d6113b943b4e1d4a7edb77eb","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.1-db4-scala2.11","displayName":"Spark 2.1.1-db4 (Scala 2.11)","packageLabel":"spark-image-52bca0ca866e3f4243d3820a783abf3b9b3b553edf234abef14b892657ceaca9","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db2-scala2.10","displayName":"Spark 2.1.0-db2 (Scala 2.10)","packageLabel":"spark-image-a2ca4f6b58c95f78dca91b1340305ab3fe32673bd894da2fa8e1dc8a9f8d0478","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.0.2-db4-scala2.11","displayName":"Spark 2.0.2-db4 (Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-image-21d1cac181b7b8856dd1b4214a3a734f95b5289089349db9d9c926cb87d843db","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-gpu-scala2.11","displayName":"Spark 2.0 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-968b89f1d0ec32e1ee4dacd04838cae25ef44370a441224177a37980d539d83a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.3-db1-hadoop2-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-eaa8d9b990015a14e032fb2e2e15be0b8d5af9627cd01d855df728b67969d5d9","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.3-db2-hadoop1-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-14112ea0645bea94333a571a150819ce85573cf5541167d905b7e6588645cf3b","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop2","displayName":"Spark 1.6.2 (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-image-4cafdf8bc6cba8edad12f441e3b3f0a8ea27da35c896bc8290e16b41fd15496a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db2-scala2.10","displayName":"Spark 2.0.2-db2 (Scala 2.10)","packageLabel":"spark-image-36d48f22cca7a907538e07df71847dd22aaf84a852c2eeea2dcefe24c681602f","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-ubuntu15.10-scala2.11","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.11, deprecated)","packageLabel":"spark-image-8e1c50d626a52eac5a6c8129e09ae206ba9890f4523775f77af4ad6d99a64c44","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-scala2.10","displayName":"Spark 2.0 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.1-db4-scala2.10","displayName":"Spark 2.1.1-db4 (Scala 2.10)","packageLabel":"spark-image-c7c0224de396cd1563addc1ae4bca6ba823780b6babe6c3729ddf73008f29ba4","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db1-scala2.11","displayName":"Spark 2.0.2-db1 (Scala 2.11)","packageLabel":"spark-image-c2d623f03dd44097493c01aa54a941fc31978ebe6d759b36c75b716b2ff6ab9c","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db4-scala2.10","displayName":"Spark 2.0.2-db4 (Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.1-db5-scala2.10","displayName":"Spark 2.1.1-db5 (Scala 2.10)","packageLabel":"spark-image-74133df2c13950431298d1cab3e865c191d83ac33648a8590495c52fc644c654","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1)","packageLabel":"spark-image-c9d2a8abf41f157a4acc6d52bc721090346f6fea2de356f3a66e388f54481698","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.2.x-scala2.10","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-d549f2d4a523994ecdf37e531b51d5ec7d8be51534bb0ca5322eaad28ba8f557","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"3.0.x-scala2.11","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-67ab3a06d1e83d5b60df7063245eb419a2e9fe329aeeb7e7d9713332c669bb17","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.x-scala2.11","displayName":"Spark 2.0 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-74133df2c13950431298d1cab3e865c191d83ac33648a8590495c52fc644c654","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"3.1.x-scala2.11","displayName":"3.1 alpha (Scala 2.11)","packageLabel":"spark-image-b22eb77d602f56ac4fccde1d90398db6fc15a3bfd27a06570d0c70472e39d183","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db3-scala2.10","displayName":"Spark 2.1.0-db3 (Scala 2.10)","packageLabel":"spark-image-25a17d070af155f10c4232dcc6248e36a2eb48c24f8d4fc00f34041b86bd1626","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db2-scala2.11","displayName":"Spark 2.0.2-db2 (Scala 2.11)","packageLabel":"spark-image-4fa852ba378e97815083b96c9cada7b962a513ec23554a5fc849f7f1dd8c065a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"3.1.x-scala2.10","displayName":"3.1 alpha (Scala 2.10)","packageLabel":"spark-image-921a4c439389adacef9d3af16edd5406c30ca9195d06cc09d0c1f171c7be61ff","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1)","packageLabel":"spark-image-40d2842670bc3dc178b14042501847d76171437ccf70613fa397a7a24c48b912","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.1-db1-scala2.11","displayName":"Spark 2.0.1-db1 (Scala 2.11)","packageLabel":"spark-image-10ab19f634bbfdb860446c326a9f76dc25bfa87de6403b980566279142a289ea","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db3-scala2.11","displayName":"Spark 2.0.2-db3 (Scala 2.11)","packageLabel":"spark-image-7fd7aaa89d55692e429115ae7eac3b1a1dc4de705d50510995f34306b39c2397","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.3-db1-hadoop1-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-d50af1032799546b8ccbeeb76889a20c819ebc2a0e68ea20920cb30d3895d3ae","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db1-scala2.10","displayName":"Spark 2.0.2-db1 (Scala 2.10)","packageLabel":"spark-image-654bdd6e9bad70079491987d853b4b7abf3b736fff099701501acaabe0e75c41","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-ubuntu15.10","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.10, deprecated)","packageLabel":"spark-image-a659f3909d51b38d297b20532fc807ecf708cfb7440ce9b090c406ab0c1e4b7e","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.1-db1-scala2.10","displayName":"Spark 2.0.1-db1 (Scala 2.10)","packageLabel":"spark-image-5a13c2db3091986a4e7363006cc185c5b1108c7761ef5d0218506cf2e6643840","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.x-scala2.11","displayName":"Spark 2.1 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-08d9fc1551087e0876236f19640c4a83116b1649f15137427d21c9056656e80e","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db1-scala2.10","displayName":"Spark 2.1.0-db1 (Scala 2.10)","packageLabel":"spark-image-f0ab82a5deb7908e0d159e9af066ba05fb56e1edb35bdad41b7ad2fd62a9b546","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"3.0.x-scala2.10","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-d549f2d4a523994ecdf37e531b51d5ec7d8be51534bb0ca5322eaad28ba8f557","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-image-10ef758029b8c7e19cd7f4fb52fff9180d75db92ca071bd94c47f3c1171a7cb5","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.0.0-ubuntu15.10-scala2.11","displayName":"Spark 2.0.0 (Scala 2.11)","packageLabel":"spark-image-b4ec141e751f201399f8358a82efee202560f7ed05e1a04a2ae8778f6324b909","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.0-db3-scala2.11","displayName":"Spark 2.1.0-db3 (Scala 2.11)","packageLabel":"spark-image-ccbc6b73f158e2001fc1fb8c827bfdde425d8bd6d65cb7b3269784c28bb72c16","upgradable":true,"deprecated":false,"customerVisible":true}],"enableClearStateAndRunAll":true,"enableRestrictedClusterCreation":true,"enableFeedback":true,"enableClusterAutoScaling":false,"enableUserVisibleDefaultTags":true,"defaultNumWorkers":0,"serverContinuationTimeoutMillis":10000,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":false,"accountsOwnerUrl":"https://accounts.cloud.databricks.com/registration.html#login","driverStdoutFilePrefix":"stdout","defaultNodeTypeToPricingUnitsMap":{"r3.2xlarge":2,"i3.4xlarge":6,"class-node":1,"m4.2xlarge":1.5,"r4.xlarge":1,"m4.4xlarge":3,"r4.16xlarge":16,"Standard_DS11":0.5,"p2.8xlarge":16,"m4.10xlarge":8,"r3.8xlarge":8,"r4.4xlarge":4,"dev-tier-node":1,"c3.8xlarge":4,"r3.4xlarge":4,"i2.4xlarge":6,"m4.xlarge":0.75,"r4.8xlarge":8,"r4.large":0.5,"Standard_DS12":1,"development-node":1,"i2.2xlarge":3,"g2.8xlarge":6,"i3.large":0.75,"memory-optimized":1,"m4.large":0.375,"p2.16xlarge":24,"i3.8xlarge":12,"i3.16xlarge":24,"Standard_DS12_v2":1,"Standard_DS13":2,"Standard_DS11_v2":0.5,"Standard_DS13_v2":2,"c3.2xlarge":1,"Standard_L4s":1.5,"c4.2xlarge":1,"i2.xlarge":1.5,"compute-optimized":1,"c4.4xlarge":2,"i3.2xlarge":3,"c3.4xlarge":2,"g2.2xlarge":1.5,"p2.xlarge":2,"m4.16xlarge":12,"c4.8xlarge":4,"i3.xlarge":1.5,"r3.xlarge":1,"r4.2xlarge":2,"i2.8xlarge":12},"enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"enableEBSVolumesUI":false,"sanitizeMarkdownHtml":true,"metastoreServiceRowLimit":1000000,"enableIPythonImportExport":true,"enableClusterTagsUIForJobs":true,"enableClusterTagsUI":false,"enableNotebookHistoryDiffing":true,"branch":"2.50","accountsLimit":3,"enableSparkEnvironmentVariables":true,"enableX509Authentication":false,"enableStructuredStreamingNbOptimizations":true,"enableNotebookGitBranching":true,"local":false,"enableNotebookLazyRenderWrapper":false,"enableClusterAutoScalingForJobs":false,"enableStrongPassword":false,"displayDefaultContainerMemoryGB":6,"enableNotebookCommandMode":true,"disableS3TableImport":false,"deploymentMode":"production","useSpotForWorkers":true,"preferStartTerminatedCluster":true,"enableNonPollingTableCall":true,"enableUserInviteWorkflow":true,"enableStaticNotebooks":true,"enableCssTransitions":true,"serverlessEnableElasticDisk":true,"minClusterTagKeyLength":1,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterAclsConfig":false,"useTempS3UrlForTableUpload":false,"notifyLastLogin":false,"enableSshKeyUIByTier":false,"enableCreateClusterOnAttach":true,"defaultAutomatedPricePerDBU":0.2,"enableNotebookGitVersioning":true,"files":"files/","feedbackEmail":"feedback@databricks.com","enableDriverLogsUI":true,"enableWorkspaceAclsConfig":false,"dropzoneMaxFileSize":2047,"enableNewClustersList":false,"enableNewDashboardViews":true,"driverLog4jFilePrefix":"log4j","enableSingleSignOn":true,"enableMavenLibraries":true,"displayRowLimit":1000,"deltaProcessingAsyncEnabled":true,"enableSparkEnvironmentVariablesUI":false,"defaultSparkVersion":{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-74133df2c13950431298d1cab3e865c191d83ac33648a8590495c52fc644c654","upgradable":true,"deprecated":false,"customerVisible":true},"enableCustomSpotPricing":false,"enableMountAclsConfig":false,"defaultAutoterminationMin":180,"useDevTierHomePage":true,"enableClusterClone":true,"enableNotebookLineNumbers":true,"enablePublishHub":false,"notebookHubUrl":"http://hub.dev.databricks.com/","showSqlEndpoints":false,"enableNotebookDatasetInfoView":false,"enableClusterAclsByTier":false,"databricksDocsBaseUrl":"https://docs.databricks.com/","cloud":"AWS","disallowAddingAdmins":true,"enableSparkConfUI":true,"featureTier":"DEVELOPER_BASIC_TIER","mavenCentralSearchEndpoint":"http://search.maven.org/solrsearch/select","enableOrgSwitcherUI":true,"clustersLimit":1,"enableJdbcImport":true,"enableElasticDisk":false,"logfiles":"logfiles/","enableWebappSharding":true,"enableClusterDeltaUpdates":true,"enableSingleSignOnLogin":false,"ebsVolumeSizeLimitGB":{"GENERAL_PURPOSE_SSD":[100,4096],"THROUGHPUT_OPTIMIZED_HDD":[500,4096]},"enableMountAcls":false,"requireEmailUserName":true,"dbcFeedbackURL":"mailto:feedback@databricks.com","enableMountAclService":true,"serverlessClustersByDefault":false,"enableWorkspaceAcls":false,"maxClusterTagKeyLength":127,"gitHash":"2162bae813344ed1541d63a989142c9938e96057","showWorkspaceFeaturedLinks":true,"signupUrl":"https://databricks.com/try-databricks","allowFeedbackForumAccess":true,"enableImportFromUrl":true,"enableMiniClusters":true,"enableNewJobList":true,"enableNewTableUI":true,"enableDebugUI":false,"enableStreamingMetricsDashboard":true,"allowNonAdminUsers":true,"enableSingleSignOnByTier":false,"enableJobsRetryOnTimeout":true,"useStandardTierUpgradeTooltips":true,"staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/","enableSpotClusterType":true,"enableSparkPackages":true,"dynamicSparkVersions":true,"enableClusterTagsUIByTier":false,"enableNotebookHistoryUI":true,"enableClusterLoggingUI":true,"enableDatabaseDropdownInTableUI":true,"showDebugCounters":false,"enableInstanceProfilesUI":false,"enableFolderHtmlExport":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.databricks.com/_static/notebooks/gentle-introduction-to-apache-spark.html","displayName":"Introduction to Apache Spark on Databricks","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/databricks-for-data-scientists.html","displayName":"Databricks for Data Scientists","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/structured-streaming-python.html","displayName":"Introduction to Structured Streaming","icon":"img/home/Python_icon.svg"}],"enableClusterStart":false,"enableEBSVolumesUIByTier":false,"singleSignOnComingSoon":false,"removeSubCommandCodeWhenExport":true,"upgradeURL":"https://accounts.cloud.databricks.com/registration.html#login","maxAutoterminationMinutes":10000,"autoterminateClustersByDefault":true,"notebookLoadingBackground":"#fff","sshContainerForwardedPort":2200,"enableServerAutoComplete":true,"enableStaticHtmlImport":true,"enableInstanceProfilesByTier":false,"showForgotPasswordLink":true,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"minAutoterminationMinutes":10,"accounts":true,"useOnDemandClustersByDefault":true,"useFramedStaticNotebooks":false,"enableNewProgressReportUI":true,"enableAutoCreateUserUI":true,"defaultCoresPerContainer":4,"showTerminationReason":true,"enableNewClustersGet":true,"showPricePerDBU":false,"showSqlProxyUI":true,"enableNotebookErrorHighlighting":true};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":2201444230243967,"name":"02-SparkSQLDatasets","language":"scala","commands":[{"version":"CommandV1","origId":2201444230243969,"guid":"5d41626e-2041-45e7-bb93-64639f465d16","subtype":"command","commandType":"auto","position":0.25,"command":"%md\n\n# Spark Datasets with Scala\nThis notebook demonstrates a number of common Spark Dataset functions using Scala. It also demostrates how structure enables developers to express high-level queries that \nare readable and composable. They look like SQL queries you would express, or domain specific language computation you would perform on your data set.\n\nKeep this URL or open in the new tab to consult [Dataset API](https://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.sql.Dataset)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1454974337346,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"275d46f4-1669-407b-b9b8-e97414237d8e"},{"version":"CommandV1","origId":2201444230243970,"guid":"3406f3dc-06cc-4a0c-96a3-54d2152e4d99","subtype":"command","commandType":"auto","position":0.5,"command":"%md ### Setup: Create Sample Data to demonstrate Datasets.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1454974337384,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"394c81f7-a0e4-44ab-ad12-0f6bd6130d11"},{"version":"CommandV1","origId":2201444230243971,"guid":"06ab544f-bfbe-4c7d-890d-e360f01dab7b","subtype":"command","commandType":"auto","position":1.0,"command":"// Create the case classes for our domain, in this case a department, employee, and DepartmentWithEmployee.\n// Simple example to illustrate how structure makes Spark easy to program.\ncase class Department(id: String, name: String)\ncase class Employee(firstName: String, lastName: String, email: String, salary: Int)\ncase class DepartmentWithEmployees(department: Department, employees: Employee)\n\n// Create the Departments\nval department1 = new Department(\"123456\", \"Computer Science\")\nval department2 = new Department(\"345678\", \"Mechanical Engineering\")\n//let's give it the same ID so we can do some joins across common keys\nval department3 = new Department(\"123456\", \"Theater and Drama\")\nval department4 = new Department(\"901234\", \"Indoor Recreation\")\n\n// Create the Employees\nval employee1 = new Employee(\"michael\", \"armbrust\", \"no-reply@berkeley.edu\", 100000)\nval employee2 = new Employee(\"xiangrui\", \"meng\", \"no-reply@stanford.edu\", 120000)\nval employee3 = new Employee(\"matei\", null, \"no-reply@waterloo.edu\", 200000)\nval employee4 = new Employee(null, \"wendell\", \"no-reply@princeton.edu\", 160000)\n\n// Create the DepartmentWithEmployees instances from Departments and Employees\nval departmentWithEmployees1 = new DepartmentWithEmployees(department1, employee1)\nval departmentWithEmployees2 = new DepartmentWithEmployees(department2, employee3)\nval departmentWithEmployees3 = new DepartmentWithEmployees(department3, employee4)\nval departmentWithEmployees4 = new DepartmentWithEmployees(department4, employee3)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">defined class Department\ndefined class Employee\ndefined class DepartmentWithEmployees\ndepartment1: Department = Department(123456,Computer Science)\ndepartment2: Department = Department(345678,Mechanical Engineering)\ndepartment3: Department = Department(123456,Theater and Drama)\ndepartment4: Department = Department(901234,Indoor Recreation)\nemployee1: Employee = Employee(michael,armbrust,no-reply@berkeley.edu,100000)\nemployee2: Employee = Employee(xiangrui,meng,no-reply@stanford.edu,120000)\nemployee3: Employee = Employee(matei,null,no-reply@waterloo.edu,200000)\nemployee4: Employee = Employee(null,wendell,no-reply@princeton.edu,160000)\ndepartmentWithEmployees1: DepartmentWithEmployees = DepartmentWithEmployees(Department(123456,Computer Science),Employee(michael,armbrust,no-reply@berkeley.edu,100000))\ndepartmentWithEmployees2: DepartmentWithEmployees = DepartmentWithEmployees(Department(345678,Mechanical Engineering),Employee(matei,null,no-reply@waterloo.edu,200000))\ndepartmentWithEmployees3: DepartmentWithEmployees = DepartmentWithEmployees(Department(123456,Theater and Drama),Employee(null,wendell,no-reply@princeton.edu,160000))\ndepartmentWithEmployees4: DepartmentWithEmployees = DepartmentWithEmployees(Department(901234,Indoor Recreation),Employee(matei,null,no-reply@waterloo.edu,200000))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":"<div class=\"ansiout\">java.lang.AssertionError: assertion failed: Tried to find '$read$.class' in '/tmp/spark-cf5981f4-ea25-4453-ba1e-2899ab80d05b/line8f39d1e722f3474f96fc099e71eba05e19' but it is not a directory\n\tat scala.reflect.io.AbstractFile.fileNamed(AbstractFile.scala:245)\n\tat scala.tools.nsc.backend.jvm.BytecodeWriters$class.getFile(BytecodeWriters.scala:34)\n\tat scala.tools.nsc.backend.jvm.BytecodeWriters$class.scala$tools$nsc$backend$jvm$BytecodeWriters$$getFile(BytecodeWriters.scala:37)\n\tat scala.tools.nsc.backend.jvm.BytecodeWriters$ClassBytecodeWriter$class.writeClass(BytecodeWriters.scala:89)\n\tat scala.tools.nsc.backend.jvm.GenASM$AsmPhase$$anon$4.writeClass(GenASM.scala:67)\n\tat scala.tools.nsc.backend.jvm.GenASM$JBuilder.writeIfNotTooBig(GenASM.scala:459)\n\tat scala.tools.nsc.backend.jvm.GenASM$JPlainBuilder.genClass(GenASM.scala:1413)\n\tat scala.tools.nsc.backend.jvm.GenASM$AsmPhase.run(GenASM.scala:120)\n\tat scala.tools.nsc.Global$Run.compileUnitsInternal(Global.scala:1583)\n\tat scala.tools.nsc.Global$Run.compileUnits(Global.scala:1557)\n\tat scala.tools.nsc.Global$Run.compileSources(Global.scala:1553)\n\tat org.apache.spark.repl.SparkIMain.org$apache$spark$repl$SparkIMain$$compileSourcesKeepingRun(SparkIMain.scala:663)\n\tat org.apache.spark.repl.SparkIMain$ReadEvalPrint.compileAndSaveRun(SparkIMain.scala:1136)\n\tat org.apache.spark.repl.SparkIMain$ReadEvalPrint.compile(SparkIMain.scala:1092)\n\tat org.apache.spark.repl.SparkIMain$Request.compile$lzycompute(SparkIMain.scala:1286)\n\tat org.apache.spark.repl.SparkIMain$Request.compile(SparkIMain.scala:1281)\n\tat org.apache.spark.repl.SparkIMain.interpret(SparkIMain.scala:870)\n\tat org.apache.spark.repl.SparkIMain.interpret(SparkIMain.scala:819)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal$$anonfun$repl$1.apply(ScalaDriverLocal.scala:108)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal$$anonfun$repl$1.apply(ScalaDriverLocal.scala:108)\n\tat com.databricks.backend.daemon.driver.DriverLocal$TrapExitInternal$.trapExit(DriverLocal.scala:400)\n\tat com.databricks.backend.daemon.driver.DriverLocal$TrapExit$.apply(DriverLocal.scala:356)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal.repl(ScalaDriverLocal.scala:108)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:159)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$3.apply(DriverWrapper.scala:484)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$3.apply(DriverWrapper.scala:484)\n\tat scala.util.Try$.apply(Try.scala:161)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:481)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:383)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:194)\n\tat java.lang.Thread.run(Thread.java:745)</div>","workflows":[],"startTime":1498524772018,"submitTime":1498524772013,"finishTime":1498524774934,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"daf99501-543f-4da8-a6a3-bbbae6c45cb6"},{"version":"CommandV1","origId":2201444230243972,"guid":"37dfa7e0-8fca-43e3-9d06-2849b2476c99","subtype":"command","commandType":"auto","position":1.5,"command":"%md **Create the first Dataset from a List of the Case Classes.**","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1454974337459,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"613db364-fadb-40c9-8277-6c95d22eeda3"},{"version":"CommandV1","origId":2201444230243973,"guid":"0a2e73f0-dc22-411c-a339-f3f9693df483","subtype":"command","commandType":"auto","position":2.0,"command":"val departmentsWithEmployeesSeq1 = Seq(departmentWithEmployees1, departmentWithEmployees2)\n//convert it to a dataset\nval ds1 = departmentsWithEmployeesSeq1.toDS()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">departmentsWithEmployeesSeq1: Seq[DepartmentWithEmployees] = List(DepartmentWithEmployees(Department(123456,Computer Science),Employee(michael,armbrust,no-reply@berkeley.edu,100000)), DepartmentWithEmployees(Department(345678,Mechanical Engineering),Employee(matei,null,no-reply@waterloo.edu,200000)))\nds1: org.apache.spark.sql.Dataset[DepartmentWithEmployees] = [department: struct&lt;id: string, name: string&gt;, employees: struct&lt;firstName: string, lastName: string ... 2 more fields&gt;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1498524790649,"submitTime":1498524790646,"finishTime":1498524791608,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4f61d80b-f0c5-4e65-bb7d-0336103d8781"},{"version":"CommandV1","origId":2201444230243974,"guid":"0d396f8a-4dd5-48b3-a502-4740ce8af406","subtype":"command","commandType":"auto","position":2.0625,"command":"display(ds1)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[["123456","Computer Science"],["michael","armbrust","no-reply@berkeley.edu",100000]],[["345678","Mechanical Engineering"],["matei",null,"no-reply@waterloo.edu",200000]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"department","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"},{"name":"employees","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"firstName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"lastName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"email\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"salary\",\"type\":\"integer\",\"nullable\":false,\"metadata\":{}}]}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:31: error: not found: value ds1\n       display(ds1)\n               ^\n</div>","error":null,"workflows":[],"startTime":1498524795168,"submitTime":1498524795165,"finishTime":1498524795479,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c0a09344-288a-4f79-90fe-cdbb5bf0bcaa"},{"version":"CommandV1","origId":2201444230243975,"guid":"7ace577b-a97a-4b9e-8ea5-1528620a4e1a","subtype":"command","commandType":"auto","position":2.0703125,"command":"%md Note that once we have as Dataset, we can access individual data items using Scala object's \".\" notation. For example, I can print the department or access individual item in the department","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"917d4b9f-e9ce-431b-8396-8d1329ff5231"},{"version":"CommandV1","origId":2201444230243976,"guid":"428660ae-924a-4c78-955b-ef43400df6bc","subtype":"command","commandType":"auto","position":2.078125,"command":"println(ds1.head.department)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Department(123456,Computer Science)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:33: error: missing parameter type\n       ds1.foreach(println(x =&gt; x.department))\n                           ^\n</div>","error":null,"workflows":[],"startTime":1479869474571,"submitTime":1479869475040,"finishTime":1479869474798,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"37859394-6989-4f3c-9a77-78f0a4aed6ba"},{"version":"CommandV1","origId":2201444230243977,"guid":"88addcdf-5f81-4e96-b9ad-e8fa013e2638","subtype":"command","commandType":"auto","position":2.1015625,"command":"println(ds1.head.department.name)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Computer Science\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:33: error: value name is not a member of DepartmentWithEmployees\n       println(ds1.head.name)\n                        ^\n</div>","error":null,"workflows":[],"startTime":1479869477488,"submitTime":1479869477956,"finishTime":1479869477644,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0f89c27b-efbe-45b6-b537-32151dd72cac"},{"version":"CommandV1","origId":2201444230243978,"guid":"efb00931-d79a-4e26-82f5-fe939df5317a","subtype":"command","commandType":"auto","position":2.125,"command":"%md **Create a 2nd Dataset from a List of Case Classes.**","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1454974337543,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"849c9fda-a499-42cd-afd5-d77b9745e90b"},{"version":"CommandV1","origId":2201444230243979,"guid":"6868b8fe-4188-441f-bb82-f8558f1071ad","subtype":"command","commandType":"auto","position":2.25,"command":"val departmentsWithEmployeesSeq2 = Seq(departmentWithEmployees3, departmentWithEmployees4)\nval ds2 = departmentsWithEmployeesSeq2.toDS()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">departmentsWithEmployeesSeq2: Seq[DepartmentWithEmployees] = List(DepartmentWithEmployees(Department(123456,Theater and Drama),Employee(null,wendell,no-reply@princeton.edu,160000)), DepartmentWithEmployees(Department(901234,Indoor Recreation),Employee(matei,null,no-reply@waterloo.edu,200000)))\nds2: org.apache.spark.sql.Dataset[DepartmentWithEmployees] = [department: struct&lt;id: string, name: string&gt;, employees: struct&lt;firstName: string, lastName: string ... 2 more fields&gt;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:36: error: not found: value df2\n       display(df2)\n               ^\n</div>","error":null,"workflows":[],"startTime":1479869492571,"submitTime":1479869493041,"finishTime":1479869493032,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ec9130c1-de94-4ef5-a458-f2efa0f00078"},{"version":"CommandV1","origId":2201444230243980,"guid":"2fe4f5d0-81ef-4642-b52c-9e60d02d2693","subtype":"command","commandType":"auto","position":2.28125,"command":"display(ds2)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[["123456","Theater and Drama"],[null,"wendell","no-reply@princeton.edu",160000]],[["901234","Indoor Recreation"],["matei",null,"no-reply@waterloo.edu",200000]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"department","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"},{"name":"employees","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"firstName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"lastName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"email\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"salary\",\"type\":\"integer\",\"nullable\":false,\"metadata\":{}}]}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1479869497801,"submitTime":1479869498269,"finishTime":1479869497993,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0eaee604-dc4b-4a6d-9c9f-200700d74406"},{"version":"CommandV1","origId":2201444230243981,"guid":"53332dc8-feb9-4d47-b551-d78093a97d21","subtype":"command","commandType":"auto","position":2.2890625,"command":"println(ds1.head.department)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Department(123456,Computer Science)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1479869503477,"submitTime":1479869503946,"finishTime":1479869503703,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"28234edd-a8be-4a3e-b1cc-a8320fbc71d3"},{"version":"CommandV1","origId":2201444230243982,"guid":"08c31787-0b2e-48e4-9566-f4c829901bf9","subtype":"command","commandType":"auto","position":2.29296875,"command":"println(ds1.head.employees)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Employee(michael,armbrust,no-reply@berkeley.edu,100000)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1479869505905,"submitTime":1479869506365,"finishTime":1479869506043,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"eedd3c1b-7eb6-4b52-ab3f-8c8219d65fe6"},{"version":"CommandV1","origId":2201444230243983,"guid":"090cba18-3d9b-4367-aa05-7b251b251be6","subtype":"command","commandType":"auto","position":2.294921875,"command":"%md Same thing as above, I can access individual items.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"101e3f59-bfed-48c4-af98-423a70f14450"},{"version":"CommandV1","origId":2201444230243984,"guid":"34f2dfcc-5b9a-46ae-9ff8-29a7391f1017","subtype":"command","commandType":"auto","position":2.296875,"command":"println(ds1.head.employees.firstName, ds1.head.employees.email, ds1.head.employees.salary)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">(michael,no-reply@berkeley.edu,100000)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:33: error: value firstname is not a member of Employee\n       println(ds1.head.employees.firstname)\n                                  ^\n</div>","error":null,"workflows":[],"startTime":1479869513021,"submitTime":1479869513491,"finishTime":1479869513193,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c6d01b20-3dad-4dc7-9561-f1b614a61a0d"},{"version":"CommandV1","origId":2201444230243985,"guid":"ee67ac6f-4108-4dab-bdc6-87d0f9e7565d","subtype":"command","commandType":"auto","position":2.3046875,"command":"%md Let's do a common operation performed when you have two datasets related or have a common attribute by joining datasets. In this case,\nwe can do a join over id with a predicate filter. Nice!!!","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"83b0cfdb-9302-4af6-9274-4c4aa8cb076b"},{"version":"CommandV1","origId":2201444230243986,"guid":"bc776624-f99c-447d-a7d9-60f4a93cc633","subtype":"command","commandType":"auto","position":2.306640625,"command":"display(ds1)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[["123456","Computer Science"],["michael","armbrust","no-reply@berkeley.edu",100000]],[["345678","Mechanical Engineering"],["matei",null,"no-reply@waterloo.edu",200000]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"department","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"},{"name":"employees","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"firstName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"lastName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"email\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"salary\",\"type\":\"integer\",\"nullable\":false,\"metadata\":{}}]}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1479869567040,"submitTime":1479869567510,"finishTime":1479869567303,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7c4be40e-71ca-4b0b-87fb-d528a11e6722"},{"version":"CommandV1","origId":2201444230243987,"guid":"b6a6083a-87c9-4273-b984-64c5ebbc07b2","subtype":"command","commandType":"auto","position":2.3076171875,"command":"display(ds2)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[["123456","Theater and Drama"],[null,"wendell","no-reply@princeton.edu",160000]],[["901234","Indoor Recreation"],["matei",null,"no-reply@waterloo.edu",200000]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"department","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"},{"name":"employees","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"firstName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"lastName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"email\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"salary\",\"type\":\"integer\",\"nullable\":false,\"metadata\":{}}]}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1479869569765,"submitTime":1479869570227,"finishTime":1479869569925,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"300e714f-97af-461d-ad83-30b77c84b386"},{"version":"CommandV1","origId":2201444230243988,"guid":"751982af-23d2-4da6-a41a-339e5e90eaa8","subtype":"command","commandType":"auto","position":2.30859375,"command":"val dsj3 = ds1.join(ds2, ds1(\"department.id\")=== ds2(\"department.id\"))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">dsj3: org.apache.spark.sql.DataFrame = [department: struct&lt;id: string, name: string&gt;, employees: struct&lt;firstName: string, lastName: string ... 2 more fields&gt; ... 2 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">Unclosed block</div>","error":null,"workflows":[],"startTime":1479869613413,"submitTime":1479869613884,"finishTime":1479869613752,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a84424fc-754f-486d-814d-2a1b729461d7"},{"version":"CommandV1","origId":2201444230243989,"guid":"1ec87962-8103-4a5d-875e-288608e4a143","subtype":"command","commandType":"auto","position":2.310546875,"command":"display(dsj3)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[["123456","Computer Science"],["michael","armbrust","no-reply@berkeley.edu",100000],["123456","Theater and Drama"],[null,"wendell","no-reply@princeton.edu",160000]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"department","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"},{"name":"employees","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"firstName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"lastName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"email\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"salary\",\"type\":\"integer\",\"nullable\":false,\"metadata\":{}}]}","metadata":"{}"},{"name":"department","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"},{"name":"employees","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"firstName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"lastName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"email\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"salary\",\"type\":\"integer\",\"nullable\":false,\"metadata\":{}}]}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1479869624499,"submitTime":1479869624970,"finishTime":1479869625475,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8891bbea-a4f1-4eb2-9309-89d4e4075356"},{"version":"CommandV1","origId":2201444230243990,"guid":"fd5fa4a5-d090-4e85-be94-0ec897d12d72","subtype":"command","commandType":"auto","position":2.3125,"command":"val dsj3 = ds1.join(ds2, ds1(\"department.id\")===ds2(\"department.id\") && (ds2(\"employees.salary\") > ds1(\"employees.salary\")))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">dsj3: org.apache.spark.sql.DataFrame = [department: struct&lt;id: string, name: string&gt;, employees: struct&lt;firstName: string, lastName: string ... 2 more fields&gt; ... 2 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:29: error: not found: value ds1\n       val ds3 = ds1.join(ds2, ds1(&quot;department.id&quot;)===ds2(&quot;department.id&quot;) &amp;&amp; (ds2(&quot;employees.salary&quot;) &lt; ds1(&quot;employees.salary&quot;)) &amp;&amp; (ds1(&quot;employees.salary&quot;) &lt; ds2(&quot;employees.salary&quot;)))\n                 ^\n&lt;console&gt;:29: error: not found: value ds2\n       val ds3 = ds1.join(ds2, ds1(&quot;department.id&quot;)===ds2(&quot;department.id&quot;) &amp;&amp; (ds2(&quot;employees.salary&quot;) &lt; ds1(&quot;employees.salary&quot;)) &amp;&amp; (ds1(&quot;employees.salary&quot;) &lt; ds2(&quot;employees.salary&quot;)))\n                          ^\n&lt;console&gt;:29: error: not found: value ds1\n       val ds3 = ds1.join(ds2, ds1(&quot;department.id&quot;)===ds2(&quot;department.id&quot;) &amp;&amp; (ds2(&quot;employees.salary&quot;) &lt; ds1(&quot;employees.salary&quot;)) &amp;&amp; (ds1(&quot;employees.salary&quot;) &lt; ds2(&quot;employees.salary&quot;)))\n                               ^\n&lt;console&gt;:29: error: not found: value ds2\n       val ds3 = ds1.join(ds2, ds1(&quot;department.id&quot;)===ds2(&quot;department.id&quot;) &amp;&amp; (ds2(&quot;employees.salary&quot;) &lt; ds1(&quot;employees.salary&quot;)) &amp;&amp; (ds1(&quot;employees.salary&quot;) &lt; ds2(&quot;employees.salary&quot;)))\n                                                      ^\n&lt;console&gt;:29: error: not found: value ds2\n       val ds3 = ds1.join(ds2, ds1(&quot;department.id&quot;)===ds2(&quot;department.id&quot;) &amp;&amp; (ds2(&quot;employees.salary&quot;) &lt; ds1(&quot;employees.salary&quot;)) &amp;&amp; (ds1(&quot;employees.salary&quot;) &lt; ds2(&quot;employees.salary&quot;)))\n                                                                               ^\n&lt;console&gt;:29: error: not found: value ds1\n       val ds3 = ds1.join(ds2, ds1(&quot;department.id&quot;)===ds2(&quot;department.id&quot;) &amp;&amp; (ds2(&quot;employees.salary&quot;) &lt; ds1(&quot;employees.salary&quot;)) &amp;&amp; (ds1(&quot;employees.salary&quot;) &lt; ds2(&quot;employees.salary&quot;)))\n                                                                                                         ^\n&lt;console&gt;:29: error: not found: value ds1\n       val ds3 = ds1.join(ds2, ds1(&quot;department.id&quot;)===ds2(&quot;department.id&quot;) &amp;&amp; (ds2(&quot;employees.salary&quot;) &lt; ds1(&quot;employees.salary&quot;)) &amp;&amp; (ds1(&quot;employees.salary&quot;) &lt; ds2(&quot;employees.salary&quot;)))\n                                                                                                                                      ^\n&lt;console&gt;:29: error: not found: value ds2\n       val ds3 = ds1.join(ds2, ds1(&quot;department.id&quot;)===ds2(&quot;department.id&quot;) &amp;&amp; (ds2(&quot;employees.salary&quot;) &lt; ds1(&quot;employees.salary&quot;)) &amp;&amp; (ds1(&quot;employees.salary&quot;) &lt; ds2(&quot;employees.salary&quot;)))\n                                                                                                                                                                ^\n</div>","error":null,"workflows":[],"startTime":1479418360572,"submitTime":1479418359658,"finishTime":1479418360761,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"271a933e-e89e-49bb-99ba-7185eebbc988"},{"version":"CommandV1","origId":2201444230243991,"guid":"f3a74627-a86e-43c2-828e-2e957c1e2879","subtype":"command","commandType":"auto","position":2.34375,"command":"display(dsj3)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[["123456","Computer Science"],["michael","armbrust","no-reply@berkeley.edu",100000.0],["123456","Theater and Drama"],[null,"wendell","no-reply@princeton.edu",160000.0]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"department","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"},{"name":"employees","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"firstName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"lastName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"email\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"salary\",\"type\":\"integer\",\"nullable\":false,\"metadata\":{}}]}","metadata":"{}"},{"name":"department","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"},{"name":"employees","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"firstName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"lastName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"email\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"salary\",\"type\":\"integer\",\"nullable\":false,\"metadata\":{}}]}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:33: error: not found: value displa\n       displa(dsj3)\n       ^\n</div>","error":null,"workflows":[],"startTime":1479418367789,"submitTime":1479418366876,"finishTime":1479418367975,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2630d55b-a162-4132-b1ac-a8e7a266640a"},{"version":"CommandV1","origId":2201444230243992,"guid":"bc78bae6-7e31-4e2a-b159-dd21730a16d3","subtype":"command","commandType":"auto","position":2.375,"command":"%md\n\n### Working with Datasets","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1454974337635,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a26a9c14-886a-4f37-80c2-95ce5d468ae3"},{"version":"CommandV1","origId":2201444230243993,"guid":"e58f0b19-a71f-4440-9165-66d212b8e311","subtype":"command","commandType":"auto","position":2.5,"command":"%md **Union 2 Datasets.**","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1454974337694,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c792f393-ee46-4d06-93b9-9942dba16ba7"},{"version":"CommandV1","origId":2201444230243994,"guid":"9f25c07c-6b14-47d6-bbb2-c6e8d27ceaff","subtype":"command","commandType":"auto","position":3.0,"command":"val unionDS = ds1.union(ds2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">unionDS: org.apache.spark.sql.Dataset[DepartmentWithEmployees] = [department: struct&lt;id: string, name: string&gt;, employees: struct&lt;firstName: string, lastName: string ... 2 more fields&gt;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":"Command skipped","workflows":[],"startTime":1479418472694,"submitTime":1479418471779,"finishTime":1479418472802,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"45bb85bf-9c6e-4393-b9a1-1af0f4bc6488"},{"version":"CommandV1","origId":2201444230243995,"guid":"778cbc10-79ee-4ba4-87d7-ad986ee4834e","subtype":"command","commandType":"auto","position":3.015625,"command":"display(unionDS)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[["123456","Computer Science"],["michael","armbrust","no-reply@berkeley.edu",100000.0]],[["345678","Mechanical Engineering"],["matei",null,"no-reply@waterloo.edu",140000.0]],[["123456","Theater and Drama"],[null,"wendell","no-reply@princeton.edu",160000.0]],[["901234","Indoor Recreation"],["matei",null,"no-reply@waterloo.edu",140000.0]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"department","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"},{"name":"employees","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"firstName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"lastName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"email\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"salary\",\"type\":\"integer\",\"nullable\":false,\"metadata\":{}}]}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1479418477821,"submitTime":1479418476906,"finishTime":1479418478071,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6c9f9142-489c-4ffc-a60a-8ad5e11a3b75"},{"version":"CommandV1","origId":2201444230243996,"guid":"6e4333aa-4439-4f3d-9dee-040301fc2d7b","subtype":"command","commandType":"auto","position":3.03125,"command":"%md **Write the Unioned Dataset to a Parquet file.**","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1454974337796,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"13e54bb6-60f3-471a-b497-07f77f4e5aa8"},{"version":"CommandV1","origId":2201444230243997,"guid":"3f19c203-5b41-48ed-9c44-07f14faf770d","subtype":"command","commandType":"auto","position":3.0625,"command":"// Remove the file if it exists\ndbutils.fs.rm(\"/tmp/databricks-ds-example.parquet\", true)\nunionDS.write.parquet(\"/tmp/databricks-df-example.parquet\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:33: error: not found: value unionDF\n       unionDF.write.parquet(&quot;/tmp/databricks-df-example.parquet&quot;)\n       ^\n</div>","error":null,"workflows":[],"startTime":1479418773254,"submitTime":1479418772330,"finishTime":1479418777096,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a9207936-f7fa-44e9-aeda-47583c6ebc82"},{"version":"CommandV1","origId":2201444230243998,"guid":"1e8a2223-8e28-429f-85a3-f973334d40b7","subtype":"command","commandType":"auto","position":3.078125,"command":"%md **Read a Dataset from the Parquet file.**\n\nNote: we don't have to specify the schema since parquet stores the schema as part of the file.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1454974338027,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c42c03b1-c64d-4875-a62b-38598ca51b1d"},{"version":"CommandV1","origId":2201444230243999,"guid":"318f51ca-6c80-4167-afa2-ea44324fca5c","subtype":"command","commandType":"auto","position":3.09375,"command":"val parquetDS = sqlContext.read.parquet(\"/tmp/databricks-df-example.parquet\").as[DepartmentWithEmployees]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">parquetDS: org.apache.spark.sql.Dataset[DepartmentWithEmployees] = [department: struct&lt;id: string, name: string&gt;, employees: struct&lt;firstName: string, lastName: string ... 2 more fields&gt;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:29: error: value toDS is not a member of org.apache.spark.sql.DataFrame\n       val parquetDF = sqlContext.read.parquet(&quot;/tmp/databricks-df-example.parquet&quot;).toDS\n                                                                                     ^\n</div>","error":null,"workflows":[],"startTime":1479424845323,"submitTime":1479424844236,"finishTime":1479424846212,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c1fc5cbb-586f-44d7-b17e-a0e54c62b86e"},{"version":"CommandV1","origId":2201444230244000,"guid":"53fbb341-2682-4397-916a-223a4cd360a1","subtype":"command","commandType":"auto","position":3.296875,"command":"display(parquetDS)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[["123456","Computer Science"],["michael","armbrust","no-reply@berkeley.edu",100000.0]],[["345678","Mechanical Engineering"],["matei",null,"no-reply@waterloo.edu",140000.0]],[["123456","Theater and Drama"],[null,"wendell","no-reply@princeton.edu",160000.0]],[["901234","Indoor Recreation"],["matei",null,"no-reply@waterloo.edu",140000.0]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"department","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"},{"name":"employees","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"firstName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"lastName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"email\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"salary\",\"type\":\"integer\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1479424850927,"submitTime":1479424849832,"finishTime":1479424851843,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"675c3678-a8a8-4c75-9c1d-50290b30188a"},{"version":"CommandV1","origId":2201444230244001,"guid":"5de60928-9b8d-4070-9c31-be4002f9dd44","subtype":"command","commandType":"auto","position":3.3984375,"command":"%md Let's use a pattern matching case class to only extract employees as convert it into a Dataset","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9cb3c026-00ba-46c6-813f-7c7d82589e1a"},{"version":"CommandV1","origId":2201444230244002,"guid":"46da9942-9d3f-49df-8950-7f45addf2e9e","subtype":"command","commandType":"auto","position":3.5,"command":"import spark.implicits._\n\nval explodeDS= parquetDS.map( { \n  case DepartmentWithEmployees(dept: Department, employee: Employee) => {\n    val firstName = employee.firstName\n    val lastName = employee.lastName\n    val email = employee.email\n    val salary = employee.salary\n    Employee(firstName, lastName, email, salary)\n  }\n})\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import spark.implicits._\nexplodeDS: org.apache.spark.sql.Dataset[Employee] = [firstName: string, lastName: string ... 2 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:47: error: value lasttName is not a member of Employee\n           val lastName = employee.lasttName\n                                   ^\n</div>","error":null,"workflows":[],"startTime":1479427174587,"submitTime":1479427173428,"finishTime":1479427175427,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"835e8cee-3f1e-473b-9232-6c0b169a7032"},{"version":"CommandV1","origId":2201444230244003,"guid":"1437da69-aa69-49de-94d6-27c6014c1ced","subtype":"command","commandType":"auto","position":3.515625,"command":"explodeDS.cache()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res54: explodeDS.type = [firstName: string, lastName: string ... 2 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1479427181155,"submitTime":1479427180004,"finishTime":1479427181353,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8e8ff6e0-ce08-4e6e-a470-aac091cf0973"},{"version":"CommandV1","origId":2201444230244004,"guid":"46dd8b4c-6c45-413c-aeff-c32e54c7d466","subtype":"command","commandType":"auto","position":3.53125,"command":"display(explodeDS)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["michael","armbrust","no-reply@berkeley.edu",100000.0],["matei",null,"no-reply@waterloo.edu",140000.0],[null,"wendell","no-reply@princeton.edu",160000.0],["matei",null,"no-reply@waterloo.edu",140000.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"firstName","type":"\"string\"","metadata":"{}"},{"name":"lastName","type":"\"string\"","metadata":"{}"},{"name":"email","type":"\"string\"","metadata":"{}"},{"name":"salary","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1479427033760,"submitTime":1479427032614,"finishTime":1479427035110,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6011c956-a7d1-4b9e-aac6-23493a9e1d2e"},{"version":"CommandV1","origId":2201444230244005,"guid":"c0f1b7ee-656d-4e56-83c3-ca88e7630095","subtype":"command","commandType":"auto","position":3.5625,"command":"//gives us the type\nexplodeDS","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res53: org.apache.spark.sql.Dataset[Employee] = [firstName: string, lastName: string ... 2 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:4: error: identifier expected but 'type' found.\nexplodeDS.type\n          ^\n</div>","error":null,"workflows":[],"startTime":1479427074448,"submitTime":1479427073301,"finishTime":1479427074600,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"50788117-05e2-478b-9099-1437ec1d02d4"},{"version":"CommandV1","origId":2201444230244006,"guid":"02e059c8-310a-475f-b166-358de05028b8","subtype":"command","commandType":"auto","position":3.625,"command":"%md **Use ``filter()`` to return only the rows that match the given predicate.**","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1454974338252,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d8a7ebca-9615-4dd3-a9d2-7ad32973ef50"},{"version":"CommandV1","origId":2201444230244007,"guid":"0f75f141-4db4-44b9-af7c-db77b5744f14","subtype":"command","commandType":"auto","position":3.6875,"command":"val filterD1 = explodeDS.filter(e=> e.firstName == \"matei\" || e.firstName == \"michael\").sort($\"lastName\".asc)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">filterD1: org.apache.spark.sql.Dataset[Employee] = [firstName: string, lastName: string ... 2 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:43: error: not found: value e\n                     .sort(e.lastName)\n                           ^\n</div>","error":null,"workflows":[],"startTime":1479427746871,"submitTime":1479427745705,"finishTime":1479427747214,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6126ea34-9008-482d-8b24-425334cd92b6"},{"version":"CommandV1","origId":2201444230244008,"guid":"59c965ca-9558-4882-b913-012767f30189","subtype":"command","commandType":"auto","position":3.71875,"command":"display(filterD1)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["matei",null,"no-reply@waterloo.edu",140000.0],["matei",null,"no-reply@waterloo.edu",140000.0],["michael","armbrust","no-reply@berkeley.edu",100000.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"firstName","type":"\"string\"","metadata":"{}"},{"name":"lastName","type":"\"string\"","metadata":"{}"},{"name":"email","type":"\"string\"","metadata":"{}"},{"name":"salary","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1479427752060,"submitTime":1479427750894,"finishTime":1479427752318,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"91cc3121-63ee-4867-bb2a-c4a838e61573"},{"version":"CommandV1","origId":2201444230244009,"guid":"5823af13-f0d7-4852-be10-154ed2f928be","subtype":"command","commandType":"auto","position":3.75,"command":"val filterDS2 = explodeDS\n  .filter($\"firstName\" === \"matei\" || $\"firstName\" === \"michael\")\n  .sort($\"lastName\".asc)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">filterDS2: org.apache.spark.sql.Dataset[Employee] = [firstName: string, lastName: string ... 2 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":"Command skipped","workflows":[],"startTime":1479427764975,"submitTime":1479427763808,"finishTime":1479427765271,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"17077fb7-493d-4f6a-af14-dade356b490e"},{"version":"CommandV1","origId":2201444230244010,"guid":"647f68ee-a8eb-4573-a01c-6e667f1e9bf1","subtype":"command","commandType":"auto","position":3.765625,"command":"display(filterDS2)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["matei",null,"no-reply@waterloo.edu",140000.0],["matei",null,"no-reply@waterloo.edu",140000.0],["michael","armbrust","no-reply@berkeley.edu",100000.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"firstName","type":"\"string\"","metadata":"{}"},{"name":"lastName","type":"\"string\"","metadata":"{}"},{"name":"email","type":"\"string\"","metadata":"{}"},{"name":"salary","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1479427785125,"submitTime":1479427783958,"finishTime":1479427785373,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e723f49c-1282-4ec4-96fb-6c1070b4e793"},{"version":"CommandV1","origId":2201444230244011,"guid":"873ffc91-b3c7-4a45-ae56-ad31de71b368","subtype":"command","commandType":"auto","position":3.78125,"command":"%md **The ``where()`` clause is equivalent to ``filter()``.**","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1454974338385,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c60f5d5d-284d-4af4-aa33-326b62bcf3f9"},{"version":"CommandV1","origId":2201444230244012,"guid":"9be10d52-6bfe-46c9-9554-51bd46e47b89","subtype":"command","commandType":"auto","position":3.8125,"command":"val whereDS = explodeDS.where(($\"firstName\" === \"matei\") || ($\"firstName\" === \"michael\")).sort($\"lastName\".asc)\ndisplay(whereDS)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["matei",null,"no-reply@waterloo.edu",140000.0],["matei",null,"no-reply@waterloo.edu",140000.0],["michael","armbrust","no-reply@berkeley.edu",100000.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"firstName","type":"\"string\"","metadata":"{}"},{"name":"lastName","type":"\"string\"","metadata":"{}"},{"name":"email","type":"\"string\"","metadata":"{}"},{"name":"salary","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:45: error: not found: value whereDF\n       display(whereDF)\n               ^\n</div>","error":null,"workflows":[],"startTime":1479427811055,"submitTime":1479427809887,"finishTime":1479427811480,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ee47f56c-bf7d-470f-901b-9a067168b7ae"},{"version":"CommandV1","origId":2201444230244013,"guid":"8dfaf593-480f-4f8f-b019-8ff4d6523744","subtype":"command","commandType":"auto","position":4.0,"command":"%md **Replace ``null`` values with `--` using Dataset Na functions.**","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1454974338513,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4547a401-e694-4e19-8836-cd092a4467c5"},{"version":"CommandV1","origId":2201444230244014,"guid":"cfe4f469-bb34-4b06-9f8b-b86a66a8e55c","subtype":"command","commandType":"auto","position":5.0,"command":"val naFunctions = explodeDS.na\nval nonNullDS = naFunctions.fill(\"--\")\ndisplay(nonNullDS)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["michael","armbrust","no-reply@berkeley.edu",100000.0],["matei","--","no-reply@waterloo.edu",140000.0],["--","wendell","no-reply@princeton.edu",160000.0],["matei","--","no-reply@waterloo.edu",140000.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"firstName","type":"\"string\"","metadata":"{}"},{"name":"lastName","type":"\"string\"","metadata":"{}"},{"name":"email","type":"\"string\"","metadata":"{}"},{"name":"salary","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:48: error: not found: value nonNullDS\n       display(nonNullDS)\n               ^\n</div>","error":null,"workflows":[],"startTime":1479428121901,"submitTime":1479428120724,"finishTime":1479428122162,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d3f02de7-89c0-40be-806a-7eea6a1ec3fd"},{"version":"CommandV1","origId":2201444230244015,"guid":"55431378-5bc2-4eed-9458-5560182aecd8","subtype":"command","commandType":"auto","position":5.5,"command":"%md **Retrieve only rows with missing firstName or lastName.**","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1454974338582,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"bd7d5d56-a269-412f-80b4-a75d622da719"},{"version":"CommandV1","origId":2201444230244016,"guid":"6feef3f7-2687-476d-8c6a-273b6c3f30c5","subtype":"command","commandType":"auto","position":6.0,"command":"val filterNonNullDF = nonNullDF.filter($\"firstName\" === \"--\" || $\"lastName\" === \"--\").sort($\"email\".asc)\ndisplay(filterNonNullDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["--","wendell","no-reply@princeton.edu",160000.0],["matei","--","no-reply@waterloo.edu",140000.0],["matei","--","no-reply@waterloo.edu",140000.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"firstName","type":"\"string\"","metadata":"{}"},{"name":"lastName","type":"\"string\"","metadata":"{}"},{"name":"email","type":"\"string\"","metadata":"{}"},{"name":"salary","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":"Command skipped","workflows":[],"startTime":1479428132176,"submitTime":1479428130999,"finishTime":1479428132563,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7aa66a1f-2206-4888-9209-14b963e1abab"},{"version":"CommandV1","origId":2201444230244017,"guid":"07cb1b5d-2068-492f-91de-b4e576e96b45","subtype":"command","commandType":"auto","position":6.5,"command":"%md **Example aggregations using ``agg()`` and ``countDistinct()``.**","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1454974338682,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d2d79fe6-c131-47d7-a2c3-67485b5371bb"},{"version":"CommandV1","origId":2201444230244018,"guid":"ed0c056f-78a1-431b-a57a-24a0c353d0ad","subtype":"command","commandType":"auto","position":6.625,"command":"import org.apache.spark.sql.functions._","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.sql.functions._\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":"Command skipped","workflows":[],"startTime":1479428360749,"submitTime":1479428359567,"finishTime":1479428360865,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"046add5d-e09a-4a61-b86c-2b67fa06bf66"},{"version":"CommandV1","origId":2201444230244019,"guid":"d8a37594-bf55-4722-b382-104281f16e24","subtype":"command","commandType":"auto","position":6.75,"command":"// Find the distinct (firstName, lastName) combinations\nval countDistinctDF = nonNullDS.select($\"firstName\", $\"lastName\")\n  .groupBy($\"firstName\", $\"lastName\")\n  .agg(countDistinct($\"firstName\") as \"distinct_first_names\") \ndisplay(countDistinctDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["michael","armbrust",1.0],["matei","--",1.0],["--","wendell",1.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"firstName","type":"\"string\"","metadata":"{}"},{"name":"lastName","type":"\"string\"","metadata":"{}"},{"name":"distinct_first_names","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:45: error: not found: value count\n         .agg(count($&quot;firstName&quot;) as &quot;distinct_first_names&quot;)\n              ^\n</div>","error":null,"workflows":[],"startTime":1479428392832,"submitTime":1479428391648,"finishTime":1479428393725,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f2b35aaa-800d-4cc7-a1be-b469fad8e96e"},{"version":"CommandV1","origId":2201444230244020,"guid":"68106794-4ccd-4aa4-ba8a-427db39f31bd","subtype":"command","commandType":"auto","position":6.8125,"command":"%md **Compare the DataFrame and SQL Query Physical Plans**\n(Hint:  They should be the same.)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1454974338942,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"29b9e044-2e92-4a00-a3a0-ccdff17770eb"},{"version":"CommandV1","origId":2201444230244021,"guid":"19b37176-3062-480e-9d74-836793aaff29","subtype":"command","commandType":"auto","position":6.875,"command":"countDistinctDF.explain(true)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">== Parsed Logical Plan ==\n'Aggregate ['firstName, 'lastName], [unresolvedalias('firstName, None), unresolvedalias('lastName, None), count(distinct 'firstName) AS distinct_first_names#12156]\n+- Project [firstName#11597, lastName#11598]\n   +- Project [cast(coalesce(firstName#9534, --) as string) AS firstName#11597, cast(coalesce(lastName#9535, --) as string) AS lastName#11598, cast(coalesce(email#9536, --) as string) AS email#11599, salary#9537]\n      +- SerializeFromObject [staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$Employee, true], top level non-flat input object).firstName, true) AS firstName#9534, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$Employee, true], top level non-flat input object).lastName, true) AS lastName#9535, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$Employee, true], top level non-flat input object).email, true) AS email#9536, assertnotnull(input[0, line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$Employee, true], top level non-flat input object).salary AS salary#9537]\n         +- MapElements &lt;function1&gt;, obj#9533: line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$Employee\n            +- DeserializeToObject newInstance(class line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$DepartmentWithEmployees), obj#9532: line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$DepartmentWithEmployees\n               +- Relation[department#6083,employees#6084] parquet\n\n== Analyzed Logical Plan ==\nfirstName: string, lastName: string, distinct_first_names: bigint\nAggregate [firstName#11597, lastName#11598], [firstName#11597, lastName#11598, count(distinct firstName#11597) AS distinct_first_names#12156L]\n+- Project [firstName#11597, lastName#11598]\n   +- Project [cast(coalesce(firstName#9534, --) as string) AS firstName#11597, cast(coalesce(lastName#9535, --) as string) AS lastName#11598, cast(coalesce(email#9536, --) as string) AS email#11599, salary#9537]\n      +- SerializeFromObject [staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$Employee, true], top level non-flat input object).firstName, true) AS firstName#9534, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$Employee, true], top level non-flat input object).lastName, true) AS lastName#9535, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$Employee, true], top level non-flat input object).email, true) AS email#9536, assertnotnull(input[0, line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$Employee, true], top level non-flat input object).salary AS salary#9537]\n         +- MapElements &lt;function1&gt;, obj#9533: line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$Employee\n            +- DeserializeToObject newInstance(class line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$DepartmentWithEmployees), obj#9532: line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$DepartmentWithEmployees\n               +- Relation[department#6083,employees#6084] parquet\n\n== Optimized Logical Plan ==\nAggregate [firstName#11597, lastName#11598], [firstName#11597, lastName#11598, count(distinct firstName#11597) AS distinct_first_names#12156L]\n+- Project [coalesce(firstName#9534, --) AS firstName#11597, coalesce(lastName#9535, --) AS lastName#11598]\n   +- InMemoryRelation [firstName#9534, lastName#9535, email#9536, salary#9537], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas)\n         +- *SerializeFromObject [staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$Employee, true], top level non-flat input object).firstName, true) AS firstName#9534, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$Employee, true], top level non-flat input object).lastName, true) AS lastName#9535, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$Employee, true], top level non-flat input object).email, true) AS email#9536, assertnotnull(input[0, line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$Employee, true], top level non-flat input object).salary AS salary#9537]\n            +- *MapElements &lt;function1&gt;, obj#9533: line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$Employee\n               +- *DeserializeToObject newInstance(class line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$DepartmentWithEmployees), obj#9532: line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$DepartmentWithEmployees\n                  +- *Scan parquet [department#6083,employees#6084] Format: ParquetFormat, InputPaths: dbfs:/tmp/databricks-df-example.parquet, PartitionFilters: [], PushedFilters: [], ReadSchema: struct&lt;department:struct&lt;id:string,name:string&gt;,employees:struct&lt;firstName:string,lastName:string...\n\n== Physical Plan ==\n*HashAggregate(keys=[firstName#11597, lastName#11598], functions=[count(distinct firstName#11597)], output=[firstName#11597, lastName#11598, distinct_first_names#12156L])\n+- *HashAggregate(keys=[firstName#11597, lastName#11598], functions=[partial_count(distinct firstName#11597)], output=[firstName#11597, lastName#11598, count#13092L])\n   +- *HashAggregate(keys=[firstName#11597, lastName#11598, firstName#11597], functions=[], output=[firstName#11597, lastName#11598, firstName#11597])\n      +- Exchange hashpartitioning(firstName#11597, lastName#11598, firstName#11597, 200)\n         +- *HashAggregate(keys=[firstName#11597, lastName#11598, firstName#11597], functions=[], output=[firstName#11597, lastName#11598, firstName#11597])\n            +- *Project [coalesce(firstName#9534, --) AS firstName#11597, coalesce(lastName#9535, --) AS lastName#11598]\n               +- InMemoryTableScan [firstName#9534, lastName#9535]\n                     +- InMemoryRelation [firstName#9534, lastName#9535, email#9536, salary#9537], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas)\n                           +- *SerializeFromObject [staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$Employee, true], top level non-flat input object).firstName, true) AS firstName#9534, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$Employee, true], top level non-flat input object).lastName, true) AS lastName#9535, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$Employee, true], top level non-flat input object).email, true) AS email#9536, assertnotnull(input[0, line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$Employee, true], top level non-flat input object).salary AS salary#9537]\n                              +- *MapElements &lt;function1&gt;, obj#9533: line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$Employee\n                                 +- *DeserializeToObject newInstance(class line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$DepartmentWithEmployees), obj#9532: line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$DepartmentWithEmployees\n                                    +- *Scan parquet [department#6083,employees#6084] Format: ParquetFormat, InputPaths: dbfs:/tmp/databricks-df-example.parquet, PartitionFilters: [], PushedFilters: [], ReadSchema: struct&lt;department:struct&lt;id:string,name:string&gt;,employees:struct&lt;firstName:string,lastName:string...\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":"Command skipped","workflows":[],"startTime":1479428726592,"submitTime":1479428725399,"finishTime":1479428726745,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"876a3eb6-e02b-4700-b4ac-d841514fad60"},{"version":"CommandV1","origId":2201444230244022,"guid":"e8ca5b0c-ae05-4a5e-91c4-4bf340405061","subtype":"command","commandType":"auto","position":6.9375,"command":"// register the DataFrame as a temp table so that we can query it using SQL\nnonNullDF.createOrReplaceTempView(\"databricks_df_example\")\ndisplay(spark.catalog.listTables)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["databricks_df_example",null,null,"TEMPORARY",true]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"database","type":"\"string\"","metadata":"{}"},{"name":"description","type":"\"string\"","metadata":"{}"},{"name":"tableType","type":"\"string\"","metadata":"{}"},{"name":"isTemporary","type":"\"boolean\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:49: error: value listTables is not a member of org.apache.spark.sql.RuntimeConfig\n       spark.conf.listTables\n                  ^\n</div>","error":null,"workflows":[],"startTime":1479428689407,"submitTime":1479428688217,"finishTime":1479428689662,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"01508ea6-372c-4030-af83-54d4392e15eb"},{"version":"CommandV1","origId":2201444230244023,"guid":"b9d82c86-f703-4821-be06-cef35e415fc8","subtype":"command","commandType":"auto","position":6.94140625,"command":"// Perform the same query as the DataFrame above and return ``explain``\nval countDistinctSQLDF = spark.sql(\"\"\"\nSELECT firstName, lastName, count(distinct firstName) as distinct_first_names\nFROM databricks_df_example\nGROUP BY firstName, lastName\n\"\"\")\ndisplay(countDistinctSQLDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["michael","armbrust",1.0],["matei","--",1.0],["--","wendell",1.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"firstName","type":"\"string\"","metadata":"{}"},{"name":"lastName","type":"\"string\"","metadata":"{}"},{"name":"distinct_first_names","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:4: error: illegal start of simple pattern\nval countDistinctSQL DF = spark.sql(&quot;&quot;&quot;\n                        ^\n</div>","error":null,"workflows":[],"startTime":1479428921875,"submitTime":1479428920677,"finishTime":1479428922550,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3523ec4c-2c43-4b19-b792-5dc6fc74cf98"},{"version":"CommandV1","origId":2201444230244024,"guid":"b0281387-f561-4c62-9b05-ca117d328d61","subtype":"command","commandType":"auto","position":6.943359375,"command":"countDistinctSQLDF.explain(true)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">== Parsed Logical Plan ==\n'Aggregate ['firstName, 'lastName], ['firstName, 'lastName, 'count('firstName) AS distinct_first_names#13505]\n+- 'UnresolvedRelation `databricks_df_example`\n\n== Analyzed Logical Plan ==\nfirstName: string, lastName: string, distinct_first_names: bigint\nAggregate [firstName#10955, lastName#10956], [firstName#10955, lastName#10956, count(distinct firstName#10955) AS distinct_first_names#13505L]\n+- SubqueryAlias databricks_df_example\n   +- Project [cast(coalesce(firstName#9534, --) as string) AS firstName#10955, cast(coalesce(lastName#9535, --) as string) AS lastName#10956, cast(coalesce(email#9536, --) as string) AS email#10957, salary#9537]\n      +- SerializeFromObject [staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$Employee, true], top level non-flat input object).firstName, true) AS firstName#9534, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$Employee, true], top level non-flat input object).lastName, true) AS lastName#9535, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$Employee, true], top level non-flat input object).email, true) AS email#9536, assertnotnull(input[0, line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$Employee, true], top level non-flat input object).salary AS salary#9537]\n         +- MapElements &lt;function1&gt;, obj#9533: line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$Employee\n            +- DeserializeToObject newInstance(class line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$DepartmentWithEmployees), obj#9532: line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$DepartmentWithEmployees\n               +- Relation[department#6083,employees#6084] parquet\n\n== Optimized Logical Plan ==\nAggregate [firstName#10955, lastName#10956], [firstName#10955, lastName#10956, count(distinct firstName#10955) AS distinct_first_names#13505L]\n+- Project [coalesce(firstName#9534, --) AS firstName#10955, coalesce(lastName#9535, --) AS lastName#10956]\n   +- InMemoryRelation [firstName#9534, lastName#9535, email#9536, salary#9537], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas)\n         +- *SerializeFromObject [staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$Employee, true], top level non-flat input object).firstName, true) AS firstName#9534, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$Employee, true], top level non-flat input object).lastName, true) AS lastName#9535, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$Employee, true], top level non-flat input object).email, true) AS email#9536, assertnotnull(input[0, line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$Employee, true], top level non-flat input object).salary AS salary#9537]\n            +- *MapElements &lt;function1&gt;, obj#9533: line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$Employee\n               +- *DeserializeToObject newInstance(class line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$DepartmentWithEmployees), obj#9532: line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$DepartmentWithEmployees\n                  +- *Scan parquet [department#6083,employees#6084] Format: ParquetFormat, InputPaths: dbfs:/tmp/databricks-df-example.parquet, PartitionFilters: [], PushedFilters: [], ReadSchema: struct&lt;department:struct&lt;id:string,name:string&gt;,employees:struct&lt;firstName:string,lastName:string...\n\n== Physical Plan ==\n*HashAggregate(keys=[firstName#10955, lastName#10956], functions=[count(distinct firstName#10955)], output=[firstName#10955, lastName#10956, distinct_first_names#13505L])\n+- *HashAggregate(keys=[firstName#10955, lastName#10956], functions=[partial_count(distinct firstName#10955)], output=[firstName#10955, lastName#10956, count#13596L])\n   +- *HashAggregate(keys=[firstName#10955, lastName#10956, firstName#10955], functions=[], output=[firstName#10955, lastName#10956, firstName#10955])\n      +- Exchange hashpartitioning(firstName#10955, lastName#10956, firstName#10955, 200)\n         +- *HashAggregate(keys=[firstName#10955, lastName#10956, firstName#10955], functions=[], output=[firstName#10955, lastName#10956, firstName#10955])\n            +- *Project [coalesce(firstName#9534, --) AS firstName#10955, coalesce(lastName#9535, --) AS lastName#10956]\n               +- InMemoryTableScan [firstName#9534, lastName#9535]\n                     +- InMemoryRelation [firstName#9534, lastName#9535, email#9536, salary#9537], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas)\n                           +- *SerializeFromObject [staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$Employee, true], top level non-flat input object).firstName, true) AS firstName#9534, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$Employee, true], top level non-flat input object).lastName, true) AS lastName#9535, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$Employee, true], top level non-flat input object).email, true) AS email#9536, assertnotnull(input[0, line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$Employee, true], top level non-flat input object).salary AS salary#9537]\n                              +- *MapElements &lt;function1&gt;, obj#9533: line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$Employee\n                                 +- *DeserializeToObject newInstance(class line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$DepartmentWithEmployees), obj#9532: line982203952e89413480467bcf0ad105e787.$read$$iw$$iw$$iw$$iw$DepartmentWithEmployees\n                                    +- *Scan parquet [department#6083,employees#6084] Format: ParquetFormat, InputPaths: dbfs:/tmp/databricks-df-example.parquet, PartitionFilters: [], PushedFilters: [], ReadSchema: struct&lt;department:struct&lt;id:string,name:string&gt;,employees:struct&lt;firstName:string,lastName:string...\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:47: error: overloaded method value display with alternatives:\n  [A](data: Seq[A])(implicit evidence$1: reflect.runtime.universe.TypeTag[A])Unit &lt;and&gt;\n  (dataset: org.apache.spark.sql.Dataset[_],streamName: String,trigger: org.apache.spark.sql.streaming.Trigger)Unit &lt;and&gt;\n  (model: org.apache.spark.ml.classification.DecisionTreeClassificationModel)Unit &lt;and&gt;\n  (model: org.apache.spark.ml.regression.DecisionTreeRegressionModel)Unit &lt;and&gt;\n  (model: org.apache.spark.ml.clustering.KMeansModel)Unit &lt;and&gt;\n  (model: org.apache.spark.mllib.clustering.KMeansModel)Unit &lt;and&gt;\n  (documentable: com.databricks.dbutils_v1.WithHelpMethods)Unit\n cannot be applied to (Unit)\n       display(countDistinctSQLDF)\n       ^\n</div>","error":null,"workflows":[],"startTime":1479428939989,"submitTime":1479428938792,"finishTime":1479428940141,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c7a2130d-afd0-4da9-b6ae-03bdf63dbfec"},{"version":"CommandV1","origId":2201444230244025,"guid":"e8cc4835-8ba5-4248-82bf-cdc163f5c88c","subtype":"command","commandType":"auto","position":6.9453125,"command":"// Sum up all the salaries\nval salarySumDF = nonNullDF.agg(\"salary\" -> \"sum\") \ndisplay(salarySumDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[540000.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"sum(salary)","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":"Command skipped","workflows":[],"startTime":1479428967453,"submitTime":1479428966255,"finishTime":1479428967949,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"36bf5c56-4fb3-4055-b684-0843a1695074"},{"version":"CommandV1","origId":2201444230244026,"guid":"7d621e8f-843f-4155-9be8-1bb98706bbb0","subtype":"command","commandType":"auto","position":6.953125,"command":"%md **Print the summary statistics for the salaries.**","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1454974339166,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e2c86d9f-cb3d-44e0-b605-f069ad94c29c"},{"version":"CommandV1","origId":2201444230244027,"guid":"fa8624b6-c683-4e5b-aff7-3b619bcb1988","subtype":"command","commandType":"auto","position":6.96875,"command":"nonNullDF.describe(\"salary\").show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-------+------------------+\n|summary|            salary|\n+-------+------------------+\n|  count|                 4|\n|   mean|          135000.0|\n| stddev|25166.114784235833|\n|    min|            100000|\n|    max|            160000|\n+-------+------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":"Command skipped","workflows":[],"startTime":1479428987473,"submitTime":1479428986274,"finishTime":1479428987916,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f800ed96-2f04-4b85-8508-360f1c04c2ce"},{"version":"CommandV1","origId":2201444230244028,"guid":"7b936da5-4b30-435f-8c52-8164842bfe3f","subtype":"command","commandType":"auto","position":6.9921875,"command":"val veryNestedDF = Seq((\"1\", (2, (3, 4)))).toDF()\nveryNestedDF.printSchema\nval sch = veryNestedDF.schema","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">root\n |-- _1: string (nullable = true)\n |-- _2: struct (nullable = true)\n |    |-- _1: integer (nullable = false)\n |    |-- _2: struct (nullable = true)\n |    |    |-- _1: integer (nullable = false)\n |    |    |-- _2: integer (nullable = false)\n\nveryNestedDF: org.apache.spark.sql.DataFrame = [_1: string, _2: struct&lt;_1: int, _2: struct&lt;_1: int, _2: int&gt;&gt;]\nsch: org.apache.spark.sql.types.StructType = StructType(StructField(_1,StringType,true), StructField(_2,StructType(StructField(_1,IntegerType,false), StructField(_2,StructType(StructField(_1,IntegerType,false), StructField(_2,IntegerType,false)),true)),true))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:75: error: overloaded method value as with alternatives:\n  (alias: Symbol)org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] &lt;and&gt;\n  (alias: String)org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] &lt;and&gt;\n  [U](implicit evidence$2: org.apache.spark.sql.Encoder[U])org.apache.spark.sql.Dataset[U]\n cannot be applied to (String, String)\n       val veryNestedDF = Seq((&quot;1&quot;, (2, (3, 4)))).toDF().as(&quot;col1&quot;, &quot;col2&quot;)\n                                                         ^\n</div>","error":null,"workflows":[],"startTime":1479506785995,"submitTime":1479506782657,"finishTime":1479506788410,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1c60354a-2b98-48e0-ac26-7cd36288d4ca"},{"version":"CommandV1","origId":2201444230244029,"guid":"586b8822-1b20-4520-89a4-1f0b99a5455d","subtype":"command","commandType":"auto","position":7.0,"command":"%md **Cleanup: Remove the parquet file.**","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1454974339432,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"dc037330-2a39-4183-a1bf-180272418f1f"},{"version":"CommandV1","origId":2201444230244030,"guid":"dfe5d114-e8df-4958-a0a3-c8af84d29bb1","subtype":"command","commandType":"auto","position":8.0,"command":"dbutils.fs.rm(\"/tmp/databricks-df-example.parquet\", true)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res106: Boolean = true\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":"Command skipped","workflows":[],"startTime":1479432914566,"submitTime":1479432913262,"finishTime":1479432916774,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2476a4f4-0a7c-4ffb-849d-5caf5b1ed198"},{"version":"CommandV1","origId":2201444230244031,"guid":"1ac98b82-c848-4add-9a2a-98c309fa4a7e","subtype":"command","commandType":"auto","position":9.0,"command":"implicit class StringImprovements(val s: String) {\n    def hideAll = s.replaceAll(\".\", \"*\")\n}","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">defined class StringImprovements\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:75: error: value − is not a member of Char\n           def decrement = s.map(c =&gt; (c − 1).toChar)\n                                         ^\n</div>","error":null,"workflows":[],"startTime":1479434591680,"submitTime":1479434590331,"finishTime":1479434591947,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"66a3cd05-3979-4772-b2df-593b831b24b5"},{"version":"CommandV1","origId":2201444230244032,"guid":"ff825668-1b47-4909-9a95-fc3498dc031d","subtype":"command","commandType":"auto","position":10.0,"command":"\"Jules S. Damji\".hideAll","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res115: String = **************\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1479434638770,"submitTime":1479434637417,"finishTime":1479434639121,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"588273d7-38ac-4529-8380-085e7d8ff013"}],"dashboards":[{"version":"DashboardViewV1","origId":2201444230244033,"guid":"adb10ea8-6c07-474e-ac34-ab935ce50a7c","nuid":"acb8e4dd-12b5-44f7-b743-1958c6cc6d2a","title":"Untitled","width":1024,"layoutOption":{"stack":true,"grid":true},"elements":[{"guid":"08274139-fdc5-440e-85d7-d2ecc7edf5c8","elementType":"command","elementNUID":"d3f02de7-89c0-40be-806a-7eea6a1ec3fd","position":{"width":12,"height":6,"x":0,"y":15,"z":null},"options":null},{"guid":"12c194b0-7892-4acc-becb-2bbf5777d59b","elementType":"command","elementNUID":"d2d79fe6-c131-47d7-a2c3-67485b5371bb","position":{"width":12,"height":1,"x":12,"y":22,"z":null},"options":null},{"guid":"254f6a76-386e-42d7-b441-1c506c59e64b","elementType":"command","elementNUID":"ec9130c1-de94-4ef5-a458-f2efa0f00078","position":{"width":12,"height":3,"x":0,"y":1,"z":null},"options":null},{"guid":"25a1a9af-e21c-4c51-aa20-75bfcff5e9b6","elementType":"command","elementNUID":"a26a9c14-886a-4f37-80c2-95ce5d468ae3","position":{"width":12,"height":1,"x":12,"y":6,"z":null},"options":null},{"guid":"306a712b-e791-49bc-96a7-7267e55073c6","elementType":"command","elementNUID":"394c81f7-a0e4-44ab-ad12-0f6bd6130d11","position":{"width":12,"height":2,"x":12,"y":0,"z":null},"options":null},{"guid":"31c24efc-c71d-406c-b416-7985c4e7a353","elementType":"command","elementNUID":"45bb85bf-9c6e-4393-b9a1-1af0f4bc6488","position":{"width":12,"height":4,"x":0,"y":4,"z":null},"options":null},{"guid":"4259fce4-354b-4be9-9ef2-77975f5cb1f0","elementType":"command","elementNUID":"36bf5c56-4fb3-4055-b684-0843a1695074","position":{"width":12,"height":2,"x":0,"y":23,"z":null},"options":{"titleAlign":"center","autoScaleImg":false,"scale":0.0,"showTitle":false}},{"guid":"53afbfee-8f3a-445d-852f-fb6fc0c21f67","elementType":"command","elementNUID":"c42c03b1-c64d-4875-a62b-38598ca51b1d","position":{"width":12,"height":1,"x":12,"y":9,"z":null},"options":null},{"guid":"5833dfbb-82f0-48ce-9757-9462087f7cd4","elementType":"command","elementNUID":"bd7d5d56-a269-412f-80b4-a75d622da719","position":{"width":12,"height":1,"x":12,"y":21,"z":null},"options":null},{"guid":"65a693b7-e24c-4afc-bcdf-1fff696e5aca","elementType":"command","elementNUID":"d8a7ebca-9615-4dd3-a9d2-7ad32973ef50","position":{"width":12,"height":2,"x":0,"y":8,"z":null},"options":null},{"guid":"7fcd68ef-82c5-4a42-9369-d1e1c251b241","elementType":"command","elementNUID":"e2c86d9f-cb3d-44e0-b605-f069ad94c29c","position":{"width":12,"height":1,"x":12,"y":27,"z":null},"options":null},{"guid":"895d0c79-956c-42ac-94c8-57ecc9cd014c","elementType":"command","elementNUID":"849c9fda-a499-42cd-afd5-d77b9745e90b","position":{"width":12,"height":1,"x":0,"y":0,"z":null},"options":null},{"guid":"a69d695e-50ae-484c-bc07-b63649136ae2","elementType":"command","elementNUID":"835e8cee-3f1e-473b-9232-6c0b169a7032","position":{"width":12,"height":6,"x":12,"y":10,"z":null},"options":null},{"guid":"b3846d3c-ca09-4c93-ba5a-036192c2845a","elementType":"command","elementNUID":"13e54bb6-60f3-471a-b497-07f77f4e5aa8","position":{"width":12,"height":1,"x":12,"y":8,"z":null},"options":null},{"guid":"b901b1c6-1806-4c74-b2fb-9b98b6d111e2","elementType":"command","elementNUID":"ee47f56c-bf7d-470f-901b-9a067168b7ae","position":{"width":12,"height":4,"x":12,"y":17,"z":null},"options":null},{"guid":"be50819c-c8e7-4f72-ab11-a15edcdc0816","elementType":"command","elementNUID":"4547a401-e694-4e19-8836-cd092a4467c5","position":{"width":12,"height":1,"x":0,"y":14,"z":null},"options":null},{"guid":"be9ab69b-282f-4bc9-b6ec-4534b6566e07","elementType":"command","elementNUID":"29b9e044-2e92-4a00-a3a0-ccdff17770eb","position":{"width":12,"height":2,"x":0,"y":21,"z":null},"options":null},{"guid":"cf1f0452-c288-4eaa-8130-c7e23f9b78a9","elementType":"command","elementNUID":"c792f393-ee46-4d06-93b9-9942dba16ba7","position":{"width":12,"height":1,"x":12,"y":7,"z":null},"options":null},{"guid":"d30f5fbf-196f-46dd-9ef8-656ba54a0542","elementType":"command","elementNUID":"dc037330-2a39-4183-a1bf-180272418f1f","position":{"width":12,"height":1,"x":12,"y":31,"z":null},"options":null},{"guid":"d9bcebb7-cf6c-4759-bf29-ffd6962b1e25","elementType":"command","elementNUID":"c60f5d5d-284d-4af4-aa33-326b62bcf3f9","position":{"width":12,"height":1,"x":12,"y":16,"z":null},"options":null},{"guid":"ddfd0a66-0a75-4fb0-a005-8c2a30a18936","elementType":"command","elementNUID":"4f61d80b-f0c5-4e65-bb7d-0336103d8781","position":{"width":12,"height":3,"x":12,"y":3,"z":null},"options":null},{"guid":"eb5e288f-a35b-4ed4-bc7c-142a117f72a8","elementType":"command","elementNUID":"17077fb7-493d-4f6a-af14-dade356b490e","position":{"width":12,"height":4,"x":0,"y":10,"z":null},"options":null},{"guid":"ec8c3e52-3e24-4324-9eff-93d8e9b93fca","elementType":"command","elementNUID":"f2b35aaa-800d-4cc7-a1be-b469fad8e96e","position":{"width":12,"height":4,"x":12,"y":23,"z":null},"options":null},{"guid":"f44e6ea0-862f-4e9e-9afa-d52f145ffcd3","elementType":"command","elementNUID":"613db364-fadb-40c9-8277-6c95d22eeda3","position":{"width":12,"height":1,"x":12,"y":2,"z":null},"options":null}],"globalVars":{}}],"guid":"54dfc93c-b548-436e-8bc4-d7b51f2ad63b","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
<script>var tableOfContentsCell = {"version":"CommandV1","origId":0,"guid":"55945872-c5e9-4607-91f4-a2e446e6da9d","subtype":"command","commandType":"auto","position":0.0,"command":"%md [&lsaquo; Back to Table of Contents](index.html)","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{}},"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{}};</script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>